<!DOCTYPE html>
<!-- saved from url=(0059)https://mlatcl.github.io/gpss/lectures/00-13-emulation.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Emulation</title><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Emulation | Gaussian Process Summer School</title>
<meta name="generator" content="Jekyll v3.9.0">
<meta property="og:title" content="Emulation">
<meta name="author" content="Neil D. Lawrence">
<meta property="og:locale" content="en_US">
<meta name="description" content="p &lt;!–">
<meta property="og:description" content="p &lt;!–">
<link rel="canonical" href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html">
<meta property="og:url" content="/gpss/lectures/00-13-emulation.html">
<meta property="og:site_name" content="Gaussian Process Summer School">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="Emulation">
<script async="" src="./Lawrence2021_files/analytics.js"></script><script type="application/ld+json">
{"author":{"@type":"Person","name":"Neil D. Lawrence"},"description":"p &lt;!–","url":"/gpss/lectures/00-13-emulation.html","@type":"WebPage","headline":"Emulation","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<meta name="description" content="p&lt;!--">

  <link rel="stylesheet" href="./Lawrence2021_files/ndltalk.css"><link type="application/atom+xml" rel="alternate" href="https://mlatcl.github.io/gpss/feed.xml" title="Gaussian Process Summer School">

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-184894912-1', 'auto');
  ga('send', 'pageview');

</script>


  <script type="text/x-mathjax-config;executed=true">
  MathJax.Hub.Config({
    TeX: {
      equationNumbers: {
          autoNumber: "AMS"
        }
      },
      tex2jax: {
      inlineMath: [ ['$','$'], ['\\(', '\\)'] ],
      displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
      processEscapes: true,
    }
  });
</script>


  
  <meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Emulation"><meta name="twitter:description" content="In this session we introduce the notion of emulation and systems modeling with Gaussian processes.">
  <meta property="og:title" content="Emulation">
<meta property="og:description" content="In this session we introduce the notion of emulation and systems modeling with Gaussian processes.">
<meta property="og:type" content="article"><meta property="og:url" content="/gpss/lectures/00-13-emulation.html">

<script type="text/javascript" async="" src="./Lawrence2021_files/MathJax.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none; box-sizing: content-box}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_test {font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.MathJax_test.mjx-test-display {display: table!important}
.MathJax_test.mjx-test-inline {display: inline!important; margin-right: -1px}
.MathJax_test.mjx-test-default {display: block!important; clear: both}
.MathJax_ex_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60ex}
.MathJax_em_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60em}
.mjx-test-inline .MathJax_left_box {display: inline-block; width: 0; float: left}
.mjx-test-inline .MathJax_right_box {display: inline-block; width: 0; float: right}
.mjx-test-display .MathJax_right_box {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body data-new-gr-c-s-check-loaded="14.1028.0" data-gr-ext-installed=""><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"><br></div></div><div id="MathJax_Message" style="display: none;"></div>



<header class="site-header">

  <div class="wrapper">

    <a class="site-title" rel="author" href="https://mlatcl.github.io/gpss/">Gaussian Process Summer School</a>

  

    <nav class="site-nav">
  <input type="checkbox" id="nav-trigger" class="nav-trigger">
  <label for="nav-trigger">
    <span class="menu-icon">
      <svg viewBox="0 0 18 15" width="18px" height="15px">
  <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
</svg>

    </span>
  </label>
  <div class="trigger">
         
    
    <a class="page-link" href="https://mlatcl.github.io/gpss/">Gaussian Process Summer Schoool Lectures</a>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
  </div>
</nav>

  </div>
</header>

<main class="page-content" aria-label="Content"><div class="wrapper">


<p style="text-align:right">[<a href="https://github.com/lawrennd/talks/edit/gh-pages/_gpss/emulation.md" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Edit Page&#39;, &#39;Edit&#39;, &#39;https://github.com/lawrennd/talks/edit/gh-pages/_gpss/emulation.md&#39;, 13);">edit</a>]</p>

<article class="post h-entry" itemscope="" itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Emulation</h1>
    <p class="post-meta"><time class="dt-published" datetime="" itemprop="datePublished">
        
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <div style="display:none">
  <span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot; /&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mrow" id="MathJax-Span-2"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.128em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">\newcommand{\tk}[1]{}
\newcommand{\Amatrix}{\mathbf{A}}
\newcommand{\KL}[2]{\text{KL}\left( #1\,\|\,#2 \right)}
\newcommand{\Kaast}{\kernelMatrix_{\mathbf{ \ast}\mathbf{ \ast}}}
\newcommand{\Kastu}{\kernelMatrix_{\mathbf{ \ast} \inducingVector}}
\newcommand{\Kff}{\kernelMatrix_{\mappingFunctionVector \mappingFunctionVector}}
\newcommand{\Kfu}{\kernelMatrix_{\mappingFunctionVector \inducingVector}}
\newcommand{\Kuast}{\kernelMatrix_{\inducingVector \bf\ast}}
\newcommand{\Kuf}{\kernelMatrix_{\inducingVector \mappingFunctionVector}}
\newcommand{\Kuu}{\kernelMatrix_{\inducingVector \inducingVector}}
\newcommand{\Kuui}{\Kuu^{-1}}
\newcommand{\Qaast}{\mathbf{Q}_{\bf \ast \ast}}
\newcommand{\Qastf}{\mathbf{Q}_{\ast \mappingFunction}}
\newcommand{\Qfast}{\mathbf{Q}_{\mappingFunctionVector \bf \ast}}
\newcommand{\Qff}{\mathbf{Q}_{\mappingFunctionVector \mappingFunctionVector}}
\newcommand{\aMatrix}{\mathbf{A}}
\newcommand{\aScalar}{a}
\newcommand{\aVector}{\mathbf{a}}
\newcommand{\acceleration}{a}
\newcommand{\bMatrix}{\mathbf{B}}
\newcommand{\bScalar}{b}
\newcommand{\bVector}{\mathbf{b}}
\newcommand{\basisFunc}{\phi}
\newcommand{\basisFuncVector}{\boldsymbol{ \basisFunc}}
\newcommand{\basisFunction}{\phi}
\newcommand{\basisLocation}{\mu}
\newcommand{\basisMatrix}{\boldsymbol{ \Phi}}
\newcommand{\basisScalar}{\basisFunction}
\newcommand{\basisVector}{\boldsymbol{ \basisFunction}}
\newcommand{\activationFunction}{\phi}
\newcommand{\activationMatrix}{\boldsymbol{ \Phi}}
\newcommand{\activationScalar}{\basisFunction}
\newcommand{\activationVector}{\boldsymbol{ \basisFunction}}
\newcommand{\bigO}{\mathcal{O}}
\newcommand{\binomProb}{\pi}
\newcommand{\cMatrix}{\mathbf{C}}
\newcommand{\cbasisMatrix}{\hat{\boldsymbol{ \Phi}}}
\newcommand{\cdataMatrix}{\hat{\dataMatrix}}
\newcommand{\cdataScalar}{\hat{\dataScalar}}
\newcommand{\cdataVector}{\hat{\dataVector}}
\newcommand{\centeredKernelMatrix}{\mathbf{ \MakeUppercase{\centeredKernelScalar}}}
\newcommand{\centeredKernelScalar}{b}
\newcommand{\centeredKernelVector}{\centeredKernelScalar}
\newcommand{\centeringMatrix}{\mathbf{H}}
\newcommand{\chiSquaredDist}[2]{\chi_{#1}^{2}\left(#2\right)}
\newcommand{\chiSquaredSamp}[1]{\chi_{#1}^{2}}
\newcommand{\conditionalCovariance}{\boldsymbol{ \Sigma}}
\newcommand{\coregionalizationMatrix}{\mathbf{B}}
\newcommand{\coregionalizationScalar}{b}
\newcommand{\coregionalizationVector}{\mathbf{ \coregionalizationScalar}}
\newcommand{\covDist}[2]{\text{cov}_{#2}\left(#1\right)}
\newcommand{\covSamp}[1]{\text{cov}\left(#1\right)}
\newcommand{\covarianceScalar}{c}
\newcommand{\covarianceVector}{\mathbf{ \covarianceScalar}}
\newcommand{\covarianceMatrix}{\mathbf{C}}
\newcommand{\covarianceMatrixTwo}{\boldsymbol{ \Sigma}}
\newcommand{\croupierScalar}{s}
\newcommand{\croupierVector}{\mathbf{ \croupierScalar}}
\newcommand{\croupierMatrix}{\mathbf{ \MakeUppercase{\croupierScalar}}}
\newcommand{\dataDim}{p}
\newcommand{\dataIndex}{i}
\newcommand{\dataIndexTwo}{j}
\newcommand{\dataMatrix}{\mathbf{Y}}
\newcommand{\dataScalar}{y}
\newcommand{\dataSet}{\mathcal{D}}
\newcommand{\dataStd}{\sigma}
\newcommand{\dataVector}{\mathbf{ \dataScalar}}
\newcommand{\decayRate}{d}
\newcommand{\degreeMatrix}{\mathbf{ \MakeUppercase{\degreeScalar}}}
\newcommand{\degreeScalar}{d}
\newcommand{\degreeVector}{\mathbf{ \degreeScalar}}
\newcommand{\diag}[1]{\text{diag}\left(#1\right)}
\newcommand{\diagonalMatrix}{\mathbf{D}}
\newcommand{\diff}[2]{\frac{\text{d}#1}{\text{d}#2}}
\newcommand{\diffTwo}[2]{\frac{\text{d}^2#1}{\text{d}#2^2}}
\newcommand{\displacement}{x}
\newcommand{\displacementVector}{\textbf{\displacement}}
\newcommand{\distanceMatrix}{\mathbf{ \MakeUppercase{\distanceScalar}}}
\newcommand{\distanceScalar}{d}
\newcommand{\distanceVector}{\mathbf{ \distanceScalar}}
\newcommand{\eigenvaltwo}{\ell}
\newcommand{\eigenvaltwoMatrix}{\mathbf{L}}
\newcommand{\eigenvaltwoVector}{\mathbf{l}}
\newcommand{\eigenvalue}{\lambda}
\newcommand{\eigenvalueMatrix}{\boldsymbol{ \Lambda}}
\newcommand{\eigenvalueVector}{\boldsymbol{ \lambda}}
\newcommand{\eigenvector}{\mathbf{ \eigenvectorScalar}}
\newcommand{\eigenvectorMatrix}{\mathbf{U}}
\newcommand{\eigenvectorScalar}{u}
\newcommand{\eigenvectwo}{\mathbf{v}}
\newcommand{\eigenvectwoMatrix}{\mathbf{V}}
\newcommand{\eigenvectwoScalar}{v}
\newcommand{\entropy}[1]{\mathcal{H}\left(#1\right)}
\newcommand{\errorFunction}{E}
\newcommand{\expDist}[2]{\left<#1\right>_{#2}}
\newcommand{\expSamp}[1]{\left<#1\right>}
\newcommand{\expectation}[1]{\left\langle #1 \right\rangle }
\newcommand{\expectationDist}[2]{\left\langle #1 \right\rangle _{#2}}
\newcommand{\expectedDistanceMatrix}{\mathcal{D}}
\newcommand{\eye}{\mathbf{I}}
\newcommand{\fantasyDim}{r}
\newcommand{\fantasyMatrix}{\mathbf{ \MakeUppercase{\fantasyScalar}}}
\newcommand{\fantasyScalar}{z}
\newcommand{\fantasyVector}{\mathbf{ \fantasyScalar}}
\newcommand{\featureStd}{\varsigma}
\newcommand{\gammaCdf}[3]{\mathcal{GAMMA CDF}\left(#1|#2,#3\right)}
\newcommand{\gammaDist}[3]{\mathcal{G}\left(#1|#2,#3\right)}
\newcommand{\gammaSamp}[2]{\mathcal{G}\left(#1,#2\right)}
\newcommand{\gaussianDist}[3]{\mathcal{N}\left(#1|#2,#3\right)}
\newcommand{\gaussianSamp}[2]{\mathcal{N}\left(#1,#2\right)}
\newcommand{\uniformDist}[3]{\mathcal{U}\left(#1|#2,#3\right)}
\newcommand{\uniformSamp}[2]{\mathcal{U}\left(#1,#2\right)}
\newcommand{\given}{|}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\heaviside}{H}
\newcommand{\hiddenMatrix}{\mathbf{ \MakeUppercase{\hiddenScalar}}}
\newcommand{\hiddenScalar}{h}
\newcommand{\hiddenVector}{\mathbf{ \hiddenScalar}}
\newcommand{\identityMatrix}{\eye}
\newcommand{\inducingInputScalar}{z}
\newcommand{\inducingInputVector}{\mathbf{ \inducingInputScalar}}
\newcommand{\inducingInputMatrix}{\mathbf{Z}}
\newcommand{\inducingScalar}{u}
\newcommand{\inducingVector}{\mathbf{ \inducingScalar}}
\newcommand{\inducingMatrix}{\mathbf{U}}
\newcommand{\inlineDiff}[2]{\text{d}#1/\text{d}#2}
\newcommand{\inputDim}{q}
\newcommand{\inputMatrix}{\mathbf{X}}
\newcommand{\inputScalar}{x}
\newcommand{\inputSpace}{\mathcal{X}}
\newcommand{\inputVals}{\inputVector}
\newcommand{\inputVector}{\mathbf{ \inputScalar}}
\newcommand{\iterNum}{k}
\newcommand{\kernel}{\kernelScalar}
\newcommand{\kernelMatrix}{\mathbf{K}}
\newcommand{\kernelScalar}{k}
\newcommand{\kernelVector}{\mathbf{ \kernelScalar}}
\newcommand{\kff}{\kernelScalar_{\mappingFunction \mappingFunction}}
\newcommand{\kfu}{\kernelVector_{\mappingFunction \inducingScalar}}
\newcommand{\kuf}{\kernelVector_{\inducingScalar \mappingFunction}}
\newcommand{\kuu}{\kernelVector_{\inducingScalar \inducingScalar}}
\newcommand{\lagrangeMultiplier}{\lambda}
\newcommand{\lagrangeMultiplierMatrix}{\boldsymbol{ \Lambda}}
\newcommand{\lagrangian}{L}
\newcommand{\laplacianFactor}{\mathbf{ \MakeUppercase{\laplacianFactorScalar}}}
\newcommand{\laplacianFactorScalar}{m}
\newcommand{\laplacianFactorVector}{\mathbf{ \laplacianFactorScalar}}
\newcommand{\laplacianMatrix}{\mathbf{L}}
\newcommand{\laplacianScalar}{\ell}
\newcommand{\laplacianVector}{\mathbf{ \ell}}
\newcommand{\latentDim}{q}
\newcommand{\latentDistanceMatrix}{\boldsymbol{ \Delta}}
\newcommand{\latentDistanceScalar}{\delta}
\newcommand{\latentDistanceVector}{\boldsymbol{ \delta}}
\newcommand{\latentForce}{f}
\newcommand{\latentFunction}{u}
\newcommand{\latentFunctionVector}{\mathbf{ \latentFunction}}
\newcommand{\latentFunctionMatrix}{\mathbf{ \MakeUppercase{\latentFunction}}}
\newcommand{\latentIndex}{j}
\newcommand{\latentScalar}{z}
\newcommand{\latentVector}{\mathbf{ \latentScalar}}
\newcommand{\latentMatrix}{\mathbf{Z}}
\newcommand{\learnRate}{\eta}
\newcommand{\lengthScale}{\ell}
\newcommand{\rbfWidth}{\ell}
\newcommand{\likelihoodBound}{\mathcal{L}}
\newcommand{\likelihoodFunction}{L}
\newcommand{\locationScalar}{\mu}
\newcommand{\locationVector}{\boldsymbol{ \locationScalar}}
\newcommand{\locationMatrix}{\mathbf{M}}
\newcommand{\variance}[1]{\text{var}\left( #1 \right)}
\newcommand{\mappingFunction}{f}
\newcommand{\mappingFunctionMatrix}{\mathbf{F}}
\newcommand{\mappingFunctionTwo}{g}
\newcommand{\mappingFunctionTwoMatrix}{\mathbf{G}}
\newcommand{\mappingFunctionTwoVector}{\mathbf{ \mappingFunctionTwo}}
\newcommand{\mappingFunctionVector}{\mathbf{ \mappingFunction}}
\newcommand{\scaleScalar}{s}
\newcommand{\mappingScalar}{w}
\newcommand{\mappingVector}{\mathbf{ \mappingScalar}}
\newcommand{\mappingMatrix}{\mathbf{W}}
\newcommand{\mappingScalarTwo}{v}
\newcommand{\mappingVectorTwo}{\mathbf{ \mappingScalarTwo}}
\newcommand{\mappingMatrixTwo}{\mathbf{V}}
\newcommand{\maxIters}{K}
\newcommand{\meanMatrix}{\mathbf{M}}
\newcommand{\meanScalar}{\mu}
\newcommand{\meanTwoMatrix}{\mathbf{M}}
\newcommand{\meanTwoScalar}{m}
\newcommand{\meanTwoVector}{\mathbf{ \meanTwoScalar}}
\newcommand{\meanVector}{\boldsymbol{ \meanScalar}}
\newcommand{\mrnaConcentration}{m}
\newcommand{\naturalFrequency}{\omega}
\newcommand{\neighborhood}[1]{\mathcal{N}\left( #1 \right)}
\newcommand{\neilurl}{http://inverseprobability.com/}
\newcommand{\noiseMatrix}{\boldsymbol{ E}}
\newcommand{\noiseScalar}{\epsilon}
\newcommand{\noiseVector}{\boldsymbol{ \epsilon}}
\newcommand{\norm}[1]{\left\Vert #1 \right\Vert}
\newcommand{\normalizedLaplacianMatrix}{\hat{\mathbf{L}}}
\newcommand{\normalizedLaplacianScalar}{\hat{\ell}}
\newcommand{\normalizedLaplacianVector}{\hat{\mathbf{ \ell}}}
\newcommand{\numActive}{m}
\newcommand{\numBasisFunc}{m}
\newcommand{\numComponents}{m}
\newcommand{\numComps}{K}
\newcommand{\numData}{n}
\newcommand{\numFeatures}{K}
\newcommand{\numHidden}{h}
\newcommand{\numInducing}{m}
\newcommand{\numLayers}{\ell}
\newcommand{\numNeighbors}{K}
\newcommand{\numSequences}{s}
\newcommand{\numSuccess}{s}
\newcommand{\numTasks}{m}
\newcommand{\numTime}{T}
\newcommand{\numTrials}{S}
\newcommand{\outputIndex}{j}
\newcommand{\paramVector}{\boldsymbol{ \theta}}
\newcommand{\parameterMatrix}{\boldsymbol{ \Theta}}
\newcommand{\parameterScalar}{\theta}
\newcommand{\parameterVector}{\boldsymbol{ \parameterScalar}}
\newcommand{\partDiff}[2]{\frac{\partial#1}{\partial#2}}
\newcommand{\precisionScalar}{j}
\newcommand{\precisionVector}{\mathbf{ \precisionScalar}}
\newcommand{\precisionMatrix}{\mathbf{J}}
\newcommand{\pseudotargetScalar}{\widetilde{y}}
\newcommand{\pseudotargetVector}{\mathbf{ \pseudotargetScalar}}
\newcommand{\pseudotargetMatrix}{\mathbf{ \widetilde{Y}}}
\newcommand{\rank}[1]{\text{rank}\left(#1\right)}
\newcommand{\rayleighDist}[2]{\mathcal{R}\left(#1|#2\right)}
\newcommand{\rayleighSamp}[1]{\mathcal{R}\left(#1\right)}
\newcommand{\responsibility}{r}
\newcommand{\rotationScalar}{r}
\newcommand{\rotationVector}{\mathbf{ \rotationScalar}}
\newcommand{\rotationMatrix}{\mathbf{R}}
\newcommand{\sampleCovScalar}{s}
\newcommand{\sampleCovVector}{\mathbf{ \sampleCovScalar}}
\newcommand{\sampleCovMatrix}{\mathbf{s}}
\newcommand{\scalarProduct}[2]{\left\langle{#1},{#2}\right\rangle}
\newcommand{\sign}[1]{\text{sign}\left(#1\right)}
\newcommand{\sigmoid}[1]{\sigma\left(#1\right)}
\newcommand{\singularvalue}{\ell}
\newcommand{\singularvalueMatrix}{\mathbf{L}}
\newcommand{\singularvalueVector}{\mathbf{l}}
\newcommand{\sorth}{\mathbf{u}}
\newcommand{\spar}{\lambda}
\newcommand{\trace}[1]{\text{tr}\left(#1\right)}
\newcommand{\BasalRate}{B}
\newcommand{\DampingCoefficient}{C}
\newcommand{\DecayRate}{D}
\newcommand{\Displacement}{X}
\newcommand{\LatentForce}{F}
\newcommand{\Mass}{M}
\newcommand{\Sensitivity}{S}
\newcommand{\basalRate}{b}
\newcommand{\dampingCoefficient}{c}
\newcommand{\mass}{m}
\newcommand{\sensitivity}{s}
\newcommand{\springScalar}{\kappa}
\newcommand{\springVector}{\boldsymbol{ \kappa}}
\newcommand{\springMatrix}{\boldsymbol{ \mathcal{K}}}
\newcommand{\tfConcentration}{p}
\newcommand{\tfDecayRate}{\delta}
\newcommand{\tfMrnaConcentration}{f}
\newcommand{\tfVector}{\mathbf{ \tfConcentration}}
\newcommand{\velocity}{v}
\newcommand{\sufficientStatsScalar}{g}
\newcommand{\sufficientStatsVector}{\mathbf{ \sufficientStatsScalar}}
\newcommand{\sufficientStatsMatrix}{\mathbf{G}}
\newcommand{\switchScalar}{s}
\newcommand{\switchVector}{\mathbf{ \switchScalar}}
\newcommand{\switchMatrix}{\mathbf{S}}
\newcommand{\tr}[1]{\text{tr}\left(#1\right)}
\newcommand{\loneNorm}[1]{\left\Vert #1 \right\Vert_1}
\newcommand{\ltwoNorm}[1]{\left\Vert #1 \right\Vert_2}
\newcommand{\onenorm}[1]{\left\vert#1\right\vert_1}
\newcommand{\twonorm}[1]{\left\Vert #1 \right\Vert}
\newcommand{\vScalar}{v}
\newcommand{\vVector}{\mathbf{v}}
\newcommand{\vMatrix}{\mathbf{V}}
\newcommand{\varianceDist}[2]{\text{var}_{#2}\left( #1 \right)}
\newcommand{\vecb}[1]{\left(#1\right):}
\newcommand{\weightScalar}{w}
\newcommand{\weightVector}{\mathbf{ \weightScalar}}
\newcommand{\weightMatrix}{\mathbf{W}}
\newcommand{\weightedAdjacencyMatrix}{\mathbf{A}}
\newcommand{\weightedAdjacencyScalar}{a}
\newcommand{\weightedAdjacencyVector}{\mathbf{ \weightedAdjacencyScalar}}
\newcommand{\onesVector}{\mathbf{1}}
\newcommand{\zerosVector}{\mathbf{0}}
</script>
</div>

<script src="./Lawrence2021_files/figure-magnify.js"></script>
<script src="./Lawrence2021_files/figure-animate.js"></script>
    
<div id="modal-frame" class="modal">
  <span class="close" onclick="closeMagnify()">×</span>
  <div class="modal-figure">
    <div class="figure-frame">
      <div class="modal-content" id="modal01"></div>
      <!--<img class="modal-content" id="object01">-->
    </div>
    <div class="caption-frame" id="modal-caption"></div>
  </div>
</div>	  

<div class="post">

  <article class="post-content">

     at <b></b> on 
[<a href="https://nbviewer.jupyter.org/github/mlatcl/gpss/blob/gh-pages/_notebooks/00-13-emulation.ipynb" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Jupyter Downloads&#39;, &#39;Download&#39;, https://nbviewer.jupyter.org/github/mlatcl/gpss/blob/gh-pages/_notebooks/00-13-emulation.ipynb, 10);">jupyter</a>][<a href="https://colab.research.google.com/github/mlatcl/gpss/blob/gh-pages/_notebooks/00-13-emulation.ipynb" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Colab Opens&#39;, &#39;Download&#39;, https://colab.research.google.com/github/mlatcl/gpss/blob/gh-pages/_notebooks/00-13-emulation.ipynb, 10);">google colab</a>][<a href="https://mlatcl.github.io/gpss/slides/00-13-emulation.slides.html" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Reveal Downloads&#39;, &#39;Download&#39;, //gpss/slides/00-13-emulation.slides.html, 10);">reveal</a>]
<div id="authors"></div>
<p><iframe width="512" height="384" src="./Lawrence2021_files/00-13-emulation.slides.html" frameborder="0" allowfullscreen=""></iframe></p>




<h4>Abstract</h4>
    
  <p></p><p>In this session we introduce the notion of emulation and systems modeling with Gaussian processes.</p>
<p></p><!-- Do not edit this file locally. -->
<p>p</p>
<!---->
<!-- Do not edit this file locally. -->
<!-- Do not edit this file locally. -->
<!-- The last names to be defined. Should be defined entirely in terms of macros from above-->
<!--

-->
<blockquote>
<p>We may regard the present state of the universe as the effect of its past and the cause of its future. An intellect which at a certain moment would know all forces that set nature in motion, and all positions of all items of which nature is composed, …</p>
</blockquote>
<blockquote>
<p>… if this intellect were also vast enough to submit these data to analysis, it would embrace in a single formula the movements of the greatest bodies of the universe and those of the tiniest atom; for such an intellect nothing would be uncertain and the future just like the past would be present before its eyes.</p>
<p>— Pierre Simon Laplace <span class="citation" data-cites="Laplace-essai14">(Laplace, 1814)</span></p>
</blockquote>
<h2 id="game-of-life">Game of Life</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span class="editsection" style=""><a href="https://github.com/lawrennd/talks/edit/gh-pages/_simulation/includes/game-of-life.md" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Edit Page&#39;, &#39;Edit&#39;, &#39;https://github.com/lawrennd/talks/edit/gh-pages/_simulation/includes/game-of-life.md&#39;, 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p><a href="https://en.wikipedia.org/wiki/John_Horton_Conway">John Horton Conway</a> was a mathematician who developed a game known as the Game of Life. He died in April 2020, but since he invented the game, he was in effect ‘god’ for this game. But as we will see, just inventing the rules doesn’t give you omniscience in the game.</p>
<p>The Game of Life is played on a grid of squares, or pixels. Each pixel is either on or off. The game has no players, but a set of simple rules that are followed at each turn the rules are.</p>
<h2 id="life-rules">Life Rules</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span class="editsection" style=""><a href="https://github.com/lawrennd/talks/edit/gh-pages/_simulation/includes/life-rules.md" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Edit Page&#39;, &#39;Edit&#39;, &#39;https://github.com/lawrennd/talks/edit/gh-pages/_simulation/includes/life-rules.md&#39;, 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>John Conway’s game of life is a cellular automata where the cells obey three very simple rules. The cells live on a rectangular grid, so that each cell has 8 possible neighbors.</p>
<div class="figure">
<div id="life-rules-loneliness-figure" class="figure-frame">
<table>
<tbody><tr>
<td width="70%">
<table>
<tbody><tr>
<td width="30%">
<center>
<object class="" data="./Lawrence2021_files/life-rules-1-0.svg" width="100%" style=" ">
</object>
</center>
</td>
<td width="39%">
<center>
<em>loneliness</em>
</center>
<center>
<object class="svgplot " data="./Lawrence2021_files/right-arrow.svg" width="60%" style=" ">
</object>
</center>
</td>
<td width="30%">
<center>
<object class="" data="./Lawrence2021_files/life-rules-1-1.svg" width="100%" style=" ">
</object>
</center>
</td>
</tr>
</tbody></table>
</td>
<td width="30%">
<center>
<div class="centered centered" style="">
<img class="" src="./Lawrence2021_files/John-Conway.jpg" width="100%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</center>
</td>
</tr>
</tbody></table>
</div>
<div id="life-rules-loneliness-magnify" class="magnify" onclick="magnifyFigure(&#39;life-rules-loneliness&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="life-rules-loneliness-caption" class="caption-frame">
<p>Figure: ‘Death’ through loneliness in Conway’s game of life. If a cell is surrounded by less than three cells, it ‘dies’ through loneliness.</p>
</div>
</div>
<p>The game proceeds in turns, and at each location in the grid is either alive or dead. Each turn, a cell counts its neighbors. If there are two or fewer neighbors, the cell ‘dies’ of ‘loneliness.’</p>
<div class="figure">
<div id="life-rules-crowding-figure" class="figure-frame">
<table>
<tbody><tr>
<td width="70%">
<table>
<tbody><tr>
<td width="30%">
<center>
<object class="" data="./Lawrence2021_files/life-rules-2-0.svg" width="100%" style=" ">
</object>
</center>
</td>
<td width="39%">
<center>
<em>overcrowding</em>
</center>
<center>
<object class="svgplot " data="./Lawrence2021_files/right-arrow.svg" width="60%" style=" ">
</object>
</center>
</td>
<td width="30%">
<center>
<object class="" data="./Lawrence2021_files/life-rules-2-1.svg" width="100%" style=" ">
</object>
</center>
</td>
</tr>
</tbody></table>
</td>
<td width="30%">
<center>
<div class="centered centered" style="">
<img class="" src="./Lawrence2021_files/John-Conway.jpg" width="100%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</center>
</td>
</tr>
</tbody></table>
</div>
<div id="life-rules-crowding-magnify" class="magnify" onclick="magnifyFigure(&#39;life-rules-crowding&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="life-rules-crowding-caption" class="caption-frame">
<p>Figure: ‘Death’ through overpopulation in Conway’s game of life. If a cell is surrounded by more than three cells, it ‘dies’ through loneliness.</p>
</div>
</div>
<p>If there are four or more neigbors, the cell ‘dies’ from ‘overcrowding.’ If there are three neigbors, the cell persists, or if it is currently dead, a new cell is born.</p>
<div class="figure">
<div id="life-rules-crowding-figure" class="figure-frame">
<table>
<tbody><tr>
<td width="70%">
<table>
<tbody><tr>
<td width="30%">
<center>
<object class="" data="./Lawrence2021_files/life-rules-3-0.svg" width="100%" style=" ">
</object>
</center>
</td>
<td width="39%">
<center>
<em>birth</em>
</center>
<center>
<object class="svgplot " data="./Lawrence2021_files/right-arrow.svg" width="60%" style=" ">
</object>
</center>
</td>
<td width="30%">
<center>
<object class="" data="./Lawrence2021_files/life-rules-3-1.svg" width="100%" style=" ">
</object>
</center>
</td>
</tr>
</tbody></table>
</td>
<td width="30%">
<center>
<div class="centered centered" style="">
<img class="" src="./Lawrence2021_files/John-Conway.jpg" width="100%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</center>
</td>
</tr>
</tbody></table>
</div>
<div id="life-rules-crowding-magnify" class="magnify" onclick="magnifyFigure(&#39;life-rules-crowding&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="life-rules-crowding-caption" class="caption-frame">
<p>Figure: Birth in Conway’s life. Any position surounded by precisely three live cells will give birth to a new cell at the next turn.</p>
</div>
</div>
<p>And that’s it. Those are the simple ‘physical laws’ for Conway’s game.</p>
<p>The game leads to patterns emerging, some of these patterns are static, but some oscillate in place, with varying periods. Others oscillate, but when they complete their cycle they’ve translated to a new location, in other words they move. In Life the former are known as <a href="https://conwaylife.com/wiki/Oscillator">oscillators</a> and the latter as <a href="https://conwaylife.com/wiki/Spaceship">spaceships</a>.</p>
<h2 id="loafers-and-gliders">Loafers and Gliders</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span class="editsection" style=""><a href="https://github.com/lawrennd/talks/edit/gh-pages/_simulation/includes/life-glider-loafer-conway.md" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Edit Page&#39;, &#39;Edit&#39;, &#39;https://github.com/lawrennd/talks/edit/gh-pages/_simulation/includes/life-glider-loafer-conway.md&#39;, 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>John Horton Conway, as the creator of the game of life, could be seen somehow as the god of this small universe. He created the rules. The rules are so simple that in many senses he, and we, are all-knowing in this space. But despite our knowledge, this world can still ‘surprise’ us. From the simple rules, emergent patterns of behaviour arise. These include static patterns that don’t change from one turn to the next. They also include, oscillators, that pulse between different forms across different periods of time. A particular form of oscillator is known as a ‘spaceship,’ this is one that moves across the board as the game evolves. One of the simplest and earliest spaceships to be discovered is known as the glider.</p>
<div class="figure">
<div id="glider-loafer-conway-figure" class="figure-frame">
<table>
<tbody><tr>
<td width="45%">
<center>
<em>Glider (1969)</em>
</center>
<center>
<div class="centered" style="">
<img class="" src="./Lawrence2021_files/Glider.gif" width="80%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</center>
</td>
<td width="45%">
<div class="centered centered" style="">
<img class="" src="./Lawrence2021_files/John-Conway.jpg" width="80%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</td>
</tr>
</tbody></table>
</div>
<div id="glider-loafer-conway-magnify" class="magnify" onclick="magnifyFigure(&#39;glider-loafer-conway&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="glider-loafer-conway-caption" class="caption-frame">
<p>Figure: <em>Left</em> A Glider pattern discovered 1969 by Richard K. Guy. <em>Right</em>. John Horton Conway, creator of <em>Life</em> (1937-2020). The glider is an oscillator that moves diagonally after creation. From the simple rules of Life it’s not obvious that such an object does exist, until you do the necessary computation.</p>
</div>
</div>
<p>The glider was ‘discovered’ in 1969 by Richard K. Guy. What do we mean by discovered in this context? Well, as soon as the game of life is defined, objects such as the glider do somehow exist, but the many configurations of the game mean that it takes some time for us to see one and know it exists. This means, that despite being the creator, Conway, and despite the rules of the game being simple, and despite the rules being deterministic, we are not ‘omniscient’ in any simplistic sense. It requires computation to ‘discover’ what can exist in this universe once it’s been defined.</p>
<div class="figure">
<div id="gosper-glider-gun-figure" class="figure-frame">
<div class="centered" style="">
<img class="" src="./Lawrence2021_files/Gosperglidergun.gif" width="80%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</div>
<div id="gosper-glider-gun-magnify" class="magnify" onclick="magnifyFigure(&#39;gosper-glider-gun&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="gosper-glider-gun-caption" class="caption-frame">
<p>Figure: The Gosper glider gun is a configuration that creates gliders. A new glider is released after every 30 turns.</p>
</div>
</div>
<p>These patterns had to be discovered, in the same way that a scientist might discover a disease, or an explorer a new land. For example, the Gosper glider gun was <a href="https://conwaylife.com/wiki/Bill_Gosper">discovered by Bill Gosper in 1970</a>. It is a pattern that creates a new glider every 30 turns of the game.</p>
<p>Despite widespread interest in Life, some of its patterns were only very recently discovered like the Loafer, discovered in 2013 by Josh Ball. So despite the game having existed for over forty years, and the rules of the game being simple, there are emergent behaviours that are unknown.</p>
<div class="figure">
<div id="the-loafer-spaceship-figure" class="figure-frame">
<table>
<tbody><tr>
<td width="45%">
<center>
<em>Loafer (2013)</em>
</center>
<center>
<div class="centered" style="">
<img class="" src="./Lawrence2021_files/Loafer.gif" width="80%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</center>
</td>
<td width="45%">
<div class="centered centered" style="">
<img class="" src="./Lawrence2021_files/John-Conway.jpg" width="80%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</td>
</tr>
</tbody></table>
</div>
<div id="the-loafer-spaceship-magnify" class="magnify" onclick="magnifyFigure(&#39;the-loafer-spaceship&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="the-loafer-spaceship-caption" class="caption-frame">
<p>Figure: <em>Left</em> A Loafer pattern discovered by Josh Ball in 2013. <em>Right</em>. John Horton Conway, creator of <em>Life</em> (1937-2020).</p>
</div>
</div>
<p>Once these patterns are discovered, they are combined (or engineered) to create new Life patterns that do some remarkable things. For example, there’s a life pattern that runs a Turing machine, or more remarkably there’s a Life pattern that runs Life itself.</p>
<div class="figure">
<div id="life-in-life-figure" class="figure-frame">
<div class="centered" style="">
<img class="" src="./Lawrence2021_files/life-in-life.gif" width="80%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</div>
<div id="life-in-life-magnify" class="magnify" onclick="magnifyFigure(&#39;life-in-life&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="life-in-life-caption" class="caption-frame">
<p>Figure: The Game of Life running in Life. The video is drawing out recursively showing pixels that are being formed by filling cells with moving spaceships. Each individual pixel in this game of life is made up of <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2048&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;2048&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3" style="width: 6.355em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.177em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1005.13em, 2.718em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-4"><span class="mn" id="MathJax-Span-5" style="font-family: STIXGeneral-Regular;">2048</span><span class="mo" id="MathJax-Span-6" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">×</span><span class="mn" id="MathJax-Span-7" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">2048</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2048</mn><mo>×</mo><mn>2048</mn></math></span></span><script type="math/tex" id="MathJax-Element-2">2048 \times 2048</script></span> pixels called an <a href="https://www.conwaylife.com/wiki/OTCA_metapixel">OTCA metapixel</a>.</p>
</div>
</div>
<p>To find out more about the Game of Life you can watch this video by Alan Zucconi or read his <a href="https://www.alanzucconi.com/2020/10/13/conways-game-of-life/">associated blog post</a>.</p>
<div class="figure">
<div id="intro-to-life-figure" class="figure-frame">
<iframe width="600" height="450" src="./Lawrence2021_files/Kk2MH9O4pXY.html" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen="">
</iframe>
</div>
<div id="intro-to-life-magnify" class="magnify" onclick="magnifyFigure(&#39;intro-to-life&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="intro-to-life-caption" class="caption-frame">
<p>Figure: An introduction to the Game of Life by Alan Zucconi.</p>
</div>
</div>
<p>Contrast this with our situation where in ‘real life’ we don’t know the simple rules of the game, the state space is larger, and emergent behaviors (hurricanes, earthquakes, volcanos, climate change) have direct consequences for our daily lives, and we understand why the process of ‘understanding’ the physical world is so difficult. We also see immediately how much easier we might expect the physical sciences to be than the social sciences, where the emergent behaviors are contingent on highly complex human interactions.</p>
<p>We summarize this notion as <span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;data&lt;/mtext&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mtext&gt;model&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-REL&quot;&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;compute&lt;/mtext&gt;&lt;/mrow&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mtext&gt;prediction&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-8" style="width: 15.269em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.503em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1012.5em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-9"><span class="mtext" id="MathJax-Span-10" style="font-family: STIXGeneral-Regular;">data</span><span class="mo" id="MathJax-Span-11" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">+</span><span class="mtext" id="MathJax-Span-12" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">model</span><span class="texatom" id="MathJax-Span-13" style="padding-left: 0.31em;"><span class="mrow" id="MathJax-Span-14"><span class="munderover" id="MathJax-Span-15"><span style="display: inline-block; position: relative; width: 2.462em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.87em, 4.101em, -999.997em); top: -3.993em; left: 0.771em;"><span class="texatom" id="MathJax-Span-16"><span class="mrow" id="MathJax-Span-17"><span class="mo" id="MathJax-Span-18" style="font-family: STIXGeneral-Regular;">→</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1002.41em, 4.306em, -999.997em); top: -4.711em; left: 0em;"><span class="texatom" id="MathJax-Span-19"><span class="mrow" id="MathJax-Span-20"><span class="mtext" id="MathJax-Span-21" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">compute</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span class="mtext" id="MathJax-Span-22" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">prediction</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.878em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>data</mtext><mo>+</mo><mtext>model</mtext><mrow class="MJX-TeXAtom-REL"><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mo stretchy="false">→</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>compute</mtext></mrow></mover></mrow><mtext>prediction</mtext></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-3">
\text{data} + \text{model} \stackrel{\text{compute}}{\rightarrow} \text{prediction}
</script></span> As we pointed out, there is an irony in Laplace’s demon forming the cornerstone of a movement known as ‘determinism,’ because Laplace wrote about this idea in an essay on probabilities. The more important quote in the essay was</p>
<h2 id="laplaces-gremlin">Laplace’s Gremlin</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span class="editsection" style=""><a href="https://github.com/lawrennd/talks/edit/gh-pages/_physics/includes/laplaces-gremlin.md" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Edit Page&#39;, &#39;Edit&#39;, &#39;https://github.com/lawrennd/talks/edit/gh-pages/_physics/includes/laplaces-gremlin.md&#39;, 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<blockquote>
<p>The curve described by a simple molecule of air or vapor is regulated in a manner just as certain as the planetary orbits; the only difference between them is that which comes from our ignorance. Probability is relative, in part to this ignorance, in part to our knowledge. We know that of three or greater number of events a single one ought to occur; but nothing induces us to believe that one of them will occur rather than the others. In this state of indecision it is impossible for us to announce their occurrence with certainty. It is, however, probable that one of these events, chosen at will, will not occur because we see several cases equally possible which exclude its occurrence, while only a single one favors it.</p>
<p>— Pierre-Simon Laplace <span class="citation" data-cites="Laplace-essai14">(Laplace, 1814)</span>, pg 5</p>
</blockquote>
<p>The representation of ignorance through probability is the true message of Laplace, I refer to this message as “Laplace’s gremlin,” because it is the gremlin of uncertainty that interferes with the demon of determinism to mean that our predictions are not deterministic.</p>
<p>Our separation of the uncertainty into the data, the model and the computation give us three domains in which our doubts can creep into our ability to predict. Over the last three lectures we’ve introduced some of the basic tools we can use to unpick this uncertainty. You’ve been introduced to, (or have yow reviewed) <em>Bayes’ rule</em>. The rule, which is a simple consequence of the product rule of probability, is the foundation of how we update our beliefs in the presence of new information.</p>
<p>The real point of Laplace’s essay was that we don’t have access to all the data, we don’t have access to a complete physical understanding, and as the example of the Game of Life shows, even if we did have access to both (as we do for “Conway’s universe”) we still don’t have access to all the compute that we need to make deterministic predictions. There is uncertainty in the system which means we can’t make precise predictions.</p>
<p>I like to call this “Laplace’s Gremlin.” Gremlins are imaginary creatures used as an explanation of failure in aircraft, causing crashes. In that sense the Gremlin represents the uncertainty that a pilot felt about what might go wrong in a plane which might be “theoretically sound” but in practice is poorly maintained or exposed to conditions that take it beyond its design criteria. Laplace’s gremlin is all the things that your model, data and ability to compute don’t account for bringing about failures in your ability to predict. Laplace’s Gremlin is the uncertainty in the system.</p>
<div class="figure">
<div id="germlins-think-its-fun-to-hurt-you-figure" class="figure-frame">
<div class="centered centered" style="">
<img class="" src="./Lawrence2021_files/gremlins-think-its-fun-to-hurt-you.jpg" width="40%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</div>
<div id="germlins-think-its-fun-to-hurt-you-magnify" class="magnify" onclick="magnifyFigure(&#39;germlins-think-its-fun-to-hurt-you&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="germlins-think-its-fun-to-hurt-you-caption" class="caption-frame">
<p>Figure: Gremlins are seen as the cause of a number of challenges in this World War II poster.</p>
</div>
</div>
<h2 id="simulation-system">Simulation System</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span class="editsection" style=""><a href="https://github.com/lawrennd/talks/edit/gh-pages/_simulation/includes/simulation-system.md" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Edit Page&#39;, &#39;Edit&#39;, &#39;https://github.com/lawrennd/talks/edit/gh-pages/_simulation/includes/simulation-system.md&#39;, 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>An example of a complex decision-making system might be a climate model, in such a system there are separate models for the atmosphere, the ocean and the land.</p>
<p>The components of these systems include flowing of currents, chemical interactions in the upper atmosphere, evaporation of water etc..</p>
<div class="figure">
<div id="carbon-cycle-noaa-figure" class="figure-frame">
<div class="centered centered" style="">
<img class="" src="./Lawrence2021_files/carbon_cycle.jpg" width="60%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</div>
<div id="carbon-cycle-noaa-magnify" class="magnify" onclick="magnifyFigure(&#39;carbon-cycle-noaa&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="carbon-cycle-noaa-caption" class="caption-frame">
<p>Figure: Representation of the Carbon Cycle from the US National Oceanic and Atmospheric Administration. While everything is interconnected in the system, we can decompose into separate models for atmosphere, ocean, land.</p>
</div>
</div>
<p>The influence of human activity also needs to be incorporated and modelled so we can make judgments about how to mitigate the effects of global warming.</p>
<div class="figure">
<div id="simulation-system-components-figure" class="figure-frame">
<object class="svgplot " data="./Lawrence2021_files/simulation-schematic.svg" width="40%" style=" ">
</object>
</div>
<div id="simulation-system-components-magnify" class="magnify" onclick="magnifyFigure(&#39;simulation-system-components&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="simulation-system-components-caption" class="caption-frame">
<p>Figure: The components of a simulation system for climate modelling.</p>
</div>
</div>
<h2 id="monolithic-system">Monolithic System</h2>
<p>The classical approach to building these systems was a ‘monolithic system.’ Built in a similar way to the successful applications software such as Excel or Word, or large operating systems, a single code base was constructed. The complexity of such code bases run to many lines.</p>
<p>In practice, shared dynamically linked libraries may be used for aspects such as user interface, or networking, but the software often has many millions of lines of code. For example, the Microsoft Office suite is said to contain over 30 million lines of code.</p>
<div class="figure">
<div id="ml-system-monolith-simulation-figure" class="figure-frame">
<object class="svgplot " data="./Lawrence2021_files/ml-system-monolith-simulation.svg" width="60%" style=" ">
</object>
</div>
<div id="ml-system-monolith-simulation-magnify" class="magnify" onclick="magnifyFigure(&#39;ml-system-monolith-simulation&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="ml-system-monolith-simulation-caption" class="caption-frame">
<p>Figure: A potential path of models in a machine learning system.</p>
</div>
</div>
<h2 id="service-oriented-architecture">Service Oriented Architecture</h2>
<p>Such software is not only difficult to develop, but also to scale when computation demands increase. For example, Amazon’s original website software (called Obidos) was a <a href="https://en.wikipedia.org/wiki/Obidos_(software)">monolithic design</a> but by the early noughties it was becoming difficult to sustain and maintain. The software was phased out in 2006 to be replaced by a modularized software known as a ‘service-oriented architecture.’</p>
<p>In Service Oriented Architecture, or “Software as a Service” the idea is that code bases are modularized and communicate with one another using network requests. A standard approach is to use a <a href="https://en.wikipedia.org/wiki/Representational_state_transfer">REST API</a>. So, rather than a single monolithic code base, the code is developed with individual services that handle the different requests.</p>
<p>The simulation software is turned inside out to expose the individual components to the operator.</p>
<div class="figure">
<div id="ml-system-downstream-simulation-figure" class="figure-frame">
<object class="svgplot " data="./Lawrence2021_files/ml-system-downstream-simulation000.svg" width="60%" style=" ">
</object>
</div>
<div id="ml-system-downstream-simulation-magnify" class="magnify" onclick="magnifyFigure(&#39;ml-system-downstream-simulation&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="ml-system-downstream-simulation-caption" class="caption-frame">
<p>Figure: A potential path of models in a machine learning system.</p>
</div>
</div>
<p>This is the landscape we now find ourselves in for software development. In practice, each of these services is often ‘owned’ and maintained by an individual team. The team is judged by the quality of their service provision. They work to detailed specifications on what their service should output, what its availability should be and other objectives like speed of response. This allows for conditional independence between teams and for faster development.</p>
<p>One question is to what extent is the same approach possible/desirable for scientific models? The components we listed above are already separated and often run independently. But those components themselves are made up of other sub-components that could also be exposed in a similar manner to software-as-a-service, giving us the notion of “simulation as a service.”</p>
<h2 id="experiment-analyze-design">Experiment, Analyze, Design</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span class="editsection" style=""><a href="https://github.com/lawrennd/talks/edit/gh-pages/_supply-chain/includes/experiment-analyze-design.md" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Edit Page&#39;, &#39;Edit&#39;, &#39;https://github.com/lawrennd/talks/edit/gh-pages/_supply-chain/includes/experiment-analyze-design.md&#39;, 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>One thing about working in an industrial environment, is the way that short-term thinking actions become important. For example, in Formula One, the teams are working on a two-week cycle to digest information from the previous week’s race and incorporate updates to the car or their strategy.</p>
<p>However, businesses must also think about more medium-term horizons. For example, in Formula 1 you need to worry about next year’s car. So while you’re working on updating this year’s car, you also need to think about what will happen for next year and prioritize these conflicting needs appropriately.</p>
<p>In the Amazon supply chain, there are the equivalent demands. If we accept that an artificial intelligence is just an automated decision-making system. And if we measure in terms of money automatically spent, or goods automatically moved, then Amazon’s buying system is perhaps the world’s largest AI.</p>
<p>Those decisions are being made on short time schedules; purchases are made by the system on weekly cycles. But just as in Formula 1, there is also a need to think about what needs to be done next month, next quarter and next year. Planning meetings are held not only on a weekly basis (known as weekly business reviews), but monthly, quarterly, and then yearly meetings for planning spends and investments.</p>
<p>Amazon is known for being longer term thinking than many companies, and a lot of this is coming from the CEO. One quote from Jeff Bezos that stuck with me was the following.</p>
<blockquote>
<p>“I very frequently get the question: ‘What’s going to change in the next 10 years?’ And that is a very interesting question; it’s a very common one. I almost never get the question: ‘What’s not going to change in the next 10 years?’ And I submit to you that that second question is actually the more important of the two – because you can build a business strategy around the things that are stable in time. … [I]n our retail business, we know that customers want low prices, and I know that’s going to be true 10 years from now. They want fast delivery; they want vast selection. It’s impossible to imagine a future 10 years from now where a customer comes up and says, ‘Jeff I love Amazon; I just wish the prices were a little higher,’ [or] ‘I love Amazon; I just wish you’d deliver a little more slowly.’ Impossible. And so the effort we put into those things, spinning those things up, we know the energy we put into it today will still be paying off dividends for our customers 10 years from now. When you have something that you know is true, even over the long term, you can afford to put a lot of energy into it.”</p>
</blockquote>
<p>This quote is incredibly important for long term thinking. Indeed, it’s a failure of many of our simulations that they focus on what is going to happen, not what will not happen. In Amazon, this meant that there was constant focus on these three areas, keeping costs low, making delivery fast and improving selection. For example, shortly before I left Amazon moved its entire US network from two-day delivery to one-day delivery. This involves changing the way the entire buying system operates. Or, more recently, the company has had to radically change the portfolio of products it buys in the face of Covid19.</p>
<!--These challenges are not just there for Amazon and Formula 1. In Sheffield, we worked closely with a Chesterfield based company called Fusion Group. They make joints that fuse PTFE pipes together. These pipes are used for transporting both water and gas. Their founder, Eric Bridgstock, was an engineer who introduced PTFE piping to the UK when working for DuPont. Eric set up Fusion group to manufacture the fusion fittings. Because PTFE pipes carry water or gas at high pressure, when these fittings fail significant damage can occur. When these fittings were originally installed in the early 1980s, the job was done by a specialist, but nowadays the pipe weld is compelted by the same team that digs the hole. While costs have come down, the number of PTFE weld failures went up. Eric's company focussed on new systems for auto-->
<div class="figure">
<div id="experiment-analyze-design-figure" class="figure-frame">
<object class="svgplot " data="./Lawrence2021_files/experiment-analyze-design.svg" width="50%" style=" ">
</object>
</div>
<div id="experiment-analyze-design-magnify" class="magnify" onclick="magnifyFigure(&#39;experiment-analyze-design&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="experiment-analyze-design-caption" class="caption-frame">
<p>Figure: The experiment, analyze, design flywheel for scientific innovation.</p>
</div>
</div>
<p>From the perspective of the team that we had in the supply chain, we looked at what we most needed to focus on. Amazon moves very quickly, but we could also take a leaf out of Jeff’s book, and instead of worrying about what was going to change, remember what wasn’t going to change.</p>
<blockquote>
<p>We don’t know what science we’ll want to do in five years’ time, but we won’t want slower experiments, we won’t want more expensive experiments and we won’t want a narrower selection of experiments.</p>
</blockquote>
<p>As a result, our focus was on how to speed up the process of experiments, increase the diversity of experiments that we can do, and keep the experiments price as low as possible.</p>
<p>The faster the innovation flywheel can be iterated, then the quicker we can ask about different parts of the supply chain, and the better we can tailor systems to answering those questions.</p>
<p>As a result, our objective became a two-order magnitude increase in number of experiments run across a five-year period.</p>
<h2 id="statistical-emulation">Statistical Emulation</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span class="editsection" style=""><a href="https://github.com/lawrennd/talks/edit/gh-pages/_uq/includes/emulation.md" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Edit Page&#39;, &#39;Edit&#39;, &#39;https://github.com/lawrennd/talks/edit/gh-pages/_uq/includes/emulation.md&#39;, 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<div class="figure">
<div id="met-office-unified-model-figure" class="figure-frame">
<div class="centered" style="">
<img class="negate" src="./Lawrence2021_files/unified_model_systems_13022018_1920.png" width="60%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</div>
<div id="met-office-unified-model-magnify" class="magnify" onclick="magnifyFigure(&#39;met-office-unified-model&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="met-office-unified-model-caption" class="caption-frame">
<p>Figure: The UK Met office runs a shared code base for its simulations of climate and the weather. This plot shows the different spatial and temporal scales used.</p>
</div>
</div>
<p>In many real-world systems, decisions are made through simulating the environment. Simulations may operate at different granularities. For example, simulations are used in weather forecasts and climate forecasts. Interestingly, the UK Met office uses the same code for both, it has a <a href="https://www.metoffice.gov.uk/research/approach/modelling-systems/unified-model/index">“Unified Model” approach</a>, but they operate climate simulations at greater spatial and temporal resolutions.</p>
<div class="figure">
<div id="statistical-emulation-1-figure" class="figure-frame">
<object class="svgplot " data="./Lawrence2021_files/statistical-emulation000.svg" width="80%" style=" ">
</object>
</div>
<div id="statistical-emulation-1-magnify" class="magnify" onclick="magnifyFigure(&#39;statistical-emulation-1&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="statistical-emulation-1-caption" class="caption-frame">
<p>Figure: Real world systems consist of simulators that capture our domain knowledge about how our systems operate. Different simulators run at different speeds and granularities.</p>
</div>
</div>
<div class="figure">
<div id="statistical-emulation-2-figure" class="figure-frame">
<object class="svgplot " data="./Lawrence2021_files/statistical-emulation001.svg" width="80%" style=" ">
</object>
</div>
<div id="statistical-emulation-2-magnify" class="magnify" onclick="magnifyFigure(&#39;statistical-emulation-2&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="statistical-emulation-2-caption" class="caption-frame">
<p>Figure: A statistical emulator is a system that reconstructs the simulation with a statistical model.</p>
</div>
</div>
<p>A statistical emulator is a data-driven model that learns about the underlying simulation. Importantly, learns with uncertainty, so it ‘knows what it doesn’t know.’ In practice, we can call the emulator in place of the simulator. If the emulator ‘doesn’t know,’ it can call the simulator for the answer.</p>
<div class="figure">
<div id="statistical-emulation-5-figure" class="figure-frame">
<object class="svgplot " data="./Lawrence2021_files/statistical-emulation004.svg" width="80%" style=" ">
</object>
</div>
<div id="statistical-emulation-5-magnify" class="magnify" onclick="magnifyFigure(&#39;statistical-emulation-5&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="statistical-emulation-5-caption" class="caption-frame">
<p>Figure: A statistical emulator is a system that reconstructs the simulation with a statistical model. As well as reconstructing the simulation, a statistical emulator can be used to correlate with the real world.</p>
</div>
</div>
<p>As well as reconstructing an individual simulator, the emulator can calibrate the simulation to the real world, by monitoring differences between the simulator and real data. This allows the emulator to characterize where the simulation can be relied on, i.e., we can validate the simulator.</p>
<p>Similarly, the emulator can adjudicate between simulations. This is known as <em>multi-fidelity emulation</em>. The emulator characterizes which emulations perform well where.</p>
<p>If all this modelling is done with judicious handling of the uncertainty, the <em>computational doubt</em>, then the emulator can assist in desciding what experiment should be run next to aid a decision: should we run a simulator, in which case which one, or should we attempt to acquire data from a real-world intervention.</p>
<h2 id="gpy-and-emulation">GPy and Emulation</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span class="editsection" style=""><a href="https://github.com/lawrennd/talks/edit/gh-pages/_gp/includes/gpy-emulation.md" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Edit Page&#39;, &#39;Edit&#39;, &#39;https://github.com/lawrennd/talks/edit/gh-pages/_gp/includes/gpy-emulation.md&#39;, 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>Let <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-23" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.949em, 1000.51em, 2.718em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-24"><span class="texatom" id="MathJax-Span-25"><span class="mrow" id="MathJax-Span-26"><span class="mi" id="MathJax-Span-27" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-4">\mathbf{ x}</script></span> be a random variable defined over the real numbers, <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x211C;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-28" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.693em, 1000.82em, 2.718em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-29"><span class="mi" id="MathJax-Span-30" style="font-family: STIXGeneral-Regular;">ℜ</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">ℜ</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">\Re</script></span>, and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-31" style="width: 1.949em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.591em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1001.54em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-32"><span class="mi" id="MathJax-Span-33" style="font-family: STIXGeneral-Italic;">𝑓<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-34" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-35" style="font-family: STIXGeneral-Regular;">⋅</span><span class="mo" id="MathJax-Span-36" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mo>⋅</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-6">f(\cdot)</script></span> be a function mapping between the real numbers <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x211C;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x211C;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-37" style="width: 3.998em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.281em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.693em, 1003.23em, 2.718em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-38"><span class="mi" id="MathJax-Span-39" style="font-family: STIXGeneral-Regular;">ℜ</span><span class="mo" id="MathJax-Span-40" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">→</span><span class="mi" id="MathJax-Span-41" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">ℜ</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">ℜ</mi><mo stretchy="false">→</mo><mi mathvariant="normal">ℜ</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">\Re \rightarrow \Re</script></span>.</p>
<p>The problem of <em>uncertainty propagation</em> is the study of the distribution of the random variable <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-42" style="width: 2.205em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.796em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1001.74em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-43"><span class="mi" id="MathJax-Span-44" style="font-family: STIXGeneral-Italic;">𝑓<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-45" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-46"><span class="mrow" id="MathJax-Span-47"><span class="mi" id="MathJax-Span-48" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-49" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-8">f(\mathbf{ x})</script></span>.</p>
<p>We’re going to address this problem using emulation and GPy. We will see in this section the advantage of using a model when only a few observations of <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-50" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1000.62em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-51"><span class="mi" id="MathJax-Span-52" style="font-family: STIXGeneral-Italic;">𝑓<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">f</script></span> are available.</p>
<p>Firstly, we’ll make use of a test function known as the Branin test function. <span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-53" style="width: 26.437em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.673em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.539em, 1021.62em, 3.025em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-54"><span class="mi" id="MathJax-Span-55" style="font-family: STIXGeneral-Italic;">𝑓<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-56" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-57"><span class="mrow" id="MathJax-Span-58"><span class="mi" id="MathJax-Span-59" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-60" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-61" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mi" id="MathJax-Span-62" style="font-family: STIXGeneral-Italic; padding-left: 0.31em;">𝑎</span><span class="mo" id="MathJax-Span-63" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-64"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-65" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-66" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-67" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">−</span><span class="mi" id="MathJax-Span-68" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">𝑏</span><span class="msubsup" id="MathJax-Span-69"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-70" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -4.352em; left: 0.566em;"><span class="mn" id="MathJax-Span-71" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.686em; left: 0.566em;"><span class="mn" id="MathJax-Span-72" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-73" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">+</span><span class="mi" id="MathJax-Span-74" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">𝑐</span><span class="msubsup" id="MathJax-Span-75"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-76" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-77" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-78" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">−</span><span class="mi" id="MathJax-Span-79" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">𝑟</span><span class="msubsup" id="MathJax-Span-80"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.31em, 4.306em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-81" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.361em;"><span class="mn" id="MathJax-Span-82" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-83" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">+</span><span class="mi" id="MathJax-Span-84" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">𝑠</span><span class="mo" id="MathJax-Span-85" style="font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-86" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-87" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">−</span><span class="mi" id="MathJax-Span-88" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">𝑡</span><span class="mi" id="MathJax-Span-89" style="font-family: STIXGeneral-Regular; padding-left: 0.207em;">cos</span><span class="mo" id="MathJax-Span-90"></span><span class="mo" id="MathJax-Span-91" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-92"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-93" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-94" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-95" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-96" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-97" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">+</span><span class="mi" id="MathJax-Span-98" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">𝑠</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mi>a</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><mi>b</mi><msubsup><mi>x</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><mi>c</mi><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><mi>r</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mi>s</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>t</mi><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><mi>s</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-10">
f(\mathbf{ x}) = a(x_2 - bx_1^2 + cx_1 - r)^2 + s(1-t \cos(x_1)) + s
</script></span> where we are setting <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-99" style="width: 2.82em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.308em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1002.21em, 2.718em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-100"><span class="mi" id="MathJax-Span-101" style="font-family: STIXGeneral-Italic;">𝑎</span><span class="mo" id="MathJax-Span-102" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mn" id="MathJax-Span-103" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-11">a=1</script></span>, <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;5.1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-104" style="width: 6.714em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.484em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1005.43em, 2.871em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-105"><span class="mi" id="MathJax-Span-106" style="font-family: STIXGeneral-Italic;">𝑏</span><span class="mo" id="MathJax-Span-107" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mn" id="MathJax-Span-108" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">5.1</span><span class="texatom" id="MathJax-Span-109"><span class="mrow" id="MathJax-Span-110"><span class="mo" id="MathJax-Span-111" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mo" id="MathJax-Span-112" style="font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-113" style="font-family: STIXGeneral-Regular;">4</span><span class="msubsup" id="MathJax-Span-114"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.435em, 1000.57em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-115" style="font-family: STIXGeneral-Italic;">𝜋<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.617em;"><span class="mn" id="MathJax-Span-116" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-117" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mo>=</mo><mn>5.1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mo stretchy="false">(</mo><mn>4</mn><msup><mi>π</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-12">b=5.1/(4\pi^2)</script></span>, <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-118" style="width: 3.794em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.076em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1003.08em, 2.718em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-119"><span class="mi" id="MathJax-Span-120" style="font-family: STIXGeneral-Italic;">𝑐</span><span class="mo" id="MathJax-Span-121" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mn" id="MathJax-Span-122" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">5</span><span class="texatom" id="MathJax-Span-123"><span class="mrow" id="MathJax-Span-124"><span class="mo" id="MathJax-Span-125" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-126" style="font-family: STIXGeneral-Italic;">𝜋<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mo>=</mo><mn>5</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">c=5/\pi</script></span>, <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-127" style="width: 2.718em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1002.15em, 2.718em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-128"><span class="mi" id="MathJax-Span-129" style="font-family: STIXGeneral-Italic;">𝑟</span><span class="mo" id="MathJax-Span-130" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mn" id="MathJax-Span-131" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">6</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mo>=</mo><mn>6</mn></math></span></span><script type="math/tex" id="MathJax-Element-14">r=6</script></span>, <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-132" style="width: 3.384em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.769em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1002.77em, 2.718em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-133"><span class="mi" id="MathJax-Span-134" style="font-family: STIXGeneral-Italic;">𝑠</span><span class="mo" id="MathJax-Span-135" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mn" id="MathJax-Span-136" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">10</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>=</mo><mn>10</mn></math></span></span><script type="math/tex" id="MathJax-Element-15">s=10</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-137" style="width: 5.074em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.152em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1004.1em, 2.871em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-138"><span class="mi" id="MathJax-Span-139" style="font-family: STIXGeneral-Italic;">𝑡</span><span class="mo" id="MathJax-Span-140" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mn" id="MathJax-Span-141" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">1</span><span class="texatom" id="MathJax-Span-142"><span class="mrow" id="MathJax-Span-143"><span class="mo" id="MathJax-Span-144" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mo" id="MathJax-Span-145" style="font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-146" style="font-family: STIXGeneral-Regular;">8</span><span class="mi" id="MathJax-Span-147" style="font-family: STIXGeneral-Italic;">𝜋<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-148" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>=</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mo stretchy="false">(</mo><mn>8</mn><mi>π</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-16">t=1/(8\pi)</script></span>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> branin(X):</span>
<span id="cb1-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb1-2" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> ((X[:,<span class="dv">1</span>]<span class="op">-</span><span class="fl">5.1</span><span class="op">/</span>(<span class="dv">4</span><span class="op">*</span>np.pi<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>X[:,<span class="dv">0</span>]<span class="op">**</span><span class="dv">2</span><span class="op">+</span><span class="dv">5</span><span class="op">*</span>X[:,<span class="dv">0</span>]<span class="op">/</span>np.pi<span class="op">-</span><span class="dv">6</span>)<span class="op">**</span><span class="dv">2</span> </span>
<span id="cb1-3"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb1-3" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> <span class="dv">10</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="dv">1</span><span class="op">/</span>(<span class="dv">8</span><span class="op">*</span>np.pi))<span class="op">*</span>np.cos(X[:,<span class="dv">0</span>])<span class="op">+</span><span class="dv">10</span>)</span>
<span id="cb1-4"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(y)</span></code></pre></div>
<p>We’ll define a grid of twenty-five observations over [−5, 10] × [0, 15] and a set of 25 observations.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Training set defined as a 5*5 grid:</span></span>
<span id="cb2-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb2-2" aria-hidden="true" tabindex="-1"></a>xg1 <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">5</span>)</span>
<span id="cb2-3"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb2-3" aria-hidden="true" tabindex="-1"></a>xg2 <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">5</span>)</span>
<span id="cb2-4"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb2-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.zeros((xg1.size <span class="op">*</span> xg2.size,<span class="dv">2</span>))</span>
<span id="cb2-5"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i,x1 <span class="kw">in</span> <span class="bu">enumerate</span>(xg1):</span>
<span id="cb2-6"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j,x2 <span class="kw">in</span> <span class="bu">enumerate</span>(xg2):</span>
<span id="cb2-7"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb2-7" aria-hidden="true" tabindex="-1"></a>        X[i<span class="op">+</span>xg1.size<span class="op">*</span>j,:] <span class="op">=</span> [x1,x2]</span>
<span id="cb2-8"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb2-9" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> branin(X)[:,np.newaxis]</span></code></pre></div>
<p>The task here will be to consider the distribution of <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-149" style="width: 2.513em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.052em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1002em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-150"><span class="mi" id="MathJax-Span-151" style="font-family: STIXGeneral-Italic;">𝑓<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-152" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-153" style="font-family: STIXGeneral-Italic;">𝑈<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-154" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-17">f(U)</script></span>, where <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-155" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1000.77em, 2.718em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-156"><span class="mi" id="MathJax-Span-157" style="font-family: STIXGeneral-Italic;">𝑈<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>U</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">U</script></span> is a random variable with uniform distribution over the input space of <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-158" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1000.62em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-159"><span class="mi" id="MathJax-Span-160" style="font-family: STIXGeneral-Italic;">𝑓<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">f</script></span>. We focus on the computaiton of two quantities, the expectation of <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-161" style="width: 2.513em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.052em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1002em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-162"><span class="mi" id="MathJax-Span-163" style="font-family: STIXGeneral-Italic;">𝑓<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-164" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-165" style="font-family: STIXGeneral-Italic;">𝑈<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-166" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-20">f(U)</script></span>, <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-167" style="width: 3.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.82em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.693em, 1002.72em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-168"><span class="mrow" id="MathJax-Span-169"><span class="mo" id="MathJax-Span-170" style="font-family: STIXGeneral-Regular;">⟨</span><span class="mi" id="MathJax-Span-171" style="font-family: STIXGeneral-Italic;">𝑓<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-172" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-173" style="font-family: STIXGeneral-Italic;">𝑈<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-174" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-175" style="font-family: STIXGeneral-Regular;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>⟨</mo><mi>f</mi><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo><mo>⟩</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-21">\left\langle f(U)\right\rangle</script></span>, and the probability that the value is greater than 200.</p>
<h2 id="computation-of-leftlangle-furightrangle">Computation of <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-176" style="width: 3.34em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.859em; height: 0px; font-size: 117%;"><span style="position: absolute; clip: rect(1.684em, 1002.78em, 2.779em, -999.999em); top: -2.483em; left: 0em;"><span class="mrow" id="MathJax-Span-177"><span class="mrow" id="MathJax-Span-178"><span class="mo" id="MathJax-Span-179" style="font-family: STIXGeneral-Regular;">⟨</span><span class="mi" id="MathJax-Span-180" style="font-family: STIXGeneral-Italic;">𝑓<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mo" id="MathJax-Span-181" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-182" style="font-family: STIXGeneral-Italic;">𝑈<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.081em;"></span></span><span class="mo" id="MathJax-Span-183" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-184" style="font-family: STIXGeneral-Regular;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 2.485em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.28em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>⟨</mo><mi>f</mi><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo><mo>⟩</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-22">\left\langle f(U)\right\rangle</script></span></h2>
<p>The expectation of <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-185" style="width: 2.513em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.052em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1002em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-186"><span class="mi" id="MathJax-Span-187" style="font-family: STIXGeneral-Italic;">𝑓<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-188" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-189" style="font-family: STIXGeneral-Italic;">𝑈<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-190" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-23">f(U )</script></span> is given by <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-191" style="width: 4.716em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.845em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1003.85em, 3.076em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-192"><span class="msubsup" id="MathJax-Span-193"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.025em, 1000.62em, 4.46em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-194" style="font-family: STIXGeneral-Regular; vertical-align: 0.003em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.635em; left: 0.464em;"><span class="texatom" id="MathJax-Span-195"><span class="mrow" id="MathJax-Span-196"><span class="mi" id="MathJax-Span-197" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-198" style="font-family: STIXGeneral-Italic; padding-left: 0.207em;">𝑓<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-199" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-200"><span class="mrow" id="MathJax-Span-201"><span class="mi" id="MathJax-Span-202" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-203" style="font-family: STIXGeneral-Regular;">)</span><span class="mtext" id="MathJax-Span-204" style="font-family: STIXGeneral-Regular;">d</span><span class="texatom" id="MathJax-Span-205"><span class="mrow" id="MathJax-Span-206"><span class="mi" id="MathJax-Span-207" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></msub><mi>f</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mtext>d</mtext><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-24">\int_\mathbf{ x}f( \mathbf{ x})\text{d}\mathbf{ x}</script></span>. A basic approach to approximate this integral is to compute the mean of the 25 observations: <code>np.mean(Y)</code>. Since the points are distributed on a grid, this can be seen as the approximation of the integral by a rough Riemann sum.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Estimate of the expectation is given by: </span><span class="sc">{mean}</span><span class="st">'</span>.<span class="bu">format</span>(mean<span class="op">=</span>Y.mean()))</span></code></pre></div>
<p>The result can be compared with the actual mean of the Branin function which is 54.31.</p>
<p>Alternatively, we can fit a GP model and compute the integral of the best predictor by Monte Carlo sampling.</p>
<p>Firstly, we create the covariance function. Here we’re going to use an exponentiated quadratic, but we’ll augment it with the ‘bias’ covariance function. This covariance function represents a single fixed bias that is added to the overall covariance. It allows us to deal with non-zero-mean emulations.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an exponentiated quadratic plus bias covariance function</span></span>
<span id="cb4-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb4-2" aria-hidden="true" tabindex="-1"></a>kern_eq <span class="op">=</span> GPy.kern.RBF(input_dim<span class="op">=</span><span class="dv">2</span>, ARD <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb4-3"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb4-3" aria-hidden="true" tabindex="-1"></a>kern_bias <span class="op">=</span> GPy.kern.Bias(input_dim<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb4-4"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb4-4" aria-hidden="true" tabindex="-1"></a>kern <span class="op">=</span> kern_eq <span class="op">+</span> kern_bias</span></code></pre></div>
<p>Now we construct the Gaussian process regression model in GPy.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a GP model</span></span>
<span id="cb5-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb5-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> GPy.models.GPRegression(X,Y,kern)</span></code></pre></div>
<p>In the sinusoid example above, we learnt the variance of the process. But in this example, we are fitting an emulator to a function we know is noise-free. However, we don’t fix the noise value to precisely zero, as this can lead to some numerical errors. Instead, we fix the variance of the Gaussian noise to a very small value.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fix the noise variance</span></span>
<span id="cb6-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb6-2" aria-hidden="true" tabindex="-1"></a>model.likelihood.variance.fix(<span class="fl">1e-5</span>)</span></code></pre></div>
<p>Now we fit the model. Note, that the initial values for the length scale are not appropriate. So first set the length scale of the model needs to be reset.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb7-1" aria-hidden="true" tabindex="-1"></a>kern.rbf.lengthscale <span class="op">=</span> np.asarray([<span class="dv">3</span>, <span class="dv">3</span>])</span></code></pre></div>
<p>It’s a common error in Gaussian process fitting to initialize the length scale too small or too big. The challenge is that the error surface is normally multimodal, and the final solution can be very sensitive to this initialization. If the length scale is initialized too small, the solution can converge on an place where the signal isn’t extracted by the covariance function. If the length scale is initialized too large, then the variations of the function are often missing. Here the length scale is set for each dimension of inputs as 3. Now that’s done, we can optimize the model.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomize the model and optimize</span></span>
<span id="cb8-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb8-2" aria-hidden="true" tabindex="-1"></a>model.optimize(messages<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="figure">
<div id="branin-gp-optimized-fit-figure" class="figure-frame">
<object class="svgplot " data="./Lawrence2021_files/branin-gp-optimized-fit.svg" width="80%" style=" ">
</object>
</div>
<div id="branin-gp-optimized-fit-magnify" class="magnify" onclick="magnifyFigure(&#39;branin-gp-optimized-fit&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="branin-gp-optimized-fit-caption" class="caption-frame">
<p>Figure: A Gaussian process fit to the Branin test function, used to assess the mean of the function by emulation.</p>
</div>
</div>
<p>Finally, we can compute the mean of the model predictions using very many Monte Carlo samples.</p>
<p>Note, that in this example, because we’re using a test function, we could simply have done the Monte Carlo estimation directly on the Branin function. However, imagine instead that we were trying to understand the results of a complex computational fluid dynamics simulation, where each run of the simulation (which is equivalent to our test function) took many hours. In that case the advantage of the emulator is clear.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the mean of model prediction on 1e5 Monte Carlo samples</span></span>
<span id="cb9-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb9-2" aria-hidden="true" tabindex="-1"></a>Xp <span class="op">=</span> np.random.uniform(size<span class="op">=</span>(<span class="bu">int</span>(<span class="fl">1e5</span>),<span class="dv">2</span>))</span>
<span id="cb9-3"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb9-3" aria-hidden="true" tabindex="-1"></a>Xp[:,<span class="dv">0</span>] <span class="op">=</span> Xp[:,<span class="dv">0</span>]<span class="op">*</span><span class="dv">15</span><span class="op">-</span><span class="dv">5</span></span>
<span id="cb9-4"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb9-4" aria-hidden="true" tabindex="-1"></a>Xp[:,<span class="dv">1</span>] <span class="op">=</span> Xp[:,<span class="dv">1</span>]<span class="op">*</span><span class="dv">15</span></span>
<span id="cb9-5"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb9-5" aria-hidden="true" tabindex="-1"></a>mu, var <span class="op">=</span> model.predict(Xp)</span>
<span id="cb9-6"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The estimate of the mean of the Branin function is </span><span class="sc">{mean}</span><span class="st">'</span>.<span class="bu">format</span>(mean<span class="op">=</span>np.mean(mu)))</span></code></pre></div>
<h3 id="exercise-2">Exercise 2</h3>
<p>Now think about how to make use of the variance estimation from the Gaussian process to obtain error bars around your estimate.</p>
<h3 id="exercise-3">Exercise 3</h3>
<p>You’ve seen how the Monte Carlo estimates work with the Gaussian process. Now make your estimate of the probability that the Branin function is greater than 200 with the uniform random inputs.</p>
<h2 id="uncertainty-quantification">Uncertainty Quantification</h2>
<p>We’re introducing you to the optimization and analysis of real-world models through emulation, this domain is part of a broader field known as surrogate modelling.</p>
<p>Although we’re approaching this from the machine learning perspective, with a computer-scientist’s approach, you won’t be surprised to find out that this field is not new and there are a range of research groups interested in this domain.</p>
<p>This type of challenge, of where to run the simulation to get the answer you require is an old challenge. One classic paper, <span class="citation" data-cites="McKay-selecting79">McKay et al. (1979)</span>, reviews three different methods for designing these inputs. They are <em>random sampling</em>, <em>stratified sampling</em> and <em>Latin hypercube sampling</em>.</p>
<blockquote>
<p>Let the input values <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-208" style="width: 4.731em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.905em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.931em, 1003.9em, 2.803em, -999.998em); top: -2.523em; left: 0em;"><span class="mrow" id="MathJax-Span-209"><span class="msubsup" id="MathJax-Span-210"><span style="display: inline-block; position: relative; width: 0.921em; height: 0px;"><span style="position: absolute; clip: rect(3.4em, 1000.51em, 4.135em, -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-211"><span class="mrow" id="MathJax-Span-212"><span class="mi" id="MathJax-Span-213" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.507em;"><span class="mn" id="MathJax-Span-214" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-215" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-216" style="font-family: STIXGeneral-Regular; padding-left: 0.186em;">…</span><span class="mo" id="MathJax-Span-217" style="font-family: STIXGeneral-Regular; padding-left: 0.186em;">,</span><span class="msubsup" id="MathJax-Span-218" style="padding-left: 0.186em;"><span style="display: inline-block; position: relative; width: 0.921em; height: 0px;"><span style="position: absolute; clip: rect(3.4em, 1000.51em, 4.135em, -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-219"><span class="mrow" id="MathJax-Span-220"><span class="mi" id="MathJax-Span-221" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.507em;"><span class="mi" id="MathJax-Span-222" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑛</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.528em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mi>n</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-25">\mathbf{ x}_1, \dots, \mathbf{ x}_n</script></span> be a random sample from <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-223" style="width: 2.16em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.793em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.701em, 1001.75em, 2.849em, -999.998em); top: -2.523em; left: 0em;"><span class="mrow" id="MathJax-Span-224"><span class="mi" id="MathJax-Span-225" style="font-family: STIXGeneral-Italic;">𝑓<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.048em;"></span></span><span class="mo" id="MathJax-Span-226" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-227"><span class="mrow" id="MathJax-Span-228"><span class="mi" id="MathJax-Span-229" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-230" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.528em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-26">f(\mathbf{ x})</script></span>. This method of sampling is perhaps the most obvious, and an entire body of statistical literature may be used in making inferences regarding the distribution of <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-231" style="width: 2.022em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.655em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.701em, 1001.61em, 2.849em, -999.998em); top: -2.523em; left: 0em;"><span class="mrow" id="MathJax-Span-232"><span class="mi" id="MathJax-Span-233" style="font-family: STIXGeneral-Italic;">𝑌<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.14em;"></span></span><span class="mo" id="MathJax-Span-234" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-235" style="font-family: STIXGeneral-Italic;">𝑡</span><span class="mo" id="MathJax-Span-236" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.528em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-27">Y(t)</script></span>.</p>
</blockquote>
<blockquote>
<p>Using stratified sampling, all areas of the sample space of <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-237" style="width: 0.645em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.931em, 1000.51em, 2.665em, -999.998em); top: -2.523em; left: 0em;"><span class="mrow" id="MathJax-Span-238"><span class="texatom" id="MathJax-Span-239"><span class="mrow" id="MathJax-Span-240"><span class="mi" id="MathJax-Span-241" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.528em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-28">\mathbf{ x}</script></span> are represented by input values. Let the sample space <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-242" style="width: 0.829em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.691em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.701em, 1000.69em, 2.665em, -999.998em); top: -2.523em; left: 0em;"><span class="mrow" id="MathJax-Span-243"><span class="mi" id="MathJax-Span-244" style="font-family: STIXGeneral-Italic;">𝑆<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.048em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.528em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">S</script></span> of <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-245" style="width: 0.645em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.931em, 1000.51em, 2.665em, -999.998em); top: -2.523em; left: 0em;"><span class="mrow" id="MathJax-Span-246"><span class="texatom" id="MathJax-Span-247"><span class="mrow" id="MathJax-Span-248"><span class="mi" id="MathJax-Span-249" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.528em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-30">\mathbf{ x}</script></span> be partitioned into <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-250" style="width: 0.691em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.553em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.747em, 1000.55em, 2.665em, -999.998em); top: -2.523em; left: 0em;"><span class="mrow" id="MathJax-Span-251"><span class="mi" id="MathJax-Span-252" style="font-family: STIXGeneral-Italic;">𝐼<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.048em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.528em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-31">I</script></span> disjoint strata <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-253" style="width: 1.196em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.966em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.38em, 1000.97em, 2.482em, -999.998em); top: -2.202em; left: 0em;"><span class="mrow" id="MathJax-Span-254"><span class="msubsup" id="MathJax-Span-255"><span style="display: inline-block; position: relative; width: 0.966em; height: 0px;"><span style="position: absolute; clip: rect(3.17em, 1000.69em, 4.135em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-256" style="font-family: STIXGeneral-Italic;">𝑆<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.048em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.645em;"><span class="mi" id="MathJax-Span-257" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑡</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 1.114em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-32">S_t</script></span>. Let <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-258" style="width: 7.348em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.063em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.701em, 1006.02em, 2.849em, -999.998em); top: -2.523em; left: 0em;"><span class="mrow" id="MathJax-Span-259"><span class="mi" id="MathJax-Span-260" style="font-family: STIXGeneral-Italic;">𝜋<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-261" style="font-family: STIXGeneral-Regular; padding-left: 0.324em;">=</span><span class="mi" id="MathJax-Span-262" style="font-family: STIXGeneral-Italic; padding-left: 0.324em;">𝑃<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.094em;"></span></span><span class="mo" id="MathJax-Span-263" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-264"><span class="mrow" id="MathJax-Span-265"><span class="mi" id="MathJax-Span-266" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-267" style="font-family: STIXGeneral-Regular; padding-left: 0.324em;">∈</span><span class="msubsup" id="MathJax-Span-268" style="padding-left: 0.324em;"><span style="display: inline-block; position: relative; width: 0.966em; height: 0px;"><span style="position: absolute; clip: rect(3.17em, 1000.69em, 4.135em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-269" style="font-family: STIXGeneral-Italic;">𝑆<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.048em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.645em;"><span class="mi" id="MathJax-Span-270" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span><span class="mo" id="MathJax-Span-271" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.528em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo>=</mo><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>∈</mo><msub><mi>S</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-33">\pi = P(\mathbf{ x}\in S_i)</script></span> represent the size of <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-272" style="width: 1.196em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.966em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.38em, 1000.97em, 2.482em, -999.998em); top: -2.202em; left: 0em;"><span class="mrow" id="MathJax-Span-273"><span class="msubsup" id="MathJax-Span-274"><span style="display: inline-block; position: relative; width: 0.966em; height: 0px;"><span style="position: absolute; clip: rect(3.17em, 1000.69em, 4.135em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-275" style="font-family: STIXGeneral-Italic;">𝑆<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.048em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.645em;"><span class="mi" id="MathJax-Span-276" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 1.114em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-34">S_i</script></span>. Obtain a random sample <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-277" style="width: 1.288em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.609em, 1001.06em, 2.619em, -999.998em); top: -2.202em; left: 0em;"><span class="mrow" id="MathJax-Span-278"><span class="msubsup" id="MathJax-Span-279"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.4em, 1000.51em, 4.135em, -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-280"><span class="mrow" id="MathJax-Span-281"><span class="mi" id="MathJax-Span-282" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.507em;"><span class="texatom" id="MathJax-Span-283"><span class="mrow" id="MathJax-Span-284"><span class="mi" id="MathJax-Span-285" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span class="mi" id="MathJax-Span-286" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑗</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-35">\mathbf{ x}_{ij}</script></span>, <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-287" style="width: 5.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.777em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.701em, 1004.73em, 2.849em, -999.998em); top: -2.523em; left: 0em;"><span class="mrow" id="MathJax-Span-288"><span class="mi" id="MathJax-Span-289" style="font-family: STIXGeneral-Italic;">𝑗</span><span class="mo" id="MathJax-Span-290" style="font-family: STIXGeneral-Regular; padding-left: 0.324em;">=</span><span class="mn" id="MathJax-Span-291" style="font-family: STIXGeneral-Regular; padding-left: 0.324em;">1</span><span class="mo" id="MathJax-Span-292" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-293" style="font-family: STIXGeneral-Regular; padding-left: 0.186em;">…</span><span class="mo" id="MathJax-Span-294" style="font-family: STIXGeneral-Regular; padding-left: 0.186em;">,</span><span class="mi" id="MathJax-Span-295" style="font-family: STIXGeneral-Italic; padding-left: 0.186em;">𝑛</span></span><span style="display: inline-block; width: 0px; height: 2.528em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-36">j = 1, \dots, n</script></span> from <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-296" style="width: 1.196em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.966em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.38em, 1000.97em, 2.482em, -999.998em); top: -2.202em; left: 0em;"><span class="mrow" id="MathJax-Span-297"><span class="msubsup" id="MathJax-Span-298"><span style="display: inline-block; position: relative; width: 0.966em; height: 0px;"><span style="position: absolute; clip: rect(3.17em, 1000.69em, 4.135em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-299" style="font-family: STIXGeneral-Italic;">𝑆<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.048em;"></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.645em;"><span class="mi" id="MathJax-Span-300" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 1.114em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-37">S_i</script></span>. Then of course the <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-301" style="width: 0.966em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.783em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.609em, 1000.78em, 2.482em, -999.998em); top: -2.202em; left: 0em;"><span class="mrow" id="MathJax-Span-302"><span class="msubsup" id="MathJax-Span-303"><span style="display: inline-block; position: relative; width: 0.783em; height: 0px;"><span style="position: absolute; clip: rect(3.4em, 1000.46em, 4.135em, -999.998em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-304" style="font-family: STIXGeneral-Italic;">𝑛</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.507em;"><span class="mi" id="MathJax-Span-305" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-38">n_i</script></span> sum to <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-306" style="width: 0.645em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.931em, 1000.46em, 2.665em, -999.998em); top: -2.523em; left: 0em;"><span class="mrow" id="MathJax-Span-307"><span class="mi" id="MathJax-Span-308" style="font-family: STIXGeneral-Italic;">𝑛</span></span><span style="display: inline-block; width: 0px; height: 2.528em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-39">n</script></span>. If <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-309" style="width: 2.849em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.344em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.701em, 1002.25em, 2.665em, -999.998em); top: -2.523em; left: 0em;"><span class="mrow" id="MathJax-Span-310"><span class="mi" id="MathJax-Span-311" style="font-family: STIXGeneral-Italic;">𝐼<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.048em;"></span></span><span class="mo" id="MathJax-Span-312" style="font-family: STIXGeneral-Regular; padding-left: 0.324em;">=</span><span class="mn" id="MathJax-Span-313" style="font-family: STIXGeneral-Regular; padding-left: 0.324em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.528em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-40">I = 1</script></span>, we have random sampling over the entire sample space.</p>
</blockquote>
<blockquote>
<p>The same reasoning that led to stratified sampling, ensuring that all portions of <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-314" style="width: 0.829em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.691em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.701em, 1000.69em, 2.665em, -999.998em); top: -2.523em; left: 0em;"><span class="mrow" id="MathJax-Span-315"><span class="mi" id="MathJax-Span-316" style="font-family: STIXGeneral-Italic;">𝑆<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.048em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.528em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-41">S</script></span> were sampled, could lead further. If we wish to ensure also that each of the input variables <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-317" style="width: 1.196em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.966em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.609em, 1000.97em, 2.482em, -999.998em); top: -2.202em; left: 0em;"><span class="mrow" id="MathJax-Span-318"><span class="msubsup" id="MathJax-Span-319"><span style="display: inline-block; position: relative; width: 0.966em; height: 0px;"><span style="position: absolute; clip: rect(3.4em, 1000.51em, 4.135em, -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-320"><span class="mrow" id="MathJax-Span-321"><span class="mi" id="MathJax-Span-322" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.507em;"><span class="mi" id="MathJax-Span-323" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑘</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-42">\mathbf{ x}_k</script></span> has all portions of its distribution represented by input values, we can divide the range of each <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-324" style="width: 1.196em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.966em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.609em, 1000.97em, 2.482em, -999.998em); top: -2.202em; left: 0em;"><span class="mrow" id="MathJax-Span-325"><span class="msubsup" id="MathJax-Span-326"><span style="display: inline-block; position: relative; width: 0.966em; height: 0px;"><span style="position: absolute; clip: rect(3.4em, 1000.51em, 4.135em, -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-327"><span class="mrow" id="MathJax-Span-328"><span class="mi" id="MathJax-Span-329" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.507em;"><span class="mi" id="MathJax-Span-330" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑘</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-43">\mathbf{ x}_k</script></span> into <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-331" style="width: 0.645em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.931em, 1000.46em, 2.665em, -999.998em); top: -2.523em; left: 0em;"><span class="mrow" id="MathJax-Span-332"><span class="mi" id="MathJax-Span-333" style="font-family: STIXGeneral-Italic;">𝑛</span></span><span style="display: inline-block; width: 0px; height: 2.528em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.669em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-44">n</script></span> strata of equal marginal probability <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-334" style="width: 1.563em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.288em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.701em, 1001.24em, 2.665em, -999.998em); top: -2.523em; left: 0em;"><span class="mrow" id="MathJax-Span-335"><span class="mn" id="MathJax-Span-336" style="font-family: STIXGeneral-Regular;">1</span><span class="texatom" id="MathJax-Span-337"><span class="mrow" id="MathJax-Span-338"><span class="mo" id="MathJax-Span-339" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-340" style="font-family: STIXGeneral-Italic;">𝑛</span></span><span style="display: inline-block; width: 0px; height: 2.528em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.947em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-45">1/n</script></span>, and sample once from each stratum. Let this sample be <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-341" style="width: 1.517em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.609em, 1001.24em, 2.619em, -999.998em); top: -2.202em; left: 0em;"><span class="mrow" id="MathJax-Span-342"><span class="msubsup" id="MathJax-Span-343"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.4em, 1000.51em, 4.135em, -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-344"><span class="mrow" id="MathJax-Span-345"><span class="mi" id="MathJax-Span-346" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.507em;"><span class="texatom" id="MathJax-Span-347"><span class="mrow" id="MathJax-Span-348"><span class="mi" id="MathJax-Span-349" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑘</span><span class="mi" id="MathJax-Span-350" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑗</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-46">\mathbf{ x}_{kj}</script></span>, <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-351" style="width: 5.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.777em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.701em, 1004.73em, 2.849em, -999.998em); top: -2.523em; left: 0em;"><span class="mrow" id="MathJax-Span-352"><span class="mi" id="MathJax-Span-353" style="font-family: STIXGeneral-Italic;">𝑗</span><span class="mo" id="MathJax-Span-354" style="font-family: STIXGeneral-Regular; padding-left: 0.324em;">=</span><span class="mn" id="MathJax-Span-355" style="font-family: STIXGeneral-Regular; padding-left: 0.324em;">1</span><span class="mo" id="MathJax-Span-356" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-357" style="font-family: STIXGeneral-Regular; padding-left: 0.186em;">…</span><span class="mo" id="MathJax-Span-358" style="font-family: STIXGeneral-Regular; padding-left: 0.186em;">,</span><span class="mi" id="MathJax-Span-359" style="font-family: STIXGeneral-Italic; padding-left: 0.186em;">𝑛</span></span><span style="display: inline-block; width: 0px; height: 2.528em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-47">j = 1, \dots, n</script></span>. These form the <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-360" style="width: 1.196em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.966em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.609em, 1000.97em, 2.482em, -999.998em); top: -2.202em; left: 0em;"><span class="mrow" id="MathJax-Span-361"><span class="msubsup" id="MathJax-Span-362"><span style="display: inline-block; position: relative; width: 0.966em; height: 0px;"><span style="position: absolute; clip: rect(3.4em, 1000.51em, 4.135em, -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-363"><span class="mrow" id="MathJax-Span-364"><span class="mi" id="MathJax-Span-365" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.507em;"><span class="mi" id="MathJax-Span-366" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑘</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-48">\mathbf{ x}_k</script></span> component, <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-367" style="width: 6.338em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.236em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.701em, 1005.24em, 2.803em, -999.998em); top: -2.523em; left: 0em;"><span class="mrow" id="MathJax-Span-368"><span class="mi" id="MathJax-Span-369" style="font-family: STIXGeneral-Italic;">𝑘</span><span class="mo" id="MathJax-Span-370" style="font-family: STIXGeneral-Regular; padding-left: 0.324em;">=</span><span class="mn" id="MathJax-Span-371" style="font-family: STIXGeneral-Regular; padding-left: 0.324em;">1</span><span class="mo" id="MathJax-Span-372" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-373" style="font-family: STIXGeneral-Regular; padding-left: 0.186em;">…</span><span class="mo" id="MathJax-Span-374" style="font-family: STIXGeneral-Regular; padding-left: 0.186em;">,</span><span class="mi" id="MathJax-Span-375" style="font-family: STIXGeneral-Italic; padding-left: 0.186em;">𝐾<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.048em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.528em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 1.114em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-49">k = 1, \dots , K</script></span>, in <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-376" style="width: 0.966em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.783em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.609em, 1000.78em, 2.482em, -999.998em); top: -2.202em; left: 0em;"><span class="mrow" id="MathJax-Span-377"><span class="msubsup" id="MathJax-Span-378"><span style="display: inline-block; position: relative; width: 0.783em; height: 0px;"><span style="position: absolute; clip: rect(3.4em, 1000.51em, 4.135em, -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-379"><span class="mrow" id="MathJax-Span-380"><span class="mi" id="MathJax-Span-381" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.507em;"><span class="mi" id="MathJax-Span-382" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-50">\mathbf{ x}_i</script></span>, <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-383" style="width: 5.696em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.685em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.701em, 1004.64em, 2.803em, -999.998em); top: -2.523em; left: 0em;"><span class="mrow" id="MathJax-Span-384"><span class="mi" id="MathJax-Span-385" style="font-family: STIXGeneral-Italic;">𝑖</span><span class="mo" id="MathJax-Span-386" style="font-family: STIXGeneral-Regular; padding-left: 0.324em;">=</span><span class="mn" id="MathJax-Span-387" style="font-family: STIXGeneral-Regular; padding-left: 0.324em;">1</span><span class="mo" id="MathJax-Span-388" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-389" style="font-family: STIXGeneral-Regular; padding-left: 0.186em;">…</span><span class="mo" id="MathJax-Span-390" style="font-family: STIXGeneral-Regular; padding-left: 0.186em;">,</span><span class="mi" id="MathJax-Span-391" style="font-family: STIXGeneral-Italic; padding-left: 0.186em;">𝑛</span></span><span style="display: inline-block; width: 0px; height: 2.528em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 1.114em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-51">i = 1, \dots, n</script></span>. The components of the various <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-392" style="width: 1.196em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.966em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.609em, 1000.97em, 2.482em, -999.998em); top: -2.202em; left: 0em;"><span class="mrow" id="MathJax-Span-393"><span class="msubsup" id="MathJax-Span-394"><span style="display: inline-block; position: relative; width: 0.966em; height: 0px;"><span style="position: absolute; clip: rect(3.4em, 1000.51em, 4.135em, -999.998em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-395"><span class="mrow" id="MathJax-Span-396"><span class="mi" id="MathJax-Span-397" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span><span style="position: absolute; top: -3.854em; left: 0.507em;"><span class="mi" id="MathJax-Span-398" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑘</span><span style="display: inline-block; width: 0px; height: 3.997em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-52">\mathbf{ x}_k</script></span>’s are matched at random. This method of selecting input values is an extension of quota sampling (Steinberg 1963), and can be viewed as a <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-399" style="width: 1.012em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.829em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.747em, 1000.83em, 2.665em, -999.998em); top: -2.523em; left: 0em;"><span class="mrow" id="MathJax-Span-400"><span class="mi" id="MathJax-Span-401" style="font-family: STIXGeneral-Italic;">𝐾<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.048em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.528em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.892em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-53">K</script></span>-dimensional extension of Latin square sampling (Raj 1968).</p>
</blockquote>
<p>The paper’s rather dated reference to “Output from a Computer Code” does carry forward through this literature, which has continued to be a focus of interest for statisticians. <a href="http://www.tonyohagan.co.uk/academic/">Tony O’Hagan</a>, who was a colleague in Sheffield but is also one of the pioneers of Gaussian process models was developing these methods when I first arrived there <span class="citation" data-cites="Kennedy-bayesian01">(Kennedy and O’Hagan, 2001)</span>, and continued with a large EPSRC funded project for managing uncertainty in computational models, <a href="http://www.mucm.ac.uk/" class="uri">http://www.mucm.ac.uk/</a>. You can see a list of <a href="http://www.mucm.ac.uk/Pages/Dissemination/TechnicalReports.html">their technical reports here</a>.</p>
<p>Another important group based in France is the “MASCOT-NUM Research Group,” <a href="https://www.gdr-mascotnum.fr/" class="uri">https://www.gdr-mascotnum.fr/</a>. These researchers bring together statisticians, applied mathematicians and engineers in solving these problems.</p>
<h1 id="emukit">Emukit</h1>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span class="editsection" style=""><a href="https://github.com/lawrennd/talks/edit/gh-pages/_software/includes/emukit-software.md" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Edit Page&#39;, &#39;Edit&#39;, &#39;https://github.com/lawrennd/talks/edit/gh-pages/_software/includes/emukit-software.md&#39;, 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<svg viewBox="0 0 200 200" style="width:15%">
<defs> <clippath id="clip0">
<style>
circle {
  fill: black;
}
</style>
<circle cx="100" cy="100" r="100"></circle> </clippath> </defs>
<title>
Javier Gonzalez
</title>
<image preserveAspectRatio="xMinYMin slice" width="100%" xlink:href="https://inverseprobability.com/talks/./slides/diagrams//people/javier-gonzalez.png" clip-path="url(#clip0)"></image>
</svg>
<p>The Emukit software we will be using across the next part of this module is a python software library that facilitates emulation of systems. The software’s origins go back to work done by <a href="https://javiergonzalezh.github.io/">Javier Gonzalez</a> as part of his post-doctoral project at the University of Sheffield. Javier led the design and build of a Bayesian optimization software. The package <code>GPyOpt</code> worked with the SheffieldML software GPy for performing Bayesian optimization.</p>
<p><code>GPyOpt</code> has a modular design that allows the user to provide their own surrogate models, the package is build with <code>GPy</code> as a surrogate model in mind, but other surrogate models can also be wrapped and integrated.</p>
<p>However, <code>GPyOpt</code> doesn’t allow the full flexibility of surrogate modelling for domains like experimental design, sensitivity analysis etc.</p>
<p>Emukit was designed and built for a more general approach. The software is MIT licensed and its design and implementation was led by Javier Gonzalez and <a href="https://www.linkedin.com/in/andreipaleyes">Andrei Paleyes</a> at Amazon. Building on the experience of <code>GPyOpt</code>, the aim with Emukit was to use the modularisation ideas embedded in <code>GPyOpt</code>, but to extend them beyond the modularisation of the surrogate models to modularisation of the acquisition function.</p>
<div class="figure">
<div id="emukit-software-page-figure" class="figure-frame">
<div class="centered" style="">
<img class="" src="./Lawrence2021_files/emukit-software-page.png" width="80%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</div>
<div id="emukit-software-page-magnify" class="magnify" onclick="magnifyFigure(&#39;emukit-software-page&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="emukit-software-page-caption" class="caption-frame">
<p>Figure: The Emukit software is a set of software tools for emulation and surrogate modeling. <a href="https://emukit.github.io/emukit/" class="uri">https://emukit.github.io/emukit/</a></p>
</div>
</div>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>pip install gpy</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>pip install pyDOE</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>pip install emukit</span></code></pre></div>
<div class="centered" style="">
<svg viewBox="0 0 200 200" style="width:10%">
<defs> <clippath id="clip1">
<style>
circle {
  fill: black;
}
</style>
<circle cx="100" cy="100" r="100"></circle> </clippath> </defs>
<title>
Javier Gonzalez
</title>
<image preserveAspectRatio="xMinYMin slice" width="100%" xlink:href="https://inverseprobability.com/talks/./slides/diagrams//people/javier-gonzalez.png" clip-path="url(#clip1)"></image>
</svg>
<svg viewBox="0 0 200 200" style="width:10%">
<defs> <clippath id="clip2">
<style>
circle {
  fill: black;
}
</style>
<circle cx="100" cy="100" r="100"></circle> </clippath> </defs>
<title>
Andrei Paleyes
</title>
<image preserveAspectRatio="xMinYMin slice" width="100%" xlink:href="https://inverseprobability.com/talks/./slides/diagrams//people/andrei-paleyes.jpg" clip-path="url(#clip2)"></image>
</svg>
<svg viewBox="0 0 200 200" style="width:10%">
<defs> <clippath id="clip3">
<style>
circle {
  fill: black;
}
</style>
<circle cx="100" cy="100" r="100"></circle> </clippath> </defs>
<title>
Mark Pullin
</title>
<image preserveAspectRatio="xMinYMin slice" width="100%" xlink:href="https://inverseprobability.com/talks/./slides/diagrams//people/mark-pullin.jpg" clip-path="url(#clip3)"></image>
</svg>
<svg viewBox="0 0 200 200" style="width:10%">
<defs> <clippath id="clip4">
<style>
circle {
  fill: black;
}
</style>
<circle cx="100" cy="100" r="100"></circle> </clippath> </defs>
<title>
Maren Mahsereci
</title>
<image preserveAspectRatio="xMinYMin slice" width="100%" xlink:href="https://inverseprobability.com/talks/./slides/diagrams//people/maren-mahsereci.png" clip-path="url(#clip4)"></image>
</svg>
</div>
<p>The software was initially built by the team in Amazon. As well as Javier Gonzalez (ML side) and Andrei Paleyes (Software Engineering) included Mark Pullin, Maren Mahsereci, Alex Gessner, Aaron Klein, Henry Moss, David-Elias Künstle as well as management input from Cliff McCollum and myself.</p>
<h2 id="emukit-playground">Emukit Playground</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span class="editsection" style=""><a href="https://github.com/lawrennd/talks/edit/gh-pages/_uq/includes/emukit-playground.md" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Edit Page&#39;, &#39;Edit&#39;, &#39;https://github.com/lawrennd/talks/edit/gh-pages/_uq/includes/emukit-playground.md&#39;, 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<svg viewBox="0 0 200 200" style="width:15%">
<defs> <clippath id="clip5">
<style>
circle {
  fill: black;
}
</style>
<circle cx="100" cy="100" r="100"></circle> </clippath> </defs>
<title>
Adam Hirst
</title>
<image preserveAspectRatio="xMinYMin slice" width="100%" xlink:href="https://inverseprobability.com/talks/./slides/diagrams//people/adam-hirst.jpg" clip-path="url(#clip5)"></image>
</svg>
<svg viewBox="0 0 200 200" style="width:15%">
<defs> <clippath id="clip6">
<style>
circle {
  fill: black;
}
</style>
<circle cx="100" cy="100" r="100"></circle> </clippath> </defs>
<title>
Cliff McCollum
</title>
<image preserveAspectRatio="xMinYMin slice" width="100%" xlink:href="https://inverseprobability.com/talks/./slides/diagrams//people/cliff-mccollum.jpg" clip-path="url(#clip6)"></image>
</svg>
<p>Emukit playground is a software toolkit for exploring the use of statistical emulation as a tool. It was built by <a href="https://twitter.com/_AdamHirst">Adam Hirst</a>, during his software engineering internship at Amazon and supervised by <a href="https://www.linkedin.com/in/cliffmccollum/">Cliff McCollum</a>.</p>
<div class="figure">
<div id="emukit-playground-figure" class="figure-frame">
<div class="centered" style="">
<img class="" src="./Lawrence2021_files/emukit-playground.png" width="80%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</div>
<div id="emukit-playground-magnify" class="magnify" onclick="magnifyFigure(&#39;emukit-playground&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="emukit-playground-caption" class="caption-frame">
<p>Figure: Emukit playground is a tutorial for understanding the simulation/emulation relationship. <a href="https://amzn.github.io/emukit-playground/" class="uri">https://amzn.github.io/emukit-playground/</a></p>
</div>
</div>
<div class="figure">
<div id="emukit-playground-bayes-opt-figure" class="figure-frame">
<div class="centered" style="">
<img class="negate" src="./Lawrence2021_files/emukit-playground-bayes-opt.png" width="80%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</div>
<div id="emukit-playground-bayes-opt-magnify" class="magnify" onclick="magnifyFigure(&#39;emukit-playground-bayes-opt&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="emukit-playground-bayes-opt-caption" class="caption-frame">
<p>Figure: Tutorial on Bayesian optimization of the number of taxis deployed from Emukit playground. <a href="https://amzn.github.io/emukit-playground/#!/learn/bayesian_optimization" class="uri">https://amzn.github.io/emukit-playground/#!/learn/bayesian_optimization</a></p>
</div>
</div>
<p>You can explore Bayesian optimization of a taxi simulation.</p>
<h2 id="emukit-sensitivity-analysis">Emukit Sensitivity Analysis</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span class="editsection" style=""><a href="https://github.com/lawrennd/talks/edit/gh-pages/_uq/includes/emukit-sensitivity-analysis.md" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Edit Page&#39;, &#39;Edit&#39;, &#39;https://github.com/lawrennd/talks/edit/gh-pages/_uq/includes/emukit-sensitivity-analysis.md&#39;, 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>This introduction is based on <a href="https://github.com/EmuKit/emukit/blob/master/notebooks/Emukit-tutorial-sensitivity-montecarlo.ipynb">Introduction to Global Sensitivity Analysis with Emukit</a> written by Mark Pullin, Javier Gonzalez, Juan Emmanuel Johnson and Andrei Paleyes. Some references include <span class="citation" data-cites="Kennedy-predicting00 Sobol-sensitivity90 Sobol-global01 Saltelli-sensitivity04 Saltelli-global08 Saltelli-variance10">(Kennedy and O’Hagan, 2000; Saltelli et al., 2010, 2008, 2004; Sobol, 2001, 1990)</span></p>
<blockquote>
<p>A possible definition of sensitivity analysis is the following: The study of how uncertainty in the output of a model (numerical or otherwise) can be apportioned to different sources of uncertainty in the model input <span class="citation" data-cites="Saltelli-sensitivity04">(Saltelli et al., 2004)</span>. A related practice is ‘uncertainty analysis,’ which focuses rather on quantifying uncertainty in model output. Ideally, uncertainty and sensitivity analyses should be run in tandem, with uncertainty analysis preceding in current practice.</p>
<p>In Chapter 1 of <span class="citation" data-cites="Saltelli-global08">Saltelli et al. (2008)</span></p>
</blockquote>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb13-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb13-3"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> colors <span class="im">as</span> mcolors</span>
<span id="cb13-5"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> cm</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>pip install mlai</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>pip install pyDOE</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> mlai</span>
<span id="cb16-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> mlai.plot <span class="im">as</span> plot</span></code></pre></div>
<p>Sensitivity analysis is a statistical technique widely used to test the reliability of real systems. Imagine a simulator of taxis picking up customers in a city like the one showed in the <a href="https://github.com/amzn/emukit-playground">Emukit playground</a>. The profit of the taxi company depends on factors like the number of taxis on the road and the price per trip. In this example, a global sensitivity analysis of the simulator could be useful to decompose the variance of the profit in a way that can be assigned to the input variables of the simulator.</p>
<p>There are different ways of doing a sensitivity analysis of the variables of a simulator. In this notebook we will start with an approach based on Monte Carlo sampling that is useful when evaluating the simulator is cheap. If evaluating the simulator is expensive, emulators can then be used to speed up computations. We will show this in the last part of the notebook. Next, we start with a few formal definitions and literature review so we can understand the basics of Sensitivity Analysis and how it can be performed with Emukit.</p>
<h2 id="local-sensitivity">Local Sensitivity</h2>
<p>Given any function, <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-402" style="width: 1.744em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1001.39em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-403"><span class="mi" id="MathJax-Span-404" style="font-family: STIXGeneral-Italic;">𝑔</span><span class="mo" id="MathJax-Span-405" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-406" style="font-family: STIXGeneral-Regular;">⋅</span><span class="mo" id="MathJax-Span-407" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mo>⋅</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-54">g(\cdot)</script></span>, we might be interested in how sensitive that function is to variations in its input space. One route to determining this is to compute the partial derivatives of that function with respect to its inputs, <span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-408" style="width: 4.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.537em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.078em, 1003.49em, 3.537em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-409"><span class="mfrac" id="MathJax-Span-410"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.254em;"><span class="mi" id="MathJax-Span-411" style="font-family: STIXGeneral-Regular;">∂</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1001.34em, 4.306em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.663em;"><span class="mrow" id="MathJax-Span-412"><span class="mi" id="MathJax-Span-413" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-414"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-415" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-416" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1001.44em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.437em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mi" id="MathJax-Span-417" style="font-family: STIXGeneral-Italic;">𝑔</span><span class="mo" id="MathJax-Span-418" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-419"><span class="mrow" id="MathJax-Span-420"><span class="mi" id="MathJax-Span-421" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-422" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-423" style="font-family: STIXGeneral-Regular;">.</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.059em; border-left: 0px solid; width: 0px; height: 2.816em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mi>g</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-55">
\frac{\partial}{\partial x_i} g(\mathbf{ x}).
</script></span> The matrix of all these partial derivatives is known as the Jacobian.</p>
<p>These types of local sensitivity analysis can be used for determining the effect of changing an input variable around an operating point. But they don’t give us an understanding of the response of the target function to variations in the input across the domain of inputs. For this, we need to look to <em>global sensitivity analysis</em>.</p>
<h2 id="global-sensitivity-analysis">Global Sensitivity Analysis</h2>
<p>In global sensitivity analysis, rather than looking around a single operating point, we’re interested in the overall sensitivity of a function to its inputs, or combinations of inputs, across its entire domain. The key tool in determining this sensitivity is known as the ANOVA decomposition, or the <em>Hoeffding-Sobol decomposition</em>.</p>
<p>For global sensitivity analysis, we need to make an assumption about how inputs are going to vary to create different values of the function. The fundamental object we’re interested in is the total variance of the function, <span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;var&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-424" style="width: 18.035em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.757em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.488em, 1014.71em, 3.23em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-425"><span class="mtext" id="MathJax-Span-426" style="font-family: STIXGeneral-Regular;">var</span><span class="mrow" id="MathJax-Span-427" style="padding-left: 0.207em;"><span class="mo" id="MathJax-Span-428" style="vertical-align: 0em;"><span style="font-family: STIXGeneral-Regular;">(</span></span><span class="mi" id="MathJax-Span-429" style="font-family: STIXGeneral-Italic;">𝑔</span><span class="mo" id="MathJax-Span-430" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-431"><span class="mrow" id="MathJax-Span-432"><span class="mi" id="MathJax-Span-433" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-434" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-435" style="vertical-align: 0em;"><span style="font-family: STIXGeneral-Regular;">)</span></span></span><span class="mo" id="MathJax-Span-436" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="msubsup" id="MathJax-Span-437" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 4.511em; height: 0px;"><span style="position: absolute; clip: rect(2.974em, 1003.13em, 4.511em, -999.997em); top: -3.993em; left: 0em;"><span class="mrow" id="MathJax-Span-438"><span class="mo" id="MathJax-Span-439" style="vertical-align: -0.202em;"><span style="font-family: STIXSizeOneSym;">⟨</span></span><span class="mi" id="MathJax-Span-440" style="font-family: STIXGeneral-Italic;">𝑔</span><span class="mo" id="MathJax-Span-441" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-442"><span class="mrow" id="MathJax-Span-443"><span class="mi" id="MathJax-Span-444" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="msubsup" id="MathJax-Span-445"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.31em, 4.306em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-446" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.361em;"><span class="mn" id="MathJax-Span-447" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-448" style="vertical-align: -0.202em;"><span style="font-family: STIXSizeOneSym;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.584em; left: 3.23em;"><span class="texatom" id="MathJax-Span-449"><span class="mrow" id="MathJax-Span-450"><span class="mi" id="MathJax-Span-451" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-452" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-453"><span class="mrow" id="MathJax-Span-454"><span class="mi" id="MathJax-Span-455" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-456" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-457" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">−</span><span class="msubsup" id="MathJax-Span-458" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 3.691em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1002.36em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mrow" id="MathJax-Span-459"><span class="mo" id="MathJax-Span-460" style="font-family: STIXGeneral-Regular;">⟨</span><span class="mi" id="MathJax-Span-461" style="font-family: STIXGeneral-Italic;">𝑔</span><span class="mo" id="MathJax-Span-462" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-463"><span class="mrow" id="MathJax-Span-464"><span class="mi" id="MathJax-Span-465" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-466" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-467" style="font-family: STIXGeneral-Regular;">⟩</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -4.454em; left: 2.462em;"><span class="mn" id="MathJax-Span-468" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.23em, 4.306em, -999.997em); top: -3.737em; left: 2.462em;"><span class="texatom" id="MathJax-Span-469"><span class="mrow" id="MathJax-Span-470"><span class="mi" id="MathJax-Span-471" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-472" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-473"><span class="mrow" id="MathJax-Span-474"><span class="mi" id="MathJax-Span-475" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-476" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-477" style="font-family: STIXGeneral-Regular;">,</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.684em; border-left: 0px solid; width: 0px; height: 1.878em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>var</mtext><mrow><mo>(</mo><mi>g</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>)</mo></mrow><mo>=</mo><msub><mrow><mo>⟨</mo><mi>g</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>⟩</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></mrow></msub><mo>−</mo><msubsup><mrow><mo>⟨</mo><mi>g</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>⟩</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msubsup><mo>,</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-56">
\text{var}\left(g(\mathbf{ x})\right) = \left\langle g(\mathbf{ x})^2 \right\rangle _{p(\mathbf{ x})} - \left\langle g(\mathbf{ x}) \right\rangle _{p(\mathbf{ x})}^2,
</script></span> where <span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-478" style="width: 12.964em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.607em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.027em, 1010.61em, 3.64em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-479"><span class="msubsup" id="MathJax-Span-480"><span style="display: inline-block; position: relative; width: 3.742em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1002.41em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mrow" id="MathJax-Span-481"><span class="mo" id="MathJax-Span-482" style="font-family: STIXGeneral-Regular;">⟨</span><span class="mi" id="MathJax-Span-483" style="font-family: STIXGeneral-Italic;">ℎ</span><span class="mo" id="MathJax-Span-484" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-485"><span class="mrow" id="MathJax-Span-486"><span class="mi" id="MathJax-Span-487" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-488" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-489" style="font-family: STIXGeneral-Regular;">⟩</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.737em; left: 2.462em;"><span class="texatom" id="MathJax-Span-490"><span class="mrow" id="MathJax-Span-491"><span class="mi" id="MathJax-Span-492" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-493" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-494"><span class="mrow" id="MathJax-Span-495"><span class="mi" id="MathJax-Span-496" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-497" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-498" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="msubsup" id="MathJax-Span-499" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(2.462em, 1001.03em, 5.023em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-500" style="font-family: STIXIntegralsD; vertical-align: -0.612em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.464em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.071em; left: 0.566em;"><span class="texatom" id="MathJax-Span-501"><span class="mrow" id="MathJax-Span-502"><span class="mi" id="MathJax-Span-503" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-504" style="font-family: STIXGeneral-Italic; padding-left: 0.207em;">ℎ</span><span class="mo" id="MathJax-Span-505" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-506"><span class="mrow" id="MathJax-Span-507"><span class="mi" id="MathJax-Span-508" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-509" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-510" style="font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-511" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-512"><span class="mrow" id="MathJax-Span-513"><span class="mi" id="MathJax-Span-514" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-515" style="font-family: STIXGeneral-Regular;">)</span><span class="mtext" id="MathJax-Span-516" style="font-family: STIXGeneral-Regular;">d</span><span class="texatom" id="MathJax-Span-517"><span class="mrow" id="MathJax-Span-518"><span class="mi" id="MathJax-Span-519" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.184em; border-left: 0px solid; width: 0px; height: 2.941em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mrow><mo>⟨</mo><mi>h</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>⟩</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></mrow></msub><mo>=</mo><msub><mo>∫</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></msub><mi>h</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mtext>d</mtext><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-57">
\left\langle h(\mathbf{ x}) \right\rangle _{p(\mathbf{ x})} = \int_\mathbf{ x}h(\mathbf{ x}) p(\mathbf{ x}) \text{d}\mathbf{ x}
</script></span> is the expectation of the function <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-520" style="width: 2.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.693em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1001.64em, 2.871em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-521"><span class="mi" id="MathJax-Span-522" style="font-family: STIXGeneral-Italic;">ℎ</span><span class="mo" id="MathJax-Span-523" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-524"><span class="mrow" id="MathJax-Span-525"><span class="mi" id="MathJax-Span-526" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-527" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-58">h(\mathbf{ x})</script></span> under the density <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-528" style="width: 2.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.642em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1001.59em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-529"><span class="mi" id="MathJax-Span-530" style="font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-531" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-532"><span class="mrow" id="MathJax-Span-533"><span class="mi" id="MathJax-Span-534" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-535" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-59">p(\mathbf{ x})</script></span>, which represents the probability distribution of inputs we’re interested in.</p>
<p>The total variance of the function gives us the overall variation of the function across the domain of inputs, as represented by the probability density, <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-536" style="width: 2.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.642em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1001.59em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-537"><span class="mi" id="MathJax-Span-538" style="font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-539" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-540"><span class="mrow" id="MathJax-Span-541"><span class="mi" id="MathJax-Span-542" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-543" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-60">p(\mathbf{ x})</script></span>. Normally, we perform analysis by assuming that, <span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-544" style="width: 7.943em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.509em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.771em, 1006.46em, 3.998em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-545"><span class="mi" id="MathJax-Span-546" style="font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-547" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-548"><span class="mrow" id="MathJax-Span-549"><span class="mi" id="MathJax-Span-550" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-551" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-552" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="munderover" id="MathJax-Span-553" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 1.335em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.28em, 4.613em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-554" style="font-family: STIXSizeOneSym; vertical-align: -0.51em;">∏</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.98em, 4.255em, -999.997em); top: -2.866em; left: 0.156em;"><span class="texatom" id="MathJax-Span-555"><span class="mrow" id="MathJax-Span-556"><span class="mi" id="MathJax-Span-557" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span class="mo" id="MathJax-Span-558" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-559" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1000.36em, 4.306em, -999.997em); top: -5.223em; left: 0.515em;"><span class="mi" id="MathJax-Span-560" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-561" style="font-family: STIXGeneral-Italic; padding-left: 0.207em;">𝑝</span><span class="mo" id="MathJax-Span-562" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-563"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-564" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-565" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-566" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.691em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>p</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><mi>p</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-61">
p(\mathbf{ x}) = \prod_{i=1}^pp(x_i)
</script></span> and that each <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-567" style="width: 2.462em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.001em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1001.95em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-568"><span class="mi" id="MathJax-Span-569" style="font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-570" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-571"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-572" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-573" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-574" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-62">p(x_i)</script></span> is <em>uniformly distributed</em> across its input domain. Assuming we scale the input domain down to the interval <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-575" style="width: 2.564em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.103em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1002em, 2.871em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-576"><span class="mo" id="MathJax-Span-577" style="font-family: STIXGeneral-Regular;">[</span><span class="mn" id="MathJax-Span-578" style="font-family: STIXGeneral-Regular;">0</span><span class="mo" id="MathJax-Span-579" style="font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-580" style="font-family: STIXGeneral-Regular; padding-left: 0.207em;">1</span><span class="mo" id="MathJax-Span-581" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-63">[0, 1]</script></span>, that gives us <span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;U&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-582" style="width: 7.226em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.894em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.205em, 1005.84em, 3.332em, -999.997em); top: -3.02em; left: 0em;"><span class="mrow" id="MathJax-Span-583"><span class="msubsup" id="MathJax-Span-584"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-585" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-586" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-587" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">∼</span><span class="texatom" id="MathJax-Span-588" style="padding-left: 0.31em;"><span class="mrow" id="MathJax-Span-589"><span class="mi" id="MathJax-Span-590" style="font-family: STIXNonUnicode-Italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.156em;"></span></span></span></span><span class="mrow" id="MathJax-Span-591" style="padding-left: 0.207em;"><span class="mo" id="MathJax-Span-592" style="font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-593" style="font-family: STIXGeneral-Regular;">0</span><span class="mo" id="MathJax-Span-594" style="font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-595" style="font-family: STIXGeneral-Regular; padding-left: 0.207em;">1</span><span class="mo" id="MathJax-Span-596" style="font-family: STIXGeneral-Regular;">)</span></span><span class="mo" id="MathJax-Span-597" style="font-family: STIXGeneral-Regular; padding-left: 0.207em;">.</span></span><span style="display: inline-block; width: 0px; height: 3.025em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>x</mi><mi>i</mi></msub><mo>∼</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">U</mi></mrow><mrow><mo>(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>)</mo></mrow><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-64">
x_i \sim \mathcal{U}\left(0,1\right).
</script></span></p>
<h2 id="hoeffding-sobol-decomposition">Hoeffding-Sobol Decomposition</h2>
<p>The Hoeffding-Sobol, or ANOVA, decomposition of a function allows us to write it as, <span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-598" style="width: 21.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.626em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(-0.407em, 1017.52em, 4.306em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-599"><span class="mtable" id="MathJax-Span-600"><span style="display: inline-block; position: relative; width: 17.318em; height: 0px; margin-right: 0.156em; margin-left: 0.156em;"><span style="position: absolute; clip: rect(2.564em, 1002.62em, 6.048em, -999.997em); top: -4.198em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.666em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1002.62em, 4.357em, -999.997em); top: -4.813em; right: 0em;"><span class="mtd" id="MathJax-Span-601"><span class="mrow" id="MathJax-Span-602"><span class="mi" id="MathJax-Span-603" style="font-family: STIXGeneral-Italic;">𝑔</span><span class="mo" id="MathJax-Span-604" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-605"><span class="mrow" id="MathJax-Span-606"><span class="mi" id="MathJax-Span-607" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-608" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-609" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -2.303em; right: 0em;"><span class="mtd" id="MathJax-Span-660"><span class="mrow" id="MathJax-Span-661"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.203em;"></span></span><span style="position: absolute; clip: rect(2.82em, 1014.55em, 7.533em, -999.997em); top: -5.428em; left: 2.666em;"><span style="display: inline-block; position: relative; width: 14.705em; height: 0px;"><span style="position: absolute; clip: rect(2.257em, 1014.55em, 5.587em, -999.997em); top: -4.864em; left: 0em;"><span class="mtd" id="MathJax-Span-610"><span class="mrow" id="MathJax-Span-611"><span class="msubsup" id="MathJax-Span-612"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-613" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mn" id="MathJax-Span-614" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-615" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">+</span><span class="munderover" id="MathJax-Span-616" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 1.283em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.18em, 4.613em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-617" style="font-family: STIXSizeOneSym; vertical-align: -0.51em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.98em, 4.255em, -999.997em); top: -2.866em; left: 0.105em;"><span class="texatom" id="MathJax-Span-618"><span class="mrow" id="MathJax-Span-619"><span class="mi" id="MathJax-Span-620" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span class="mo" id="MathJax-Span-621" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-622" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1000.36em, 4.306em, -999.997em); top: -5.223em; left: 0.464em;"><span class="mi" id="MathJax-Span-623" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-624" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-625" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-626" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-627" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-628"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-629" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-630" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-631" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-632" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">+</span><span class="munderover" id="MathJax-Span-633" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 1.283em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.18em, 4.613em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-634" style="font-family: STIXSizeOneSym; vertical-align: -0.51em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.98em, 4.408em, -999.997em); top: -2.866em; left: 0.156em;"><span class="texatom" id="MathJax-Span-635"><span class="mrow" id="MathJax-Span-636"><span class="mi" id="MathJax-Span-637" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span class="mo" id="MathJax-Span-638" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">&lt;</span><span class="mi" id="MathJax-Span-639" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑗</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1000.36em, 4.306em, -999.997em); top: -5.223em; left: 0.464em;"><span class="texatom" id="MathJax-Span-640"><span class="mrow" id="MathJax-Span-641"><span class="mi" id="MathJax-Span-642" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-643" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-644" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="texatom" id="MathJax-Span-645"><span class="mrow" id="MathJax-Span-646"><span class="mi" id="MathJax-Span-647" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span class="mi" id="MathJax-Span-648" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑗</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-649" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-650"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-651" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-652" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-653" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-654" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-655" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-656" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑗</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-657" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-658" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">+</span><span class="mo" id="MathJax-Span-659" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">⋯</span></span></span><span style="display: inline-block; width: 0px; height: 4.05em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1010.45em, 4.408em, -999.997em); top: -2.303em; left: 0em;"><span class="mtd" id="MathJax-Span-662"><span class="mrow" id="MathJax-Span-663"><span class="mi" id="MathJax-Span-664"></span><span class="mo" id="MathJax-Span-665" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">+</span><span class="msubsup" id="MathJax-Span-666" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 2.871em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-667" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="texatom" id="MathJax-Span-668"><span class="mrow" id="MathJax-Span-669"><span class="mn" id="MathJax-Span-670" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-671" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-672" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span class="mo" id="MathJax-Span-673" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-674" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">…</span><span class="mo" id="MathJax-Span-675" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-676" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-677" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-678"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-679" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-680" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-681" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-682" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-683" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-684" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-685" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-686" style="font-family: STIXGeneral-Regular; padding-left: 0.207em;">…</span><span class="mo" id="MathJax-Span-687" style="font-family: STIXGeneral-Regular; padding-left: 0.207em;">,</span><span class="msubsup" id="MathJax-Span-688" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-689" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-690" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-691" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-692" style="font-family: STIXGeneral-Regular;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.433em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.434em; border-left: 0px solid; width: 0px; height: 5.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>g</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>=</mo></mtd><mtd><msub><mi>g</mi><mn>0</mn></msub><mo>+</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><msub><mi>g</mi><mi>i</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>+</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>&lt;</mo><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>p</mi></mrow></munderover><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mo>⋯</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>+</mo><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>p</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>x</mi><mi>p</mi></msub><mo stretchy="false">)</mo><mo>,</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-65">
\begin{align*}
g(\mathbf{ x}) = & g_0 + \sum_{i=1}^pg_i(x_i) + \sum_{i<j}^{p} g_{ij}(x_i,x_j) + \cdots \\
& + g_{1,2,\dots,p}(x_1,x_2,\dots,x_p),
\end{align*}
</script></span> where <span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-693" style="width: 7.277em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.945em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.693em, 1005.95em, 3.076em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-694"><span class="msubsup" id="MathJax-Span-695"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-696" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mn" id="MathJax-Span-697" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-698" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="msubsup" id="MathJax-Span-699" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 3.691em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1002.36em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mrow" id="MathJax-Span-700"><span class="mo" id="MathJax-Span-701" style="font-family: STIXGeneral-Regular;">⟨</span><span class="mi" id="MathJax-Span-702" style="font-family: STIXGeneral-Italic;">𝑔</span><span class="mo" id="MathJax-Span-703" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-704"><span class="mrow" id="MathJax-Span-705"><span class="mi" id="MathJax-Span-706" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-707" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-708" style="font-family: STIXGeneral-Regular;">⟩</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.737em; left: 2.462em;"><span class="texatom" id="MathJax-Span-709"><span class="mrow" id="MathJax-Span-710"><span class="mi" id="MathJax-Span-711" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-712" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-713"><span class="mrow" id="MathJax-Span-714"><span class="mi" id="MathJax-Span-715" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-716" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>g</mi><mn>0</mn></msub><mo>=</mo><msub><mrow><mo>⟨</mo><mi>g</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>⟩</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></mrow></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-66">
g_0 = \left\langle g(\mathbf{ x}) \right\rangle _{p(\mathbf{ x})}
</script></span> and <span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-717" style="width: 12.451em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.197em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.693em, 1010.15em, 3.076em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-718"><span class="msubsup" id="MathJax-Span-719"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-720" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-721" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-722" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-723"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-724" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-725" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-726" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-727" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="msubsup" id="MathJax-Span-728" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 4.255em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1002.36em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mrow" id="MathJax-Span-729"><span class="mo" id="MathJax-Span-730" style="font-family: STIXGeneral-Regular;">⟨</span><span class="mi" id="MathJax-Span-731" style="font-family: STIXGeneral-Italic;">𝑔</span><span class="mo" id="MathJax-Span-732" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-733"><span class="mrow" id="MathJax-Span-734"><span class="mi" id="MathJax-Span-735" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-736" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-737" style="font-family: STIXGeneral-Regular;">⟩</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.737em; left: 2.462em;"><span class="texatom" id="MathJax-Span-738"><span class="mrow" id="MathJax-Span-739"><span class="mi" id="MathJax-Span-740" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-741" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-742"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.36em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-743"><span class="mrow" id="MathJax-Span-744"><span class="mi" id="MathJax-Span-745" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.361em;"><span class="texatom" id="MathJax-Span-746"><span class="mrow" id="MathJax-Span-747"><span class="mo" id="MathJax-Span-748" style="font-size: 50%; font-family: STIXGeneral-Regular;">∼</span><span class="mi" id="MathJax-Span-749" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑖</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-750" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-751" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">−</span><span class="msubsup" id="MathJax-Span-752" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-753" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mn" id="MathJax-Span-754" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-755" style="font-family: STIXGeneral-Regular;">,</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>g</mi><mi>i</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mrow><mo>⟨</mo><mi>g</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>⟩</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo>∼</mo><mi>i</mi></mrow></msub><mo stretchy="false">)</mo></mrow></msub><mo>−</mo><msub><mi>g</mi><mn>0</mn></msub><mo>,</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-67">
g_i(x_i) = \left\langle g(\mathbf{ x}) \right\rangle _{p(\mathbf{ x}_{\sim i})} - g_0,
</script></span> where we’re using the notation <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-756" style="width: 3.025em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.462em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1002.41em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-757"><span class="mi" id="MathJax-Span-758" style="font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-759" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-760"><span style="display: inline-block; position: relative; width: 1.283em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-761"><span class="mrow" id="MathJax-Span-762"><span class="mi" id="MathJax-Span-763" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="texatom" id="MathJax-Span-764"><span class="mrow" id="MathJax-Span-765"><span class="mo" id="MathJax-Span-766" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∼</span><span class="mi" id="MathJax-Span-767" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-768" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo>∼</mo><mi>i</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-68">p(\mathbf{ x}_{\sim i})</script></span> to represent the input distribution with the <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-769" style="width: 0.412em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.31em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.796em, 1000.26em, 2.718em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-770"><span class="mi" id="MathJax-Span-771" style="font-family: STIXGeneral-Italic;">𝑖</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-69">i</script></span>th variable marginalised, <span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-772" style="width: 9.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.994em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.154em, 1007.99em, 4.716em, -999.997em); top: -3.686em; left: 0em;"><span class="mrow" id="MathJax-Span-773"><span class="mi" id="MathJax-Span-774" style="font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-775" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-776"><span style="display: inline-block; position: relative; width: 1.283em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-777"><span class="mrow" id="MathJax-Span-778"><span class="mi" id="MathJax-Span-779" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="texatom" id="MathJax-Span-780"><span class="mrow" id="MathJax-Span-781"><span class="mo" id="MathJax-Span-782" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∼</span><span class="mi" id="MathJax-Span-783" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-784" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-785" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mo" id="MathJax-Span-786" style="font-family: STIXIntegralsD; vertical-align: -0.612em; padding-left: 0.31em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.464em;"></span></span><span class="mi" id="MathJax-Span-787" style="font-family: STIXGeneral-Italic; padding-left: 0.207em;">𝑝</span><span class="mo" id="MathJax-Span-788" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-789"><span class="mrow" id="MathJax-Span-790"><span class="mi" id="MathJax-Span-791" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-792" style="font-family: STIXGeneral-Regular;">)</span><span class="mtext" id="MathJax-Span-793" style="font-family: STIXGeneral-Regular;">d</span><span class="msubsup" id="MathJax-Span-794"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-795" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-796" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.691em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.878em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>p</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo>∼</mo><mi>i</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mo>∫</mo><mi>p</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mtext>d</mtext><msub><mi>x</mi><mi>i</mi></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-70">
p(\mathbf{ x}_{\sim i}) = \int p(\mathbf{ x}) \text{d}x_i
</script></span> Higher order terms in the decomposition represent interactions between inputs, <span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-797" style="width: 23.414em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.162em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.693em, 1019.16em, 3.179em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-798"><span class="msubsup" id="MathJax-Span-799"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-800" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="texatom" id="MathJax-Span-801"><span class="mrow" id="MathJax-Span-802"><span class="mi" id="MathJax-Span-803" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span class="mo" id="MathJax-Span-804" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-805" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑗</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-806" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-807"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-808" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-809" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-810" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-811" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-812" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-813" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑗</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-814" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-815" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="msubsup" id="MathJax-Span-816" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 4.562em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1002.36em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mrow" id="MathJax-Span-817"><span class="mo" id="MathJax-Span-818" style="font-family: STIXGeneral-Regular;">⟨</span><span class="mi" id="MathJax-Span-819" style="font-family: STIXGeneral-Italic;">𝑔</span><span class="mo" id="MathJax-Span-820" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-821"><span class="mrow" id="MathJax-Span-822"><span class="mi" id="MathJax-Span-823" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-824" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-825" style="font-family: STIXGeneral-Regular;">⟩</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.737em; left: 2.462em;"><span class="texatom" id="MathJax-Span-826"><span class="mrow" id="MathJax-Span-827"><span class="mi" id="MathJax-Span-828" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-829" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-830"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.36em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-831"><span class="mrow" id="MathJax-Span-832"><span class="mi" id="MathJax-Span-833" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.361em;"><span class="texatom" id="MathJax-Span-834"><span class="mrow" id="MathJax-Span-835"><span class="mo" id="MathJax-Span-836" style="font-size: 50%; font-family: STIXGeneral-Regular;">∼</span><span class="mi" id="MathJax-Span-837" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑖</span><span class="mo" id="MathJax-Span-838" style="font-size: 50%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-839" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑗</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-840" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-841" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">−</span><span class="msubsup" id="MathJax-Span-842" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-843" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-844" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-845" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-846"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-847" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-848" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-849" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-850" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">−</span><span class="msubsup" id="MathJax-Span-851" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-852" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-853" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑗</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-854" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-855"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-856" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-857" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑗</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-858" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-859" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">−</span><span class="msubsup" id="MathJax-Span-860" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-861" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mn" id="MathJax-Span-862" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.622em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mrow><mo>⟨</mo><mi>g</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>⟩</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo>∼</mo><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow></msub><mo>−</mo><msub><mi>g</mi><mi>i</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><msub><mi>g</mi><mi>j</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>−</mo><msub><mi>g</mi><mn>0</mn></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-71">
g_{i,j}(x_i, x_j) = \left\langle g(\mathbf{ x}) \right\rangle _{p(\mathbf{ x}_{\sim i,j})} - g_i(x_i) - g_j(x_j) - g_0
</script></span> and similar expressions can be written for higher order terms up to <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-863" style="width: 4.972em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.05em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1004em, 2.974em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-864"><span class="msubsup" id="MathJax-Span-865"><span style="display: inline-block; position: relative; width: 2.871em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-866" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="texatom" id="MathJax-Span-867"><span class="mrow" id="MathJax-Span-868"><span class="mn" id="MathJax-Span-869" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-870" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-871" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span class="mo" id="MathJax-Span-872" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-873" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">…</span><span class="mo" id="MathJax-Span-874" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-875" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-876" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-877"><span class="mrow" id="MathJax-Span-878"><span class="mi" id="MathJax-Span-879" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-880" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>p</mi></mrow></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-72">g_{1,2,\dots,p}(\mathbf{ x})</script></span>.</p>
<p>Note that to compute each of these individual terms, you need to first compute the low order terms, and then compute the high order terms. This can be problematic when <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-881" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.949em, 1000.51em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-882"><span class="mi" id="MathJax-Span-883" style="font-family: STIXGeneral-Italic;">𝑝</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-73">p</script></span> is large.</p>
<p>We’re interested in the variance of the function <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-884" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.949em, 1000.51em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-885"><span class="mi" id="MathJax-Span-886" style="font-family: STIXGeneral-Italic;">𝑔</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-74">g</script></span>, so implicitly we’re assuming that the square of this function is integrable across its domain, i.e., we’re assuming that <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-887" style="width: 5.535em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.511em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1004.51em, 2.871em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-888"><span class="msubsup" id="MathJax-Span-889"><span style="display: inline-block; position: relative; width: 4.511em; height: 0px;"><span style="position: absolute; clip: rect(2.974em, 1003.13em, 4.511em, -999.997em); top: -3.993em; left: 0em;"><span class="mrow" id="MathJax-Span-890"><span class="mo" id="MathJax-Span-891" style="vertical-align: -0.202em;"><span style="font-family: STIXSizeOneSym;">⟨</span></span><span class="mi" id="MathJax-Span-892" style="font-family: STIXGeneral-Italic;">𝑔</span><span class="mo" id="MathJax-Span-893" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-894"><span class="mrow" id="MathJax-Span-895"><span class="mi" id="MathJax-Span-896" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="msubsup" id="MathJax-Span-897"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.31em, 4.306em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-898" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.361em;"><span class="mn" id="MathJax-Span-899" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-900" style="vertical-align: -0.202em;"><span style="font-family: STIXSizeOneSym;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.584em; left: 3.23em;"><span class="texatom" id="MathJax-Span-901"><span class="mrow" id="MathJax-Span-902"><span class="mi" id="MathJax-Span-903" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-904" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-905"><span class="mrow" id="MathJax-Span-906"><span class="mi" id="MathJax-Span-907" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-908" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.684em; border-left: 0px solid; width: 0px; height: 1.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow><mo>⟨</mo><mi>g</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>⟩</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-75">\left\langle g(\mathbf{ x})^2 \right\rangle _{p(\mathbf{ x})}</script></span> exists and is finite.</p>
<p>The Sobol decomposition has some important properties, in particular, its components are orthogonal, so this means that when we substitute it in to the variance, we have, <span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtext&gt;var&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/munderover&gt;&lt;mtext&gt;var&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mtext&gt;var&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mtext&gt;var&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-909" style="width: 25.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.058em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(-2.252em, 1020.96em, 6.201em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-910"><span class="mtable" id="MathJax-Span-911"><span style="display: inline-block; position: relative; width: 20.751em; height: 0px; margin-right: 0.156em; margin-left: 0.156em;"><span style="position: absolute; clip: rect(4.255em, 1003.38em, 12.093em, -999.997em); top: -8.502em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.435em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1003.38em, 4.357em, -999.997em); top: -7.374em; right: 0em;"><span class="mtd" id="MathJax-Span-912"><span class="mrow" id="MathJax-Span-913"><span class="mtext" id="MathJax-Span-914" style="font-family: STIXGeneral-Regular;">var</span><span class="mo" id="MathJax-Span-915" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-916" style="font-family: STIXGeneral-Italic;">𝑔</span><span class="mo" id="MathJax-Span-917" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-918" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1000.62em, 4.152em, -999.997em); top: -5.633em; right: 0em;"><span class="mtd" id="MathJax-Span-961"><span class="mrow" id="MathJax-Span-962"><span class="mo" id="MathJax-Span-963" style="font-family: STIXGeneral-Regular;">=</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1000.62em, 4.152em, -999.997em); top: -3.122em; right: 0em;"><span class="mtd" id="MathJax-Span-991"><span class="mrow" id="MathJax-Span-992"><span class="mo" id="MathJax-Span-993" style="font-family: STIXGeneral-Regular;">=</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -0.561em; right: 0em;"><span class="mtd" id="MathJax-Span-1049"><span class="mrow" id="MathJax-Span-1050"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.507em;"></span></span><span style="position: absolute; clip: rect(4.664em, 1017.22em, 13.117em, -999.997em); top: -9.116em; left: 3.435em;"><span style="display: inline-block; position: relative; width: 17.318em; height: 0px;"><span style="position: absolute; clip: rect(2.923em, 1009.38em, 4.664em, -999.997em); top: -7.374em; left: 0em;"><span class="mtd" id="MathJax-Span-919"><span class="mrow" id="MathJax-Span-920"><span class="msubsup" id="MathJax-Span-921"><span style="display: inline-block; position: relative; width: 4.511em; height: 0px;"><span style="position: absolute; clip: rect(2.974em, 1003.13em, 4.511em, -999.997em); top: -3.993em; left: 0em;"><span class="mrow" id="MathJax-Span-922"><span class="mo" id="MathJax-Span-923" style="vertical-align: -0.202em;"><span style="font-family: STIXSizeOneSym;">⟨</span></span><span class="mi" id="MathJax-Span-924" style="font-family: STIXGeneral-Italic;">𝑔</span><span class="mo" id="MathJax-Span-925" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-926"><span class="mrow" id="MathJax-Span-927"><span class="mi" id="MathJax-Span-928" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="msubsup" id="MathJax-Span-929"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.31em, 4.306em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-930" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.361em;"><span class="mn" id="MathJax-Span-931" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-932" style="vertical-align: -0.202em;"><span style="font-family: STIXSizeOneSym;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.584em; left: 3.23em;"><span class="texatom" id="MathJax-Span-933"><span class="mrow" id="MathJax-Span-934"><span class="mi" id="MathJax-Span-935" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-936" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-937"><span class="mrow" id="MathJax-Span-938"><span class="mi" id="MathJax-Span-939" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-940" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-941" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">−</span><span class="msubsup" id="MathJax-Span-942" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 3.691em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1002.36em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mrow" id="MathJax-Span-943"><span class="mo" id="MathJax-Span-944" style="font-family: STIXGeneral-Regular;">⟨</span><span class="mi" id="MathJax-Span-945" style="font-family: STIXGeneral-Italic;">𝑔</span><span class="mo" id="MathJax-Span-946" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-947"><span class="mrow" id="MathJax-Span-948"><span class="mi" id="MathJax-Span-949" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-950" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-951" style="font-family: STIXGeneral-Regular;">⟩</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -4.454em; left: 2.462em;"><span class="mn" id="MathJax-Span-952" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.23em, 4.306em, -999.997em); top: -3.737em; left: 2.462em;"><span class="texatom" id="MathJax-Span-953"><span class="mrow" id="MathJax-Span-954"><span class="mi" id="MathJax-Span-955" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-956" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-957"><span class="mrow" id="MathJax-Span-958"><span class="mi" id="MathJax-Span-959" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-960" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.974em, 1006.61em, 4.664em, -999.997em); top: -5.633em; left: 0em;"><span class="mtd" id="MathJax-Span-964"><span class="mrow" id="MathJax-Span-965"><span class="msubsup" id="MathJax-Span-966"><span style="display: inline-block; position: relative; width: 4.511em; height: 0px;"><span style="position: absolute; clip: rect(2.974em, 1003.13em, 4.511em, -999.997em); top: -3.993em; left: 0em;"><span class="mrow" id="MathJax-Span-967"><span class="mo" id="MathJax-Span-968" style="vertical-align: -0.202em;"><span style="font-family: STIXSizeOneSym;">⟨</span></span><span class="mi" id="MathJax-Span-969" style="font-family: STIXGeneral-Italic;">𝑔</span><span class="mo" id="MathJax-Span-970" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-971"><span class="mrow" id="MathJax-Span-972"><span class="mi" id="MathJax-Span-973" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="msubsup" id="MathJax-Span-974"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.31em, 4.306em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-975" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.361em;"><span class="mn" id="MathJax-Span-976" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-977" style="vertical-align: -0.202em;"><span style="font-family: STIXSizeOneSym;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.584em; left: 3.23em;"><span class="texatom" id="MathJax-Span-978"><span class="mrow" id="MathJax-Span-979"><span class="mi" id="MathJax-Span-980" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-981" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-982"><span class="mrow" id="MathJax-Span-983"><span class="mi" id="MathJax-Span-984" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-985" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-986" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">−</span><span class="msubsup" id="MathJax-Span-987" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-988" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -4.352em; left: 0.515em;"><span class="mn" id="MathJax-Span-989" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.686em; left: 0.515em;"><span class="mn" id="MathJax-Span-990" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.257em, 1017.22em, 5.587em, -999.997em); top: -3.174em; left: 0em;"><span class="mtd" id="MathJax-Span-994"><span class="mrow" id="MathJax-Span-995"><span class="mi" id="MathJax-Span-996"></span><span class="munderover" id="MathJax-Span-997" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.283em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.18em, 4.613em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-998" style="font-family: STIXSizeOneSym; vertical-align: -0.51em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.98em, 4.255em, -999.997em); top: -2.866em; left: 0.105em;"><span class="texatom" id="MathJax-Span-999"><span class="mrow" id="MathJax-Span-1000"><span class="mi" id="MathJax-Span-1001" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span class="mo" id="MathJax-Span-1002" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-1003" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1000.36em, 4.306em, -999.997em); top: -5.223em; left: 0.464em;"><span class="mi" id="MathJax-Span-1004" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1005" style="font-family: STIXGeneral-Regular; padding-left: 0.207em;">var</span><span class="mrow" id="MathJax-Span-1006" style="padding-left: 0.207em;"><span class="mo" id="MathJax-Span-1007" style="vertical-align: 0em;"><span style="font-family: STIXGeneral-Regular;">(</span></span><span class="msubsup" id="MathJax-Span-1008"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1009" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-1010" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1011" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1012"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1013" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-1014" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1015" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1016" style="vertical-align: 0em;"><span style="font-family: STIXGeneral-Regular;">)</span></span></span><span class="mo" id="MathJax-Span-1017" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">+</span><span class="munderover" id="MathJax-Span-1018" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 1.283em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.18em, 4.613em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-1019" style="font-family: STIXSizeOneSym; vertical-align: -0.51em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.98em, 4.408em, -999.997em); top: -2.866em; left: 0.156em;"><span class="texatom" id="MathJax-Span-1020"><span class="mrow" id="MathJax-Span-1021"><span class="mi" id="MathJax-Span-1022" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span class="mo" id="MathJax-Span-1023" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">&lt;</span><span class="mi" id="MathJax-Span-1024" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑗</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1000.36em, 4.306em, -999.997em); top: -5.223em; left: 0.464em;"><span class="texatom" id="MathJax-Span-1025"><span class="mrow" id="MathJax-Span-1026"><span class="mi" id="MathJax-Span-1027" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1028" style="font-family: STIXGeneral-Regular; padding-left: 0.207em;">var</span><span class="mrow" id="MathJax-Span-1029" style="padding-left: 0.207em;"><span class="mo" id="MathJax-Span-1030" style="vertical-align: -0.202em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup" id="MathJax-Span-1031"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1032" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="texatom" id="MathJax-Span-1033"><span class="mrow" id="MathJax-Span-1034"><span class="mi" id="MathJax-Span-1035" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span class="mi" id="MathJax-Span-1036" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑗</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1037" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1038"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1039" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-1040" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1041" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-1042" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1043" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-1044" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑗</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1045" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1046" style="vertical-align: -0.202em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mo" id="MathJax-Span-1047" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">+</span><span class="mo" id="MathJax-Span-1048" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">⋯</span></span></span><span style="display: inline-block; width: 0px; height: 4.05em;"></span></span><span style="position: absolute; clip: rect(2.974em, 1013.07em, 4.511em, -999.997em); top: -0.561em; left: 0em;"><span class="mtd" id="MathJax-Span-1051"><span class="mrow" id="MathJax-Span-1052"><span class="mi" id="MathJax-Span-1053"></span><span class="mo" id="MathJax-Span-1054" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">+</span><span class="mtext" id="MathJax-Span-1055" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">var</span><span class="mrow" id="MathJax-Span-1056" style="padding-left: 0.207em;"><span class="mo" id="MathJax-Span-1057" style="vertical-align: -0.202em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup" id="MathJax-Span-1058"><span style="display: inline-block; position: relative; width: 2.871em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1059" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="texatom" id="MathJax-Span-1060"><span class="mrow" id="MathJax-Span-1061"><span class="mn" id="MathJax-Span-1062" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-1063" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-1064" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span class="mo" id="MathJax-Span-1065" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-1066" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">…</span><span class="mo" id="MathJax-Span-1067" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1068" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1069" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1070"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1071" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1072" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1073" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-1074" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1075" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1076" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1077" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-1078" style="font-family: STIXGeneral-Regular; padding-left: 0.207em;">…</span><span class="mo" id="MathJax-Span-1079" style="font-family: STIXGeneral-Regular; padding-left: 0.207em;">,</span><span class="msubsup" id="MathJax-Span-1080" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1081" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-1082" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1083" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1084" style="vertical-align: -0.202em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mo" id="MathJax-Span-1085" style="font-family: STIXGeneral-Regular; padding-left: 0.207em;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.121em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -4.747em; border-left: 0px solid; width: 0px; height: 10.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mtext>var</mtext><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">)</mo><mo>=</mo></mtd><mtd><msub><mrow><mo>⟨</mo><mi>g</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>⟩</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></mrow></msub><mo>−</mo><msubsup><mrow><mo>⟨</mo><mi>g</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>⟩</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msubsup></mtd></mtr><mtr><mtd><mo>=</mo></mtd><mtd><msub><mrow><mo>⟨</mo><mi>g</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>⟩</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></mrow></msub><mo>−</mo><msubsup><mi>g</mi><mn>0</mn><mn>2</mn></msubsup></mtd></mtr><mtr><mtd><mo>=</mo></mtd><mtd><mi></mi><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><mtext>var</mtext><mrow><mo>(</mo><msub><mi>g</mi><mi>i</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>)</mo></mrow><mo>+</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>&lt;</mo><mi>j</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>p</mi></mrow></munderover><mtext>var</mtext><mrow><mo>(</mo><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>)</mo></mrow><mo>+</mo><mo>⋯</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>+</mo><mtext>var</mtext><mrow><mo>(</mo><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>p</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>x</mi><mi>p</mi></msub><mo stretchy="false">)</mo><mo>)</mo></mrow><mo>.</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-76">
\begin{align*}
\text{var}(g) = & \left\langle g(\mathbf{ x})^2  \right\rangle _{p(\mathbf{ x})} - \left\langle g(\mathbf{ x}) \right\rangle _{p(\mathbf{ x})}^2 \\
 = & \left\langle g(\mathbf{ x})^2  \right\rangle _{p(\mathbf{ x})} - g_0^2\\
 = & \sum_{i=1}^p\text{var}\left(g_i(x_i)\right) + \sum_{i<j}^{p} \text{var}\left(g_{ij}(x_i,x_j)\right)  + \cdots \\ & + \text{var}\left(g_{1,2,\dots,p}(x_1,x_2,\dots,x_p)\right).
\end{align*}
</script></span> So, this decomposition gives us a decomposition of the function in terms of variances. It’s for this reason that it’s sometimes known as an ANOVA decomposition. ANOVA stands a for <em>analysis of variance</em>. The ANOVA decomposition decomposes the function into additive variance parts that are each stemming from interactions between different inputs.</p>
<p>As is common in various analyses of variance, we can rescale the components with the <em>total variance</em> of the function. These rescaled components are known as <em>Sobol indicies</em>. <span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mtext&gt;var&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mtext&gt;var&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1086" style="width: 8.968em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.328em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.078em, 1007.28em, 3.589em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-1087"><span class="msubsup" id="MathJax-Span-1088"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1089" style="font-family: STIXGeneral-Italic;">𝑆<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.669em;"><span class="mi" id="MathJax-Span-1090" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ℓ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1091" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mfrac" id="MathJax-Span-1092" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 4.408em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.179em, 1004.25em, 4.357em, -999.997em); top: -4.659em; left: 50%; margin-left: -2.149em;"><span class="mrow" id="MathJax-Span-1093"><span class="mtext" id="MathJax-Span-1094" style="font-family: STIXGeneral-Regular;">var</span><span class="mrow" id="MathJax-Span-1095" style="padding-left: 0.207em;"><span class="mo" id="MathJax-Span-1096" style="vertical-align: 0em;"><span style="font-family: STIXGeneral-Regular;">(</span></span><span class="mi" id="MathJax-Span-1097" style="font-family: STIXGeneral-Italic;">𝑔</span><span class="mo" id="MathJax-Span-1098" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1099"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1100"><span class="mrow" id="MathJax-Span-1101"><span class="mi" id="MathJax-Span-1102" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-1103" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ℓ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1104" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1105" style="vertical-align: 0em;"><span style="font-family: STIXGeneral-Regular;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1003.74em, 4.357em, -999.997em); top: -3.327em; left: 50%; margin-left: -1.893em;"><span class="mrow" id="MathJax-Span-1106"><span class="mtext" id="MathJax-Span-1107" style="font-family: STIXGeneral-Regular;">var</span><span class="mrow" id="MathJax-Span-1108" style="padding-left: 0.207em;"><span class="mo" id="MathJax-Span-1109" style="vertical-align: 0em;"><span style="font-family: STIXGeneral-Regular;">(</span></span><span class="mi" id="MathJax-Span-1110" style="font-family: STIXGeneral-Italic;">𝑔</span><span class="mo" id="MathJax-Span-1111" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1112"><span class="mrow" id="MathJax-Span-1113"><span class="mi" id="MathJax-Span-1114" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-1115" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1116" style="vertical-align: 0em;"><span style="font-family: STIXGeneral-Regular;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1004.41em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.408em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-1117" style="font-family: STIXGeneral-Regular;">,</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.816em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>S</mi><mi>ℓ</mi></msub><mo>=</mo><mfrac><mrow><mtext>var</mtext><mrow><mo>(</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mi>ℓ</mi></msub><mo stretchy="false">)</mo><mo>)</mo></mrow></mrow><mrow><mtext>var</mtext><mrow><mo>(</mo><mi>g</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>)</mo></mrow></mrow></mfrac><mo>,</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-77">
S_\ell = \frac{\text{var}\left(g(\mathbf{ x}_\ell)\right)}{\text{var}\left(g(\mathbf{ x})\right)},
</script></span> where the <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1118" style="width: 0.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1000.57em, 2.718em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-1119"><span class="mi" id="MathJax-Span-1120" style="font-family: STIXGeneral-Italic;">ℓ</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ℓ</mi></math></span></span><script type="math/tex" id="MathJax-Element-78">\ell</script></span> represents the relevent set of indices for the different combinations of inputs.</p>
<p>In practice, for an elegant approach that exploits a particular covariance function structure to perform global sensitivity analysis see <span class="citation" data-cites="Durrande-anova13">Durrande et al. (2013)</span>.</p>
<h1 id="example-the-ishigami-function">Example: the Ishigami function</h1>
<p>We illustrate the exact calculation of the Sobol indices with the three-dimensional Ishigami function of <span class="citation" data-cites="Ishigami-importance90">(Ishigami and Homma, 1989)</span>.</p>
<h3 id="ishigami-function">Ishigami Function</h3>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span class="editsection" style=""><a href="https://github.com/lawrennd/talks/edit/gh-pages/_uq/includes/ishigami-function.md" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Edit Page&#39;, &#39;Edit&#39;, &#39;https://github.com/lawrennd/talks/edit/gh-pages/_uq/includes/ishigami-function.md&#39;, 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>The Ishigami function <span class="citation" data-cites="Ishigami-importance90">(Ishigami and Homma, 1989)</span> is a well-known test function for uncertainty and sensitivity analysis methods because of its strong nonlinearity and peculiar dependence on <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1121" style="width: 1.181em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.98em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1122"><span class="msubsup" id="MathJax-Span-1123"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1124" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1125" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mn>3</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-79">x_3</script></span>. More details of this function can be found in <span class="citation" data-cites="Sobol-variance99">(Sobol and Levitan, 1999)</span>.</p>
<p>Mathematically, the form of the Ishigami function is <span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext mathvariant=&quot;bold&quot;&gt;x&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msubsup&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1126" style="width: 20.597em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.857em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.539em, 1016.81em, 3.025em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-1127"><span class="mi" id="MathJax-Span-1128" style="font-family: STIXGeneral-Italic;">𝑔</span><span class="mo" id="MathJax-Span-1129" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1130"><span class="mrow" id="MathJax-Span-1131"><span class="mtext" id="MathJax-Span-1132" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-1133" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1134" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mi" id="MathJax-Span-1135" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">sin</span><span class="mo" id="MathJax-Span-1136"></span><span class="mo" id="MathJax-Span-1137" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1138"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1139" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1140" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1141" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1142" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">+</span><span class="mi" id="MathJax-Span-1143" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">𝑎</span><span class="msubsup" id="MathJax-Span-1144" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.591em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1001.13em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1145" style="font-family: STIXGeneral-Regular;">sin</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 1.181em;"><span class="mn" id="MathJax-Span-1146" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1147"></span><span class="mo" id="MathJax-Span-1148" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1149"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1150" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1151" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1152" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1153" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">+</span><span class="mi" id="MathJax-Span-1154" style="font-family: STIXGeneral-Italic; padding-left: 0.259em;">𝑏</span><span class="msubsup" id="MathJax-Span-1155"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1156" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -4.352em; left: 0.566em;"><span class="mn" id="MathJax-Span-1157" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.686em; left: 0.566em;"><span class="mn" id="MathJax-Span-1158" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-1159" style="font-family: STIXGeneral-Regular; padding-left: 0.207em;">sin</span><span class="mo" id="MathJax-Span-1160"></span><span class="mo" id="MathJax-Span-1161" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1162"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1163" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1164" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1165" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1166" style="font-family: STIXGeneral-Regular;">.</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>g</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">x</mtext></mrow><mo stretchy="false">)</mo><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mi>a</mi><msup><mi>sin</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mi>b</mi><msubsup><mi>x</mi><mn>3</mn><mn>4</mn></msubsup><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-80">
g(\textbf{x}) = \sin(x_1) + a \sin^2(x_2) + b x_3^4 \sin(x_1). 
</script></span> We will set the parameters to be <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1167" style="width: 2.82em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.308em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1002.26em, 2.718em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-1168"><span class="mi" id="MathJax-Span-1169" style="font-family: STIXGeneral-Italic;">𝑎</span><span class="mo" id="MathJax-Span-1170" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mn" id="MathJax-Span-1171" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">5</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>=</mo><mn>5</mn></math></span></span><script type="math/tex" id="MathJax-Element-81">a = 5</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0.1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1172" style="width: 3.691em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.025em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1002.92em, 2.718em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-1173"><span class="mi" id="MathJax-Span-1174" style="font-family: STIXGeneral-Italic;">𝑏</span><span class="mo" id="MathJax-Span-1175" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mn" id="MathJax-Span-1176" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">0.1</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mo>=</mo><mn>0.1</mn></math></span></span><script type="math/tex" id="MathJax-Element-82">b=0.1</script></span> . The input variables are sampled randomly <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;U&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1177" style="width: 7.636em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.253em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.205em, 1006.2em, 3.332em, -999.997em); top: -3.02em; left: 0em;"><span class="mrow" id="MathJax-Span-1178"><span class="msubsup" id="MathJax-Span-1179"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1180" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-1181" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1182" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">∼</span><span class="texatom" id="MathJax-Span-1183" style="padding-left: 0.31em;"><span class="mrow" id="MathJax-Span-1184"><span class="mi" id="MathJax-Span-1185" style="font-family: STIXNonUnicode-Italic;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.156em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1186" style="padding-left: 0.207em;"><span class="mo" id="MathJax-Span-1187" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-1188" style="font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-1189" style="font-family: STIXGeneral-Italic;">𝜋<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1190" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1191" style="font-family: STIXGeneral-Italic; padding-left: 0.207em;">𝜋<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1192" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.025em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>i</mi></msub><mo>∼</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">U</mi></mrow><mrow><mo>(</mo><mo>−</mo><mi>π</mi><mo>,</mo><mi>π</mi><mo>)</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-83">x_i \sim \mathcal{U}\left(-\pi,\pi\right)</script></span>.</p>
<p>Next, we create the function object and visualize its shape marginally for each one of its three inputs.</p>
<p>Load the Ishigami function</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> emukit.test_functions.sensitivity <span class="im">import</span> Ishigami</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb18-1" aria-hidden="true" tabindex="-1"></a>ishigami <span class="op">=</span> Ishigami(a<span class="op">=</span><span class="dv">5</span>, b<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb18-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb18-2" aria-hidden="true" tabindex="-1"></a>target_function <span class="op">=</span> ishigami.fidelity1</span></code></pre></div>
<p>That gives us the target function, next we define the input space for the simulator.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb19-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> emukit.core <span class="im">import</span> ContinuousParameter, ParameterSpace</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb20-1" aria-hidden="true" tabindex="-1"></a>variable_domain <span class="op">=</span> (<span class="op">-</span>np.pi,np.pi)</span>
<span id="cb20-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb20-2" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb20-3"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb20-3" aria-hidden="true" tabindex="-1"></a>space <span class="op">=</span> ParameterSpace(</span>
<span id="cb20-4"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb20-4" aria-hidden="true" tabindex="-1"></a>          [ContinuousParameter(<span class="st">'x1'</span>, <span class="op">*</span>variable_domain), </span>
<span id="cb20-5"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb20-5" aria-hidden="true" tabindex="-1"></a>           ContinuousParameter(<span class="st">'x2'</span>, <span class="op">*</span>variable_domain),</span>
<span id="cb20-6"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb20-6" aria-hidden="true" tabindex="-1"></a>           ContinuousParameter(<span class="st">'x3'</span>, <span class="op">*</span>variable_domain)])</span></code></pre></div>
<p>Before moving to any further analysis, we first plot the non-zero components <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1193" style="width: 2.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.642em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1001.59em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-1194"><span class="mi" id="MathJax-Span-1195" style="font-family: STIXGeneral-Italic;">𝑔</span><span class="mo" id="MathJax-Span-1196" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1197"><span class="mrow" id="MathJax-Span-1198"><span class="mi" id="MathJax-Span-1199" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-1200" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-84">g(\mathbf{ x})</script></span>. These components are <span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;13&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msubsup&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1201" style="width: 12.759em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.453em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(-0.151em, 1010.4em, 4.05em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1202"><span class="mtable" id="MathJax-Span-1203"><span style="display: inline-block; position: relative; width: 10.146em; height: 0px; margin-right: 0.156em; margin-left: 0.156em;"><span style="position: absolute; clip: rect(2.41em, 1004.31em, 6.406em, -999.997em); top: -4.659em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.357em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1002.51em, 4.357em, -999.997em); top: -5.377em; right: 0em;"><span class="mtd" id="MathJax-Span-1204"><span class="mrow" id="MathJax-Span-1205"><span class="msubsup" id="MathJax-Span-1206"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1207" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mn" id="MathJax-Span-1208" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1209" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1210"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1211" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1212" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1213" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1002.51em, 4.357em, -999.997em); top: -3.993em; right: 0em;"><span class="mtd" id="MathJax-Span-1225"><span class="mrow" id="MathJax-Span-1226"><span class="msubsup" id="MathJax-Span-1227"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1228" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mn" id="MathJax-Span-1229" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1230" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1231"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1232" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1233" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1234" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1004.31em, 4.357em, -999.997em); top: -2.61em; right: 0em;"><span class="mtd" id="MathJax-Span-1249"><span class="mrow" id="MathJax-Span-1250"><span class="msubsup" id="MathJax-Span-1251"><span style="display: inline-block; position: relative; width: 1.283em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1252" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="texatom" id="MathJax-Span-1253"><span class="mrow" id="MathJax-Span-1254"><span class="mn" id="MathJax-Span-1255" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">13</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1256" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1257"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1258" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1259" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1260" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-1261" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1262" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1263" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1264" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.664em;"></span></span><span style="position: absolute; clip: rect(2.564em, 1005.74em, 6.662em, -999.997em); top: -4.813em; left: 4.357em;"><span style="display: inline-block; position: relative; width: 5.791em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1004.05em, 4.306em, -999.997em); top: -5.377em; left: 0em;"><span class="mtd" id="MathJax-Span-1214"><span class="mrow" id="MathJax-Span-1215"><span class="mi" id="MathJax-Span-1216"></span><span class="mo" id="MathJax-Span-1217" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mi" id="MathJax-Span-1218" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">sin</span><span class="mo" id="MathJax-Span-1219"></span><span class="mo" id="MathJax-Span-1220" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1221"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1222" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1223" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1224" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.974em, 1005.23em, 4.306em, -999.997em); top: -3.993em; left: 0em;"><span class="mtd" id="MathJax-Span-1235"><span class="mrow" id="MathJax-Span-1236"><span class="mi" id="MathJax-Span-1237"></span><span class="mo" id="MathJax-Span-1238" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mi" id="MathJax-Span-1239" style="font-family: STIXGeneral-Italic; padding-left: 0.31em;">𝑎</span><span class="msubsup" id="MathJax-Span-1240" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.591em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1001.13em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1241" style="font-family: STIXGeneral-Regular;">sin</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 1.181em;"><span class="mn" id="MathJax-Span-1242" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1243"></span><span class="mo" id="MathJax-Span-1244" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1245"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1246" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1247" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1248" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.025em, 1005.74em, 4.46em, -999.997em); top: -2.61em; left: 0em;"><span class="mtd" id="MathJax-Span-1265"><span class="mrow" id="MathJax-Span-1266"><span class="mi" id="MathJax-Span-1267"></span><span class="mo" id="MathJax-Span-1268" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mi" id="MathJax-Span-1269" style="font-family: STIXGeneral-Italic; padding-left: 0.31em;">𝑏</span><span class="msubsup" id="MathJax-Span-1270"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1271" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -4.352em; left: 0.566em;"><span class="mn" id="MathJax-Span-1272" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.686em; left: 0.566em;"><span class="mn" id="MathJax-Span-1273" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-1274" style="font-family: STIXGeneral-Regular; padding-left: 0.207em;">sin</span><span class="mo" id="MathJax-Span-1275"></span><span class="mo" id="MathJax-Span-1276" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1277"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1278" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1279" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1280" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.818em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.122em; border-left: 0px solid; width: 0px; height: 4.878em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>g</mi><mn>1</mn></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mi>a</mi><msup><mi>sin</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mn>13</mn></mrow></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mi>b</mi><msubsup><mi>x</mi><mn>3</mn><mn>4</mn></msubsup><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-85">
\begin{align*}
g_1(x_1) & = \sin(x_1) \\
g_2(x_1) & = a \sin^2 (x_2) \\
g_{13}(x_1,x_3) & = b x_3^4 \sin(x_1) 
\end{align*}
</script></span></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb21-1" aria-hidden="true" tabindex="-1"></a>x_grid <span class="op">=</span> np.linspace(<span class="op">*</span>variable_domain,<span class="dv">100</span>)</span>
<span id="cb21-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb21-2" aria-hidden="true" tabindex="-1"></a>target_simulator <span class="op">=</span> ishigami.fidelity1</span>
<span id="cb21-3"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb21-3" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> ishigami.f1(x_grid)</span>
<span id="cb21-4"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb21-4" aria-hidden="true" tabindex="-1"></a>f2 <span class="op">=</span> ishigami.f2(x_grid)</span>
<span id="cb21-5"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb21-5" aria-hidden="true" tabindex="-1"></a>F13 <span class="op">=</span> ishigami.f13(np.array([x_grid,x_grid]).T)[:,np.newaxis]</span></code></pre></div>
<div class="figure">
<div id="non-zero-sobol-ishigami-figure" class="figure-frame">
<object class="svgplot " data="./Lawrence2021_files/non-zero-sobol-ishigami.svg" width="80%" style=" ">
</object>
</div>
<div id="non-zero-sobol-ishigami-magnify" class="magnify" onclick="magnifyFigure(&#39;non-zero-sobol-ishigami&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="non-zero-sobol-ishigami-caption" class="caption-frame">
<p>Figure: The non-zero components of the Ishigami function.</p>
</div>
</div>
<h2 id="total-variance">Total Variance</h2>
<p>The total variance <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;var&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1281" style="width: 2.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1002.36em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-1282"><span class="mtext" id="MathJax-Span-1283" style="font-family: STIXGeneral-Regular;">var</span><span class="mo" id="MathJax-Span-1284" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1285" style="font-family: STIXGeneral-Italic;">𝑦</span><span class="mo" id="MathJax-Span-1286" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>var</mtext><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-86">\text{var}(y)</script></span> in this example is</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ishigami.variance_total)</span></code></pre></div>
<p>which is the sum of the variance of <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;var&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1287" style="width: 5.791em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.716em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1004.66em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-1288"><span class="mtext" id="MathJax-Span-1289" style="font-family: STIXGeneral-Regular;">var</span><span class="mrow" id="MathJax-Span-1290" style="padding-left: 0.207em;"><span class="mo" id="MathJax-Span-1291" style="vertical-align: 0em;"><span style="font-family: STIXGeneral-Regular;">(</span></span><span class="msubsup" id="MathJax-Span-1292"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1293" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mn" id="MathJax-Span-1294" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1295" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1296"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1297" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1298" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1299" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1300" style="vertical-align: 0em;"><span style="font-family: STIXGeneral-Regular;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>var</mtext><mrow><mo>(</mo><msub><mi>g</mi><mn>1</mn></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>)</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-87">\text{var}\left(g_1(x_1)\right)</script></span>, <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;var&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1301" style="width: 5.791em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.716em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1004.66em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-1302"><span class="mtext" id="MathJax-Span-1303" style="font-family: STIXGeneral-Regular;">var</span><span class="mrow" id="MathJax-Span-1304" style="padding-left: 0.207em;"><span class="mo" id="MathJax-Span-1305" style="vertical-align: 0em;"><span style="font-family: STIXGeneral-Regular;">(</span></span><span class="msubsup" id="MathJax-Span-1306"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1307" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mn" id="MathJax-Span-1308" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1309" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1310"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1311" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1312" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1313" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1314" style="vertical-align: 0em;"><span style="font-family: STIXGeneral-Regular;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>var</mtext><mrow><mo>(</mo><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>)</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-88">\text{var}\left(g_2(x_2)\right)</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;var&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1315" style="width: 7.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.996em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.949em, 1005.84em, 3.486em, -999.997em); top: -2.969em; left: 0em;"><span class="mrow" id="MathJax-Span-1316"><span class="mtext" id="MathJax-Span-1317" style="font-family: STIXGeneral-Regular;">var</span><span class="mrow" id="MathJax-Span-1318" style="padding-left: 0.207em;"><span class="mo" id="MathJax-Span-1319" style="vertical-align: -0.202em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup" id="MathJax-Span-1320"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1321" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="texatom" id="MathJax-Span-1322"><span class="mrow" id="MathJax-Span-1323"><span class="mn" id="MathJax-Span-1324" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-1325" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-1326" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1327" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1328"><span style="display: inline-block; position: relative; width: 1.488em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1329" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="texatom" id="MathJax-Span-1330"><span class="mrow" id="MathJax-Span-1331"><span class="mn" id="MathJax-Span-1332" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-1333" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-1334" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1335" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1336" style="vertical-align: -0.202em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.974em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>var</mtext><mrow><mo>(</mo><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mo>,</mo><mn>3</mn></mrow></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mo>,</mo><mn>3</mn></mrow></msub><mo stretchy="false">)</mo><mo>)</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-89">\text{var}\left(g_{1,3}(x_{1,3})\right)</script></span></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ishigami.variance_x1, ishigami.variance_x2, ishigami.variance_x13)</span>
<span id="cb23-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ishigami.variance_x1 <span class="op">+</span> ishigami.variance_x2 <span class="op">+</span> ishigami.variance_x13)</span></code></pre></div>
<h2 id="first-order-sobol-indices-using-monte-carlo">First Order Sobol Indices using Monte Carlo</h2>
<p>The first order Sobol indices are a measure of “first order sensitivity” of each input variable. They account for the proportion of variance of <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1337" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.949em, 1000.51em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-1338"><span class="mi" id="MathJax-Span-1339" style="font-family: STIXGeneral-Italic;">𝑦</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-90">y</script></span> explained by changing each variable alone while marginalizing over the rest. Recall that the Sobol index of the <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1340" style="width: 0.412em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.31em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.796em, 1000.26em, 2.718em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-1341"><span class="mi" id="MathJax-Span-1342" style="font-family: STIXGeneral-Italic;">𝑖</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-91">i</script></span>th variable is computed as <span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mtext&gt;var&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mtext&gt;var&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1343" style="width: 8.916em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.277em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.078em, 1007.23em, 3.589em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-1344"><span class="msubsup" id="MathJax-Span-1345"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1346" style="font-family: STIXGeneral-Italic;">𝑆<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.669em;"><span class="mi" id="MathJax-Span-1347" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1348" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mfrac" id="MathJax-Span-1349" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 4.562em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.179em, 1004.41em, 4.357em, -999.997em); top: -4.659em; left: 50%; margin-left: -2.2em;"><span class="mrow" id="MathJax-Span-1350"><span class="mtext" id="MathJax-Span-1351" style="font-family: STIXGeneral-Regular;">var</span><span class="mrow" id="MathJax-Span-1352" style="padding-left: 0.207em;"><span class="mo" id="MathJax-Span-1353" style="vertical-align: 0em;"><span style="font-family: STIXGeneral-Regular;">(</span></span><span class="msubsup" id="MathJax-Span-1354"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1355" style="font-family: STIXGeneral-Italic;">𝑔</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-1356" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1357" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1358"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1359" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-1360" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1361" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1362" style="vertical-align: 0em;"><span style="font-family: STIXGeneral-Regular;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1003.74em, 4.357em, -999.997em); top: -3.327em; left: 50%; margin-left: -1.893em;"><span class="mrow" id="MathJax-Span-1363"><span class="mtext" id="MathJax-Span-1364" style="font-family: STIXGeneral-Regular;">var</span><span class="mrow" id="MathJax-Span-1365" style="padding-left: 0.207em;"><span class="mo" id="MathJax-Span-1366" style="vertical-align: 0em;"><span style="font-family: STIXGeneral-Regular;">(</span></span><span class="mi" id="MathJax-Span-1367" style="font-family: STIXGeneral-Italic;">𝑔</span><span class="mo" id="MathJax-Span-1368" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1369"><span class="mrow" id="MathJax-Span-1370"><span class="mi" id="MathJax-Span-1371" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-1372" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1373" style="vertical-align: 0em;"><span style="font-family: STIXGeneral-Regular;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1004.56em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.562em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-1374" style="font-family: STIXGeneral-Regular;">.</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.816em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>S</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mtext>var</mtext><mrow><mo>(</mo><msub><mi>g</mi><mi>i</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>)</mo></mrow></mrow><mrow><mtext>var</mtext><mrow><mo>(</mo><mi>g</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>)</mo></mrow></mrow></mfrac><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-92">
S_i = \frac{\text{var}\left(g_i(x_i)\right)}{\text{var}\left(g(\mathbf{ x})\right)}.
</script></span> This value is standardized using the total variance, so it is possible to account for a fractional contribution of each variable to the total variance of the output.</p>
<p>The Sobol indices for higher order interactions <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1375" style="width: 1.693em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.386em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1001.39em, 2.666em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1376"><span class="msubsup" id="MathJax-Span-1377"><span style="display: inline-block; position: relative; width: 1.386em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1378" style="font-family: STIXGeneral-Italic;">𝑆<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.669em;"><span class="texatom" id="MathJax-Span-1379"><span class="mrow" id="MathJax-Span-1380"><span class="mi" id="MathJax-Span-1381" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span class="mo" id="MathJax-Span-1382" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1383" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑗</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-93">S_{i,j}</script></span> are computed similarly. Due to the normalization by the total variance, the the sum of all Sobol indices equals to one.</p>
<p>In most cases we are interested in the first order indices. The Ishigami function has the benefit that these can be computed analytically. In <code>EmuKit</code> you can extract these values with the code.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb24-1" aria-hidden="true" tabindex="-1"></a>ishigami.main_effects</span></code></pre></div>
<p>But in general, these indices need to be sampled using Monte Carlo or one of the quasi-Monte Carlo methods we’ve seen in the model-free experimental design. Details are given in <span class="citation" data-cites="Sobol-global01">(Sobol, 2001)</span>.</p>
<p>With Emukit, the first-order Sobol indices can be easily computed. We first need to define the space where of target simulator is analyzed.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> emukit.sensitivity.monte_carlo <span class="im">import</span> ModelFreeMonteCarloSensitivity</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb26-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">10</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb26-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb26-3" aria-hidden="true" tabindex="-1"></a>num_monte_carlo_points <span class="op">=</span> <span class="dv">10000</span>  <span class="co"># Number of MC samples</span></span>
<span id="cb26-4"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb26-4" aria-hidden="true" tabindex="-1"></a>senstivity_ishigami <span class="op">=</span> ModelFreeMonteCarloSensitivity(target_simulator, space)</span>
<span id="cb26-5"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb26-5" aria-hidden="true" tabindex="-1"></a>main_effects, total_effects, _ <span class="op">=</span> senstivity_ishigami.compute_effects(num_monte_carlo_points <span class="op">=</span> num_monte_carlo_points)</span>
<span id="cb26-6"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(main_effects)</span></code></pre></div>
<p>We compare the true effects with the Monte Carlo effects in a bar-plot. The total effects are discussed later.</p>
<div class="figure">
<div id="first-order-sobol-indices-ishigami-figure" class="figure-frame">
<object class="svgplot " data="./Lawrence2021_files/first-order-sobol-indices-ishigami.svg" width="80%" style=" ">
</object>
</div>
<div id="first-order-sobol-indices-ishigami-magnify" class="magnify" onclick="magnifyFigure(&#39;first-order-sobol-indices-ishigami&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="first-order-sobol-indices-ishigami-caption" class="caption-frame">
<p>Figure: The non-zero components of the Ishigami function.</p>
</div>
</div>
<h2 id="total-effects-using-monte-carlo">Total Effects Using Monte Carlo</h2>
<p>Computing high order sensitivity indices can be computationally very demanding in high dimensional scenarios and measuring the total influence of each variable on the variance of the output is infeasible. To solve this issue the <em>total</em> indices are used which account for the contribution to the output variance of <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1384" style="width: 1.027em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.82em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1385"><span class="msubsup" id="MathJax-Span-1386"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1387" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-1388" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-94">x_i</script></span> including all variance caused by the variable alone and all its interactions of any order.</p>
<p>The total effect for <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1389" style="width: 1.027em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.82em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1390"><span class="msubsup" id="MathJax-Span-1391"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1392" style="font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-1393" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-95">x_i</script></span> is given by: <span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x27E8;&lt;/mo&gt;&lt;msub&gt;&lt;mtext&gt;var&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mtext&gt;var&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mtext&gt;var&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x27E8;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x27E9;&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mtext&gt;var&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1394" style="width: 26.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.775em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.822em, 1021.77em, 3.589em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-1395"><span class="msubsup" id="MathJax-Span-1396"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1397" style="font-family: STIXGeneral-Italic;">𝑆<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.669em;"><span class="texatom" id="MathJax-Span-1398"><span class="mrow" id="MathJax-Span-1399"><span class="mi" id="MathJax-Span-1400" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑇<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="mi" id="MathJax-Span-1401" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1402" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mfrac" id="MathJax-Span-1403" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 7.994em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.128em, 1007.89em, 4.562em, -999.997em); top: -4.864em; left: 50%; margin-left: -3.942em;"><span class="msubsup" id="MathJax-Span-1404"><span style="display: inline-block; position: relative; width: 7.892em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1006em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mrow" id="MathJax-Span-1405"><span class="mo" id="MathJax-Span-1406" style=""><span style="font-family: STIXGeneral-Regular;">⟨</span></span><span class="msubsup" id="MathJax-Span-1407"><span style="display: inline-block; position: relative; width: 1.949em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1001.28em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mtext" id="MathJax-Span-1408" style="font-family: STIXGeneral-Regular;">var</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 1.283em;"><span class="texatom" id="MathJax-Span-1409"><span class="mrow" id="MathJax-Span-1410"><span class="msubsup" id="MathJax-Span-1411"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.36em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1412" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑥</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.412em;"><span class="mi" id="MathJax-Span-1413" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1414" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1415" style="font-family: STIXGeneral-Italic;">𝑦</span><span class="mo" id="MathJax-Span-1416" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">∣</span><span class="msubsup" id="MathJax-Span-1417" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 1.283em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1418"><span class="mrow" id="MathJax-Span-1419"><span class="mi" id="MathJax-Span-1420" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="texatom" id="MathJax-Span-1421"><span class="mrow" id="MathJax-Span-1422"><span class="mo" id="MathJax-Span-1423" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∼</span><span class="mi" id="MathJax-Span-1424" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1425" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1426" style=""><span style="font-family: STIXGeneral-Regular;">⟩</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.686em; left: 6.099em;"><span class="texatom" id="MathJax-Span-1427"><span class="mrow" id="MathJax-Span-1428"><span class="mi" id="MathJax-Span-1429" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-1430" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1431"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.36em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1432"><span class="mrow" id="MathJax-Span-1433"><span class="mi" id="MathJax-Span-1434" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.361em;"><span class="texatom" id="MathJax-Span-1435"><span class="mrow" id="MathJax-Span-1436"><span class="mo" id="MathJax-Span-1437" style="font-size: 50%; font-family: STIXGeneral-Regular;">∼</span><span class="mi" id="MathJax-Span-1438" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑖</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1439" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1003.74em, 4.357em, -999.997em); top: -3.327em; left: 50%; margin-left: -1.893em;"><span class="mrow" id="MathJax-Span-1440"><span class="mtext" id="MathJax-Span-1441" style="font-family: STIXGeneral-Regular;">var</span><span class="mrow" id="MathJax-Span-1442" style="padding-left: 0.207em;"><span class="mo" id="MathJax-Span-1443" style="vertical-align: 0em;"><span style="font-family: STIXGeneral-Regular;">(</span></span><span class="mi" id="MathJax-Span-1444" style="font-family: STIXGeneral-Italic;">𝑔</span><span class="mo" id="MathJax-Span-1445" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1446"><span class="mrow" id="MathJax-Span-1447"><span class="mi" id="MathJax-Span-1448" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-1449" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1450" style="vertical-align: 0em;"><span style="font-family: STIXGeneral-Regular;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1007.99em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.994em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-1451" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mn" id="MathJax-Span-1452" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">1</span><span class="mo" id="MathJax-Span-1453" style="font-family: STIXGeneral-Regular; padding-left: 0.259em;">−</span><span class="mfrac" id="MathJax-Span-1454" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 7.636em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.128em, 1007.53em, 4.511em, -999.997em); top: -4.864em; left: 50%; margin-left: -3.737em;"><span class="mrow" id="MathJax-Span-1455"><span class="msubsup" id="MathJax-Span-1456"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1001.28em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mtext" id="MathJax-Span-1457" style="font-family: STIXGeneral-Regular;">var</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 1.283em;"><span class="texatom" id="MathJax-Span-1458"><span class="mrow" id="MathJax-Span-1459"><span class="msubsup" id="MathJax-Span-1460"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.36em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1461"><span class="mrow" id="MathJax-Span-1462"><span class="mi" id="MathJax-Span-1463" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.361em;"><span class="texatom" id="MathJax-Span-1464"><span class="mrow" id="MathJax-Span-1465"><span class="mo" id="MathJax-Span-1466" style="font-size: 50%; font-family: STIXGeneral-Regular;">∼</span><span class="mi" id="MathJax-Span-1467" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑖</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1468"><span style="display: inline-block; position: relative; width: 5.279em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1003.38em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mrow" id="MathJax-Span-1469"><span class="mo" id="MathJax-Span-1470" style="font-family: STIXGeneral-Regular;">⟨</span><span class="mi" id="MathJax-Span-1471" style="font-family: STIXGeneral-Italic;">𝑦</span><span class="mo" id="MathJax-Span-1472" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">∣</span><span class="msubsup" id="MathJax-Span-1473" style="padding-left: 0.31em;"><span style="display: inline-block; position: relative; width: 1.283em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1474"><span class="mrow" id="MathJax-Span-1475"><span class="mi" id="MathJax-Span-1476" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="texatom" id="MathJax-Span-1477"><span class="mrow" id="MathJax-Span-1478"><span class="mo" id="MathJax-Span-1479" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∼</span><span class="mi" id="MathJax-Span-1480" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1481" style="font-family: STIXGeneral-Regular;">⟩</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.737em; left: 3.486em;"><span class="texatom" id="MathJax-Span-1482"><span class="mrow" id="MathJax-Span-1483"><span class="mi" id="MathJax-Span-1484" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑝</span><span class="mo" id="MathJax-Span-1485" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1486"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.36em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1487"><span class="mrow" id="MathJax-Span-1488"><span class="mi" id="MathJax-Span-1489" style="font-size: 70.7%; font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.361em;"><span class="texatom" id="MathJax-Span-1490"><span class="mrow" id="MathJax-Span-1491"><span class="mo" id="MathJax-Span-1492" style="font-size: 50%; font-family: STIXGeneral-Regular;">∼</span><span class="mi" id="MathJax-Span-1493" style="font-size: 50%; font-family: STIXGeneral-Italic;">𝑖</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1494" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1003.74em, 4.357em, -999.997em); top: -3.327em; left: 50%; margin-left: -1.893em;"><span class="mrow" id="MathJax-Span-1495"><span class="mtext" id="MathJax-Span-1496" style="font-family: STIXGeneral-Regular;">var</span><span class="mrow" id="MathJax-Span-1497" style="padding-left: 0.207em;"><span class="mo" id="MathJax-Span-1498" style="vertical-align: 0em;"><span style="font-family: STIXGeneral-Regular;">(</span></span><span class="mi" id="MathJax-Span-1499" style="font-family: STIXGeneral-Italic;">𝑔</span><span class="mo" id="MathJax-Span-1500" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-1501"><span class="mrow" id="MathJax-Span-1502"><span class="mi" id="MathJax-Span-1503" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span class="mo" id="MathJax-Span-1504" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1505" style="vertical-align: 0em;"><span style="font-family: STIXGeneral-Regular;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1007.64em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.636em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 3.128em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mi>i</mi></mrow></msub><mo>=</mo><mfrac><msub><mrow><mo>⟨</mo><msub><mtext>var</mtext><mrow class="MJX-TeXAtom-ORD"><msub><mi>x</mi><mi>i</mi></msub></mrow></msub><mo stretchy="false">(</mo><mi>y</mi><mo>∣</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo>∼</mo><mi>i</mi></mrow></msub><mo stretchy="false">)</mo><mo>⟩</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo>∼</mo><mi>i</mi></mrow></msub><mo stretchy="false">)</mo></mrow></msub><mrow><mtext>var</mtext><mrow><mo>(</mo><mi>g</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>)</mo></mrow></mrow></mfrac><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mrow><msub><mtext>var</mtext><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo>∼</mo><mi>i</mi></mrow></msub></mrow></msub><msub><mrow><mo>⟨</mo><mi>y</mi><mo>∣</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo>∼</mo><mi>i</mi></mrow></msub><mo>⟩</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo>∼</mo><mi>i</mi></mrow></msub><mo stretchy="false">)</mo></mrow></msub></mrow><mrow><mtext>var</mtext><mrow><mo>(</mo><mi>g</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>)</mo></mrow></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-96"> 
S_{Ti} = \frac{\left\langle \text{var}_{x_i} (y\mid \mathbf{ x}_{\sim i}) \right\rangle _{p(\mathbf{ x}_{\sim i})}}{\text{var}\left(g(\mathbf{ x})\right)} = 1 - \frac{\text{var}_{\mathbf{ x}_{\sim i}} \left\langle y\mid \mathbf{ x}_{\sim i} \right\rangle _{p(\mathbf{ x}_{\sim i})}}{\text{var}\left(g(\mathbf{ x})\right)}
</script></span></p>
<p>Note that the sum of <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1506" style="width: 1.744em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1001.44em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1507"><span class="msubsup" id="MathJax-Span-1508"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1509" style="font-family: STIXGeneral-Italic;">𝑆<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.669em;"><span class="texatom" id="MathJax-Span-1510"><span class="mrow" id="MathJax-Span-1511"><span class="mi" id="MathJax-Span-1512" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑇<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="mi" id="MathJax-Span-1513" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>T</mi><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-97">S_{Ti}</script></span> is not necessarily one in this case unless the model is additive. In the Ishigami example the value of the total effects is</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb27-1" aria-hidden="true" tabindex="-1"></a>ishigami.total_effects</span></code></pre></div>
<p>As in the previous example, the total effects can be computed with Monte Carlo. In the next plot we show the comparison with the true total effects.</p>
<div class="figure">
<div id="total-effects-ishigami-figure" class="figure-frame">
<object class="svgplot " data="./Lawrence2021_files/total-effects-ishigami.svg" width="80%" style=" ">
</object>
</div>
<div id="total-effects-ishigami-magnify" class="magnify" onclick="magnifyFigure(&#39;total-effects-ishigami&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="total-effects-ishigami-caption" class="caption-frame">
<p>Figure: The total effects from the Ishigami function as computed via Monte Carlo estimate alongside the true total effects for the Ishigami function.</p>
</div>
</div>
<h2 id="computing-the-sensitivity-indices-using-the-output-of-a-model">Computing the Sensitivity Indices Using the Output of a Model</h2>
<p>In the example used above the Ishigami function is very cheap to evaluate. However, in most real scenarios the functions of interest are expensive, and we need to limit ourselves to a few number of evaluations. Using Monte Carlo methods is infeasible in these scenarios as a large number of samples are typically required to provide good estimates of the Sobol indices.</p>
<p>An alternative in these cases is to use Gaussaian process emulator of the function of interest trained on a few inputs and outputs <span class="citation" data-cites="Marrel-sobol09">(Marrel et al., 2009)</span>. If the model is properly trained, its mean prediction which is cheap to evaluate, can be used to compute the Monte Carlo estimates of the Sobol indices, the variance from the GP emulator can also be used to assess our uncertainty about the Sobol indices. Let’s see how we can do this in Emukit.</p>
<p>We start by generating 100 samples in the input domain. Note that this a just 1% of the number of samples that we used to compute the Sobol coefficients using Monte Carlo.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> emukit.core.initial_designs <span class="im">import</span> RandomDesign</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb29-1" aria-hidden="true" tabindex="-1"></a>design <span class="op">=</span> RandomDesign(space)</span>
<span id="cb29-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb29-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> design.get_samples(<span class="dv">500</span>)</span>
<span id="cb29-3"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb29-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> ishigami.fidelity1(x)[:,np.newaxis]</span></code></pre></div>
<p>Now, we fit a standard Gaussian process to the samples, and we wrap it as an Emukit model.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> GPy.models <span class="im">import</span> GPRegression</span>
<span id="cb30-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> emukit.model_wrappers <span class="im">import</span> GPyModelWrapper</span>
<span id="cb30-3"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> emukit.sensitivity.monte_carlo <span class="im">import</span> MonteCarloSensitivity</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb31-1" aria-hidden="true" tabindex="-1"></a>model_gpy <span class="op">=</span> GPRegression(x,y)</span>
<span id="cb31-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb31-2" aria-hidden="true" tabindex="-1"></a>model_emukit <span class="op">=</span> GPyModelWrapper(model_gpy)</span>
<span id="cb31-3"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb31-3" aria-hidden="true" tabindex="-1"></a>model_emukit.optimize()</span></code></pre></div>
<p>The final step is to compute the coefficients using the class <code>ModelBasedMonteCarloSensitivity</code> which directly calls the model and uses its predictive mean to compute the Monte Carlo estimates of the Sobol indices. We plot the true estimates, those computed using 10000 direct evaluations of the object using Monte Carlo and those computed using a Gaussian process model trained on 100 evaluations.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb32-1" aria-hidden="true" tabindex="-1"></a>num_mc <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb32-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb32-2" aria-hidden="true" tabindex="-1"></a>senstivity_ishigami_gpbased <span class="op">=</span> MonteCarloSensitivity(model <span class="op">=</span> model_emukit, input_domain <span class="op">=</span> space)</span>
<span id="cb32-3"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb32-3" aria-hidden="true" tabindex="-1"></a>main_effects_gp, total_effects_gp, _ <span class="op">=</span> senstivity_ishigami_gpbased.compute_effects(num_monte_carlo_points <span class="op">=</span> num_mc)</span></code></pre></div>
<div class="figure">
<div id="first-order-sobol-indices-gp-ishigami-figure" class="figure-frame">
<object class="svgplot " data="./Lawrence2021_files/first-order-sobol-indices-gp-ishigami.svg" width="80%" style=" ">
</object>
</div>
<div id="first-order-sobol-indices-gp-ishigami-magnify" class="magnify" onclick="magnifyFigure(&#39;first-order-sobol-indices-gp-ishigami&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="first-order-sobol-indices-gp-ishigami-caption" class="caption-frame">
<p>Figure: First order Sobol indices as estimated by Monte Carlo and GP-emulator based Monte Carlo.</p>
</div>
</div>
<div class="figure">
<div id="total-effects-sobol-indices-gp-ishigami-figure" class="figure-frame">
<object class="svgplot " data="./Lawrence2021_files/total-effects-sobol-indices-gp-ishigami.svg" width="80%" style=" ">
</object>
</div>
<div id="total-effects-sobol-indices-gp-ishigami-magnify" class="magnify" onclick="magnifyFigure(&#39;total-effects-sobol-indices-gp-ishigami&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="total-effects-sobol-indices-gp-ishigami-caption" class="caption-frame">
<p>Figure: Total effects as estimated by Monte Carlo and GP based Monte Carlo.</p>
</div>
</div>
<p>We observe some discrepancies with respect to the real value of the Sobol index when using the Gaussian process, but we get a fairly good approximation with a very reduced number of evaluations of the original target function.</p>
<h2 id="conclusions">Conclusions</h2>
<p>The Sobol indices are a tool for explaining the variance of the output of a function as components of the input variables. Monte Carlo is an approach for computing these indices if the function is cheap to evaluate. Other approaches are needed when <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1514" style="width: 1.744em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1001.39em, 2.923em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-1515"><span class="mi" id="MathJax-Span-1516" style="font-family: STIXGeneral-Italic;">𝑔</span><span class="mo" id="MathJax-Span-1517" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-1518" style="font-family: STIXGeneral-Regular;">⋅</span><span class="mo" id="MathJax-Span-1519" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mo>⋅</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-98">g(\cdot)</script></span> is expensive to compute.</p>
<h2 id="catapult-simulation">Catapult Simulation</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span class="editsection" style=""><a href="https://github.com/lawrennd/talks/edit/gh-pages/_uq/includes/catapult-simulation.md" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Edit Page&#39;, &#39;Edit&#39;, &#39;https://github.com/lawrennd/talks/edit/gh-pages/_uq/includes/catapult-simulation.md&#39;, 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<svg viewBox="0 0 200 200" style="width:15%">
<defs> <clippath id="clip7">
<style>
circle {
  fill: black;
}
</style>
<circle cx="100" cy="100" r="100"></circle> </clippath> </defs>
<title>
Nicolas Durrande
</title>
<image preserveAspectRatio="xMinYMin slice" width="100%" xlink:href="https://inverseprobability.com/talks/./slides/diagrams//people/nicolas-durrande2.jpg" clip-path="url(#clip7)"></image>
</svg>
<p>As a worked example we’re going to introduce a catapult simulation written by Nicolas Durrande, <a href="https://durrande.shinyapps.io/catapult/" class="uri">https://durrande.shinyapps.io/catapult/</a>.</p>
<div class="figure">
<div id="catapult-simulation-figure" class="figure-frame">
<div class="centered" style="">
<img class="" src="./Lawrence2021_files/catapult-simulation.png" width="80%" height="auto" align="center" style="background:none; border:none; box-shadow:none; display:block; margin-left:auto; margin-right:auto;vertical-align:middle">
</div>
</div>
<div id="catapult-simulation-magnify" class="magnify" onclick="magnifyFigure(&#39;catapult-simulation&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="catapult-simulation-caption" class="caption-frame">
<p>Figure: A catapult simulation for experimenting with surrogate models, kindly provided by Nicolas Durrande</p>
</div>
</div>
<p>The simulator allows you to set various parameters of the catapult including the axis of rotation, <code>roation_axis</code>, the position of the arm stop, <code>arm_stop</code>, and the location of the two bindings of the catapult’s spring, <code>spring_binding_1</code> and <code>spring_binding_2</code>.</p>
<p>These parameters are then collated in a vector, <span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext mathvariant=&quot;monospace&quot;&gt;rotation_axis&lt;/mtext&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext mathvariant=&quot;monospace&quot;&gt;arm_stop&lt;/mtext&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext mathvariant=&quot;monospace&quot;&gt;spring_binding_1&lt;/mtext&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext mathvariant=&quot;monospace&quot;&gt;spring_binding_2&lt;/mtext&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1520" style="width: 14.347em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.734em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.308em, 1011.68em, 8.046em, -999.997em); top: -5.428em; left: 0em;"><span class="mrow" id="MathJax-Span-1521"><span class="msubsup" id="MathJax-Span-1522"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-1523"><span class="mrow" id="MathJax-Span-1524"><span class="mi" id="MathJax-Span-1525" style="font-family: STIXGeneral; font-weight: bold;">𝐱</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-1526" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">𝑖</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1527" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">=</span><span class="mrow" id="MathJax-Span-1528" style="padding-left: 0.31em;"><span class="mo" id="MathJax-Span-1529" style="vertical-align: 2.974em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 1.13em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.405em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.534em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.663em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: 0.207em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1530"><span style="display: inline-block; position: relative; width: 8.353em; height: 0px; margin-right: 0.156em; margin-left: 0.156em;"><span style="position: absolute; clip: rect(3.332em, 1008.3em, 8.865em, -999.997em); top: -6.247em; left: 0em;"><span style="display: inline-block; position: relative; width: 8.353em; height: 0px;"><span style="position: absolute; clip: rect(3.23em, 1006.71em, 4.255em, -999.997em); top: -6.145em; left: 50%; margin-left: -3.379em;"><span class="mtd" id="MathJax-Span-1531"><span class="mrow" id="MathJax-Span-1532"><span class="texatom" id="MathJax-Span-1533"><span class="mrow" id="MathJax-Span-1534"><span class="mtext" id="MathJax-Span-1535" style="font-family: STIXGeneral-Regular;">𝚛𝚘𝚝𝚊𝚝𝚒𝚘𝚗_𝚊𝚡𝚒𝚜</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1004.15em, 4.357em, -999.997em); top: -4.711em; left: 50%; margin-left: -2.098em;"><span class="mtd" id="MathJax-Span-1536"><span class="mrow" id="MathJax-Span-1537"><span class="texatom" id="MathJax-Span-1538"><span class="mrow" id="MathJax-Span-1539"><span class="mtext" id="MathJax-Span-1540" style="font-family: STIXGeneral-Regular;">𝚊𝚛𝚖_𝚜𝚝𝚘𝚙</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1008.25em, 4.357em, -999.997em); top: -3.225em; left: 50%; margin-left: -4.147em;"><span class="mtd" id="MathJax-Span-1541"><span class="mrow" id="MathJax-Span-1542"><span class="texatom" id="MathJax-Span-1543"><span class="mrow" id="MathJax-Span-1544"><span class="mtext" id="MathJax-Span-1545" style="font-family: STIXGeneral-Regular;">𝚜𝚙𝚛𝚒𝚗𝚐_𝚋𝚒𝚗𝚍𝚒𝚗𝚐_𝟷</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1008.3em, 4.357em, -999.997em); top: -1.739em; left: 50%; margin-left: -4.147em;"><span class="mtd" id="MathJax-Span-1546"><span class="mrow" id="MathJax-Span-1547"><span class="texatom" id="MathJax-Span-1548"><span class="mrow" id="MathJax-Span-1549"><span class="mtext" id="MathJax-Span-1550" style="font-family: STIXGeneral-Regular;">𝚜𝚙𝚛𝚒𝚗𝚐_𝚋𝚒𝚗𝚍𝚒𝚗𝚐_𝟸</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.253em;"></span></span></span></span><span class="mo" id="MathJax-Span-1551" style="vertical-align: 2.974em;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.327em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: 1.13em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.405em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.534em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.663em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: 0.207em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.433em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.059em; border-left: 0px solid; width: 0px; height: 6.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mi>i</mi></msub><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="monospace">rotation_axis</mtext></mrow></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="monospace">arm_stop</mtext></mrow></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="monospace">spring_binding_1</mtext></mrow></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="monospace">spring_binding_2</mtext></mrow></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-99">
\mathbf{ x}_i = \begin{bmatrix}
\texttt{rotation_axis} \\
\texttt{arm_stop} \\
\texttt{spring_binding_1} \\
\texttt{spring_binding_2}
\end{bmatrix}
</script></span></p>
<p>Having set those parameters, you can run an experiment, by firing the catapult. This will show you how far it goes.</p>
<p>Because you will need to operate the catapult yourself, we’ll create a function to query you about the result of an individual firing.</p>
<p>We can also set the parameter space for the model. Each of these variables is scaled to operate <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1552" style="width: 3.845em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.128em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1003.02em, 2.871em, -999.997em); top: -2.559em; left: 0em;"><span class="mrow" id="MathJax-Span-1553"><span class="mo" id="MathJax-Span-1554" style="font-family: STIXGeneral-Regular;">∈</span><span class="mo" id="MathJax-Span-1555" style="font-family: STIXGeneral-Regular; padding-left: 0.31em;">[</span><span class="mn" id="MathJax-Span-1556" style="font-family: STIXGeneral-Regular;">0</span><span class="mo" id="MathJax-Span-1557" style="font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-1558" style="font-family: STIXGeneral-Regular; padding-left: 0.207em;">1</span><span class="mo" id="MathJax-Span-1559" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.564em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-100">\in [0, 1]</script></span>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> emukit.core <span class="im">import</span> ContinuousParameter, ParameterSpace</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb34-1" aria-hidden="true" tabindex="-1"></a>variable_domain <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">1</span>]</span>
<span id="cb34-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb34-2" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb34-3"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb34-3" aria-hidden="true" tabindex="-1"></a>space <span class="op">=</span> ParameterSpace(</span>
<span id="cb34-4"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb34-4" aria-hidden="true" tabindex="-1"></a>          [ContinuousParameter(<span class="st">'rotation_axis'</span>, <span class="op">*</span>variable_domain), </span>
<span id="cb34-5"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb34-5" aria-hidden="true" tabindex="-1"></a>           ContinuousParameter(<span class="st">'arm_stop'</span>, <span class="op">*</span>variable_domain),</span>
<span id="cb34-6"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb34-6" aria-hidden="true" tabindex="-1"></a>           ContinuousParameter(<span class="st">'spring_binding_1'</span>, <span class="op">*</span>variable_domain),</span>
<span id="cb34-7"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb34-7" aria-hidden="true" tabindex="-1"></a>           ContinuousParameter(<span class="st">'spring_binding_2'</span>, <span class="op">*</span>variable_domain)])</span></code></pre></div>
<p>Before we perform sensitivity analysis, we need to build an emulator of the catapulter, which we do using our experimental design process.</p>
<h2 id="experimental-design-for-the-catapult">Experimental Design for the Catapult</h2>
<div style="text-align:right">
<span class="editsection-bracket" style="">[</span><span class="editsection" style=""><a href="https://github.com/lawrennd/talks/edit/gh-pages/_uq/includes/catapult-experimental-design.md" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Edit Page&#39;, &#39;Edit&#39;, &#39;https://github.com/lawrennd/talks/edit/gh-pages/_uq/includes/catapult-experimental-design.md&#39;, 13);">edit</a></span><span class="editsection-bracket" style="">]</span>
</div>
<p>Now we will build an emulator for the catapult using the experimental design loop.</p>
<p>We’ll start with a small model-free design, we’ll use a random design for initializing our model.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> emukit.core.initial_designs <span class="im">import</span> RandomDesign</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb36-1" aria-hidden="true" tabindex="-1"></a>design <span class="op">=</span> RandomDesign(space)</span>
<span id="cb36-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb36-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> design.get_samples(<span class="dv">5</span>)</span>
<span id="cb36-3"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb36-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> catapult_distance(x)</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> GPy.models <span class="im">import</span> GPRegression</span>
<span id="cb37-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> emukit.model_wrappers <span class="im">import</span> GPyModelWrapper</span>
<span id="cb37-3"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> emukit.sensitivity.monte_carlo <span class="im">import</span> MonteCarloSensitivity</span></code></pre></div>
<p>Set up the GPy model. The variance of the RBF kernel is set to <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-101-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;150&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1560" style="width: 2.41em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.949em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1001.95em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1561"><span class="msubsup" id="MathJax-Span-1562"><span style="display: inline-block; position: relative; width: 1.949em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1001.49em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-1563" style="font-family: STIXGeneral-Regular;">150</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 1.488em;"><span class="mn" id="MathJax-Span-1564" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>150</mn><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-101">150^2</script></span> because that’s roughly the square of the range of the catapult. We set the noise variance to a small value.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb38-1" aria-hidden="true" tabindex="-1"></a>model_gpy <span class="op">=</span> GPRegression(x,y)</span>
<span id="cb38-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb38-2" aria-hidden="true" tabindex="-1"></a>model_gpy.kern.variance <span class="op">=</span> <span class="dv">150</span><span class="op">**</span><span class="dv">2</span></span>
<span id="cb38-3"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb38-3" aria-hidden="true" tabindex="-1"></a>model_gpy.likelihood.variance.fix(<span class="fl">1e-5</span>)</span>
<span id="cb38-4"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb38-4" aria-hidden="true" tabindex="-1"></a>display(model_gpy)</span></code></pre></div>
<p>Wrap the model for EmuKit.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb39-1" aria-hidden="true" tabindex="-1"></a>model_emukit <span class="op">=</span> GPyModelWrapper(model_gpy)</span>
<span id="cb39-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb39-2" aria-hidden="true" tabindex="-1"></a>model_emukit.optimize()</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb40-1" aria-hidden="true" tabindex="-1"></a>display(model_gpy)</span></code></pre></div>
<p>Now we set up the model loop. We’ll use integrated variance reduction as the acquisition function for our model-based design loop.</p>
<p><em>Warning</em>: This loop runs much slower on Google <code>colab</code> than on a local machine.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> emukit.experimental_design.experimental_design_loop <span class="im">import</span> ExperimentalDesignLoop</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> emukit.experimental_design.acquisitions <span class="im">import</span> IntegratedVarianceReduction, ModelVariance</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb43-1" aria-hidden="true" tabindex="-1"></a>integrated_variance <span class="op">=</span> IntegratedVarianceReduction(space<span class="op">=</span>space,</span>
<span id="cb43-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb43-2" aria-hidden="true" tabindex="-1"></a>                                                  model<span class="op">=</span>model_emukit)</span>
<span id="cb43-3"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb43-3" aria-hidden="true" tabindex="-1"></a>ed <span class="op">=</span> ExperimentalDesignLoop(space<span class="op">=</span>space, </span>
<span id="cb43-4"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb43-4" aria-hidden="true" tabindex="-1"></a>                            model<span class="op">=</span>model_emukit, </span>
<span id="cb43-5"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb43-5" aria-hidden="true" tabindex="-1"></a>                            acquisition <span class="op">=</span> integrated_variance)</span>
<span id="cb43-6"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb43-6" aria-hidden="true" tabindex="-1"></a>ed.run_loop(catapult_distance, <span class="dv">10</span>)</span></code></pre></div>
<h2 id="sensitivity-analysis-of-a-catapult-simulation">Sensitivity Analysis of a Catapult Simulation</h2>
<p>The final step is to compute the coefficients using the class <code>ModelBasedMonteCarloSensitivity</code> which directly calls the model and uses its predictive mean to compute the Monte Carlo estimates of the Sobol indices. We plot the estimates of the Sobol indices computed using a Gaussian process model trained on the observations we’ve acquired.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb44-1" aria-hidden="true" tabindex="-1"></a>num_mc <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb44-2"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb44-2" aria-hidden="true" tabindex="-1"></a>senstivity <span class="op">=</span> MonteCarloSensitivity(model <span class="op">=</span> model_emukit, input_domain <span class="op">=</span> space)</span>
<span id="cb44-3"><a href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html#cb44-3" aria-hidden="true" tabindex="-1"></a>main_effects_gp, total_effects_gp, _ <span class="op">=</span> senstivity.compute_effects(num_monte_carlo_points <span class="op">=</span> num_mc)</span></code></pre></div>
<div class="figure">
<div id="first-order-sobol-indices-gp-catapult-figure" class="figure-frame">
<object class="svgplot " data="./Lawrence2021_files/first-order-sobol-indices-gp-catapult.svg" width="80%" style=" ">
</object>
</div>
<div id="first-order-sobol-indices-gp-catapult-magnify" class="magnify" onclick="magnifyFigure(&#39;first-order-sobol-indices-gp-catapult&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="first-order-sobol-indices-gp-catapult-caption" class="caption-frame">
<p>Figure: First Order sobol indices as estimated by GP-emulator based Monte Carlo on the catapult.</p>
</div>
</div>
<div class="figure">
<div id="total-effects-sobol-indices-gp-catapult-figure" class="figure-frame">
<object class="svgplot " data="./Lawrence2021_files/total-effects-sobol-indices-gp-catapult.svg" width="80%" style=" ">
</object>
</div>
<div id="total-effects-sobol-indices-gp-catapult-magnify" class="magnify" onclick="magnifyFigure(&#39;total-effects-sobol-indices-gp-catapult&#39;)">
<img class="img-button" src="./Lawrence2021_files/Magnify_Large.svg" style="width:1.5ex">
</div>
<div id="total-effects-sobol-indices-gp-catapult-caption" class="caption-frame">
<p>Figure: Total effects as estimated by GP based Monte Carlo on the catapult.</p>
</div>
</div>
<h2 id="thanks">Thanks!</h2>
<p>For more information on these subjects and more you might want to check the following resources.</p>
<ul>
<li>twitter: <a href="https://twitter.com/lawrennd">@lawrennd</a></li>
<li>podcast: <a href="http://thetalkingmachines.com/">The Talking Machines</a></li>
<li>newspaper: <a href="http://www.theguardian.com/profile/neil-lawrence">Guardian Profile Page</a></li>
<li>blog: <a href="http://inverseprobability.com/blog.html">http://inverseprobability.com</a></li>
</ul>
<h1 class="unnumbered" id="references">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-Durrande-anova13" class="csl-entry" role="doc-biblioentry">
Durrande, N., Ginsbourger, D., Olivier, Carraro, L., 2013. <span>ANOVA</span> kernels and <span>RKHS</span> of zero mean functions for model-based sensitivity analysis. Journal of Multivariate Analysis 115, 57–67. https://doi.org/<a href="https://doi.org/10.1016/j.jmva.2012.08.016">https://doi.org/10.1016/j.jmva.2012.08.016</a>
</div>
<div id="ref-Ishigami-importance90" class="csl-entry" role="doc-biblioentry">
Ishigami, T., Homma, T., 1989. An importance quantification technique in uncertainty analysis for computer models. [1990] Proceedings. First International Symposium on Uncertainty Modeling and Analysis 398–403.
</div>
<div id="ref-Kennedy-bayesian01" class="csl-entry" role="doc-biblioentry">
Kennedy, M.C., O’Hagan, A., 2001. Bayesian calibration of computer models. Journal of the Royal Statistical Society: Series B (Statistical Methodology) 63, 425–464. <a href="https://doi.org/10.1111/1467-9868.00294">https://doi.org/10.1111/1467-9868.00294</a>
</div>
<div id="ref-Kennedy-predicting00" class="csl-entry" role="doc-biblioentry">
Kennedy, M.C., O’Hagan, A., 2000. Predicting the output from a complex computer code when fast approximations are available. Biometrika 87, 1–13.
</div>
<div id="ref-Laplace-essai14" class="csl-entry" role="doc-biblioentry">
Laplace, P.S., 1814. Essai philosophique sur les probabilités, 2nd ed. Courcier, Paris.
</div>
<div id="ref-Marrel-sobol09" class="csl-entry" role="doc-biblioentry">
Marrel, A., Iooss, B., Laurent, B., Roustant, O., 2009. Calculations of <span>S</span>obol indices for the <span>G</span>aussian process metamodel. Reliability Engineering &amp; System Safety 94, 742–751. https://doi.org/<a href="https://doi.org/10.1016/j.ress.2008.07.008">https://doi.org/10.1016/j.ress.2008.07.008</a>
</div>
<div id="ref-McKay-selecting79" class="csl-entry" role="doc-biblioentry">
McKay, M.D., Beckman, R.J., Conover, W.J., 1979. A comparison of three methods for selecting values of input variables in the analysis of output from a computer code. Technometrics 21, 239–245.
</div>
<div id="ref-Saltelli-variance10" class="csl-entry" role="doc-biblioentry">
Saltelli, A., Annoni, P., Azzini, I., Campolongo, F., Ratto, M., Tarantola, S., 2010. Variance based sensitivity analysis of model output. Design and estimator for the total sensitivity index. Computer Physics Communications 181, 259–270. <a href="https://doi.org/10.1016/j.cpc.2009.09.018">https://doi.org/10.1016/j.cpc.2009.09.018</a>
</div>
<div id="ref-Saltelli-global08" class="csl-entry" role="doc-biblioentry">
Saltelli, A., Ratto, M., Andres, T., Campolongo, F., Cariboni, J., Gatelli, D., Saisana, M., Tarantola, S., 2008. Global sensitivity analysis: The primer. wiley.
</div>
<div id="ref-Saltelli-sensitivity04" class="csl-entry" role="doc-biblioentry">
Saltelli, A., Tarantola, S., Campolongo, F., Ratto, M., 2004. Sensitivity analysis in practice: A guide to assessing scientific methods. wiley.
</div>
<div id="ref-Sobol-global01" class="csl-entry" role="doc-biblioentry">
Sobol, I.M., 2001. Global sensitivity indices for nonlinear mathematical models and their <span>M</span>onte <span>C</span>arlo estimates. Mathematics and Computers in Simulation 55, 271–280. <a href="https://doi.org/10.1016/S0378-4754(00)00270-6">https://doi.org/10.1016/S0378-4754(00)00270-6</a>
</div>
<div id="ref-Sobol-sensitivity90" class="csl-entry" role="doc-biblioentry">
Sobol, I.M., 1990. On sensitivity estimation for nonlinear mathematical models. Matematicheskoe Modelirovanie 2, 112–118.
</div>
<div id="ref-Sobol-variance99" class="csl-entry" role="doc-biblioentry">
Sobol, I.M., Levitan, Y.L., 1999. On the use of variance reducing multipliers in <span>M</span>onte <span>C</span>arlo computations of a global sensitivity index. Computer Physics Communications 117, 52–61. <a href="https://doi.org/10.1016/S0010-4655(98)00156-8">https://doi.org/10.1016/S0010-4655(98)00156-8</a>
</div>
</div>

</article>

</div>

  </div><a class="u-url" href="https://mlatcl.github.io/gpss/lectures/00-13-emulation.html" hidden=""></a>
</article>

      </div>
    </main>



<footer class="site-footer">
<div class="wrapper">
This site last compiled Sun, 12 Sep 2021 19:48:17 +0000
</div>
  <!-- Basic conference information -->
  <div class="footer-left">
  </div>

  <!-- Social media and contact information -->
  <div class="footer-right">

    

    
    <a href="https://github.com/mlatcl"><i class="icon-github"></i>&nbsp;mlatcl</a><br>
    

    

  </div>


</footer>




<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; min-width: 0px; max-width: none; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXSizeOneSym, sans-serif;"></div></div></body><grammarly-desktop-integration data-grammarly-shadow-root="true"></grammarly-desktop-integration></html>